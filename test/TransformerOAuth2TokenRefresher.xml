<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE scenario [
	<!ENTITY projectDir "/Users/kweller/Projects/mg/modgeosys^fme-components/trunk">
	<!ENTITY fmePath "/usr/local/bin/fme">
	<!ENTITY dataDirectory "&projectDir;/fme/Resources/Data">
	<!ENTITY configurationFile "QBO_APIConfiguration_test.json">
	<!ENTITY destFFSDataset "&projectDir;/fme/Resources/Data/Output/TestOAuth2TokenRefresher_output.ffs">
]>
<scenario xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../../../rTest/scenario/rtest.xsd">
	<name>OAuth2TokenRefresher.fmx</name>
	<author>Kevin Weller</author>
	<description>Tests for OAuth2TokenRefresher transformer</description>
	<fme_path>&fmePath;</fme_path>
	<rtestCollection>
		<rtest>
			<enabled>true</enabled>
			<deletebefore>&destFFSDataset;</deletebefore>
			<name>Emits new refresh token without error</name>
			<processCollection>
				<process>
					<description>Test process</description>
					<workspace>&projectDir;/fme/TestOAuth2TokenRefresher.fmw</workspace>
					<parameterCollection>
						<parameter name="Data_Directory" value="&dataDirectory;"/>
						<parameter name="Configuration_File" value="&configurationFile;"/>
						<parameter name="DestDataset_FFS" value="&destFFSDataset;"/>
					</parameterCollection>
				</process>
			</processCollection>
			<checkCollection>
				<check>
					<description>Number of features</description>
					<source type="file" format="FFS" dataset="&destFFSDataset;"/>
					<condition type="featuresCount" expected="1"/>
				</check>
				<check>
					<description>No error</description>
					<source type="file" format="FFS" dataset="&destFFSDataset;"/>
					<condition type="attributeValue" attribute="error" row="1" expected=""/>
				</check>
			</checkCollection>
		</rtest>
	</rtestCollection>
</scenario>
