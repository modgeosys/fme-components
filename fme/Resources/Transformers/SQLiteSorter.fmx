#! <?xml version="1.0" encoding="UTF-8" ?>
#! <TRANSFORMER
# TRANSFORMER_BEGIN SQLiteSorter,11,Workflows,95d802d2-6fe6-4251-b33d-2fd46de5b399,"Linked by Default",No,NO_PARALLELISM,,No,18592,YES,No,2or3
# <p>An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.</p>
# <p>For issues or questions, please Create an issue <a href="https://github.com/modgeosys/fme-components/issues_">here</a>.  For the source, including test driver components, please see the <a href="https://github.com/modgeosys/fme-components_">Github repository</a>.</p>
# <p>Copyright &copy; 2017-2019 by Modern geoSystems, released under <a href="https://github.com/modgeosys/fme-components/raw/master/LICENSE">this BSD 3-clause license</a>.</p>
# TRANSFORMER_END
#!   ATTR_TYPE_ENCODING="SDF"
#!   BLOCKED_LOOPING="No"
#!   CATEGORY="Workflows"
#!   DESCRIPTION="&lt;p&gt;An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.&lt;/p&gt;&#10;&lt;p&gt;For issues or questions, please Create an issue &lt;a href=&quot;https://github.com/modgeosys/fme-components/issues_&quot;&gt;here&lt;/a&gt;.  For the source, including test driver components, please see the &lt;a href=&quot;https://github.com/modgeosys/fme-components_&quot;&gt;Github repository&lt;/a&gt;.&lt;/p&gt;&#10;&lt;p&gt;Copyright &amp;copy; 2017-2019 by Modern geoSystems, released under &lt;a href=&quot;https://github.com/modgeosys/fme-components/raw/master/LICENSE&quot;&gt;this BSD 3-clause license&lt;/a&gt;.&lt;/p&gt;"
#!   DOC_EXTENTS="3903 371.003"
#!   DOC_TOP_LEFT="-4350 -68"
#!   EXPLICIT_BOOKMARK_ORDER="false"
#!   FME_BUILD_NUM="18592"
#!   FME_DOCUMENT_GUID="95d802d2-6fe6-4251-b33d-2fd46de5b399"
#!   FME_DOCUMENT_PRIORGUID="a1d7e8f5-ef08-4dc9-95f3-22751557c961,f62ce5e9-bac2-4a6c-91a4-9210ee5e817e,71133b5b-1186-4da8-b650-ab608ea446d7,8de06eb1-d9dc-4b1d-8475-0a54145a1ea1,482aff38-0b9b-430a-a0ed-d443c5f923c6"
#!   FME_LINKED_TRANSFORMER_VERSION="11"
#!   FME_PROCESS_COUNT="NO_PARALLELISM"
#!   FME_PROCESS_GROUPS_ORDERED="No"
#!   FME_PROCESS_GROUP_BY=""
#!   FME_SERVER_SERVICES=""
#!   FMX_ATTRIBUTE_PROPOGATION_MODE="AUTO"
#!   FMX_INSERT_MODE="Linked by Default"
#!   HISTORY="2017-11-26,Kevin&lt;space&gt;Weller,Initial&lt;space&gt;publication&lt;semicolon&gt;&lt;space&gt;test&lt;space&gt;workspace&lt;space&gt;fails&lt;space&gt;due&lt;space&gt;to&lt;space&gt;FME&lt;space&gt;Hub&lt;space&gt;version&lt;space&gt;delay.,2017-11-30,Kevin&lt;space&gt;Weller,Enhance&lt;space&gt;stack&lt;space&gt;trace&lt;space&gt;reporting&lt;semicolon&gt;&lt;space&gt;use&lt;space&gt;truncated&lt;space&gt;test&lt;space&gt;data&lt;space&gt;and&lt;space&gt;universal&lt;space&gt;temp&lt;space&gt;directory.,2018-01-20,Kevin&lt;space&gt;Weller,Fix&lt;space&gt;absolute&lt;space&gt;parameter&lt;space&gt;name&lt;space&gt;references&lt;space&gt;from&lt;space&gt;PythonCaller&lt;space&gt;when&lt;space&gt;SQLiteServer&lt;space&gt;is&lt;space&gt;called&lt;space&gt;from&lt;space&gt;another&lt;space&gt;custom&lt;space&gt;transformer&lt;space&gt;rather&lt;space&gt;than&lt;space&gt;from&lt;space&gt;the&lt;space&gt;top-level&lt;space&gt;workspace.,2018-03-08,Kevin&lt;space&gt;Weller,Update&lt;space&gt;documentation&lt;space&gt;to&lt;space&gt;reflect&lt;space&gt;move&lt;space&gt;from&lt;space&gt;GitHub&lt;space&gt;to&lt;space&gt;Assembla&lt;space&gt;and&lt;space&gt;Atlassian.,2018-03-18,Kevin&lt;space&gt;Weller,Fix&lt;space&gt;Python&lt;space&gt;syntax&lt;space&gt;error&lt;semicolon&gt;&lt;space&gt;test&lt;space&gt;driver&lt;space&gt;failed&lt;space&gt;to&lt;space&gt;test&lt;space&gt;latest&lt;space&gt;version&lt;comma&gt;&lt;space&gt;so&lt;space&gt;it&lt;space&gt;looked&lt;space&gt;like&lt;space&gt;it&lt;space&gt;worked&lt;space&gt;10&lt;space&gt;days&lt;space&gt;ago&lt;comma&gt;&lt;space&gt;but&lt;space&gt;it&lt;space&gt;didn&lt;apos&gt;t.&lt;space&gt;&lt;amp&gt;*^*&lt;openparen&gt;^&lt;amp&gt;^&lt;openparen&gt;&lt;amp&gt;*!,2018-07-02,Kevin&lt;space&gt;Weller,Enhance&lt;space&gt;parameter&lt;space&gt;handling&lt;space&gt;to&lt;space&gt;allow&lt;space&gt;for&lt;space&gt;multiple&lt;space&gt;references&lt;space&gt;to&lt;space&gt;the&lt;space&gt;transformer&lt;space&gt;from&lt;space&gt;the&lt;space&gt;same&lt;space&gt;calling&lt;space&gt;workspace&lt;space&gt;or&lt;space&gt;transformer.,2018-07-27,Kevin&lt;space&gt;Weller,Don&lt;apos&gt;t&lt;space&gt;expose&lt;space&gt;working&lt;space&gt;attributes&lt;space&gt;on&lt;space&gt;output&lt;space&gt;port.,2019-05-09,Kevin&lt;space&gt;Weller,Update&lt;space&gt;to&lt;space&gt;FME&lt;space&gt;2018.1.2.1&lt;space&gt;and&lt;space&gt;use&lt;space&gt;new&lt;space&gt;AttributeValidation*&lt;space&gt;framework&lt;space&gt;in&lt;space&gt;test&lt;space&gt;driver.,2019-07-22,Kevin&lt;space&gt;Weller,Allow&lt;space&gt;for&lt;space&gt;non-existent&lt;space&gt;server&lt;space&gt;parameters&lt;space&gt;as&lt;space&gt;in&lt;space&gt;the&lt;space&gt;ArcGIS&lt;space&gt;Interoperability&lt;space&gt;Extension&lt;space&gt;environment.,2019-07-22,Kevin&lt;space&gt;Weller,Automatically&lt;space&gt;create&lt;space&gt;temp&lt;space&gt;path&lt;space&gt;folders&lt;space&gt;if&lt;space&gt;they&lt;space&gt;don&lt;apos&gt;t&lt;space&gt;exist."
#!   ITERATION_COUNT_ATTR=""
#!   LAST_SAVE_BUILD="FME(R) 2018.1.2.1 (20190319 - Build 18592 - linux-x64)"
#!   LAST_SAVE_DATE="2019-07-22T16:53:09"
#!   MARKDOWN_DESCRIPTION="An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.&#10;&#10;For issues or questions, please Create an issue [here](https://github.com/modgeosys/fme-components/issues_).  For the source, including test driver components, please see the [Github repository](https://github.com/modgeosys/fme-components_).&#10;&#10;Copyright &amp;copy; 2017-2019 by Modern geoSystems, released under [this BSD 3-clause license](https://github.com/modgeosys/fme-components/raw/master/LICENSE)."
#!   MARKDOWN_USAGE="### Ports&#10;&#10;#### Input&#10;Feed the features to be sorted here.  If the input features consist of a variety of different feature types, it would be wise to ensure the sort key fields are represented in all of them.&#10;&#10;#### Output&#10;The sorted features emerge here.&#10;&#10;### Parameters&#10;&#10;#### Sort_Keys&#10;A tab- or space-delimited table of the sort keys to be applied.  The first column contains the names of the fields to be sorted, in order of sort priority.  The second column contains the database field data type.  The third and last column specifies whether the field is to be sorted in `asc`ending or `desc`ending order, e.g.:  &#10;  &#10;   `kml_name&#9;varchar asc`&#10;&#10;   `kml_id  varchar desc`  &#10;"
#!   MAX_LOOP_ITERATIONS=""
#!   PASSWORD=""
#!   PYTHON_COMPATIBILITY="2or3"
#!   SHOW_ANNOTATIONS="true"
#!   SHOW_INFO_NODES="true"
#!   TITLE="SQLiteSorter"
#!   USAGE="&lt;h3&gt;Ports&lt;/h3&gt;&#10;&lt;h4&gt;Input&lt;/h4&gt;&#10;&lt;p&gt;Feed the features to be sorted here.  If the input features consist of a variety of different feature types, it would be wise to ensure the sort key fields are represented in all of them.&lt;/p&gt;&#10;&lt;h4&gt;Output&lt;/h4&gt;&#10;&lt;p&gt;The sorted features emerge here.&lt;/p&gt;&#10;&lt;h3&gt;Parameters&lt;/h3&gt;&#10;&lt;h4&gt;Sort_Keys&lt;/h4&gt;&#10;&lt;p&gt;A tab- or space-delimited table of the sort keys to be applied.  The first column contains the names of the fields to be sorted, in order of sort priority.  The second column contains the database field data type.  The third and last column specifies whether the field is to be sorted in &lt;code&gt;asc&lt;/code&gt;ending or &lt;code&gt;desc&lt;/code&gt;ending order, e.g.:  &lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;kml_name    varchar asc&lt;/code&gt;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;kml_id  varchar desc&lt;/code&gt;  &lt;/p&gt;"
#!   USE_MARKDOWN="YES"
#!   VIEW_POSITION="-4476.04 798.008"
#!   WARN_INVALID_XFORM_PARAM="Yes"
#!   WORKSPACE_VERSION="1"
#!   XFORM_DEPRECATED="No"
#!   ZOOM_SCALE="100"
#! >
#! <DATASETS>
#! </DATASETS>
#! <DATA_TYPES>
#! </DATA_TYPES>
#! <GEOM_TYPES>
#! </GEOM_TYPES>
#! <FEATURE_TYPES>
#! </FEATURE_TYPES>
#! <FMESERVER>
#! </FMESERVER>
#! <GLOBAL_PARAMETERS>
#! <GLOBAL_PARAMETER
#!   GUI_LINE="GUI TEXT_EDIT_OR_ATTR Sort_Keys &quot; &quot; Sort Keys:"
#!   DEFAULT_VALUE=""
#!   IS_STAND_ALONE="true"
#! />
#! </GLOBAL_PARAMETERS>
#! <COMMENTS>
#! <COMMENT
#!   IDENTIFIER="7"
#!   COMMENT_VALUE="&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0//EN&quot; &quot;http://www.w3.org/TR/REC-html40/strict.dtd&quot;&gt;&#10;&lt;html&gt;&lt;head&gt;&lt;meta name=&quot;qrichtext&quot; content=&quot;1&quot; /&gt;&lt;style type=&quot;text/css&quot;&gt;&#10;p, li { white-space: pre-wrap; }&#10;&lt;/style&gt;&lt;/head&gt;&lt;body style=&quot; font-family:&apos;Arial&apos;; font-size:10pt; font-weight:400; font-style:normal;&quot;&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&lt;span style=&quot; font-family:&apos;helvetica neue&apos;; font-size:9pt;&quot;&gt;This is much easier in&lt;/span&gt;&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&lt;span style=&quot; font-family:&apos;helvetica neue&apos;; font-size:9pt;&quot;&gt;Python than with FME&lt;/span&gt;&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&lt;span style=&quot; font-family:&apos;helvetica neue&apos;; font-size:9pt;&quot;&gt;transformers.&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;"
#!   POSITION="-1199.9999999999998 300"
#!   TOP_LEFT="-1199.9999999999998 300"
#!   BOTTOM_RIGHT="-701.9173941739416 92.998229982299819"
#!   BOUNDING_RECT="-1199.9999999999998 300 498.08260582605823 207.00177001770018"
#!   ORDER="500000000000000"
#!   FOLLOW_ANCHOR="true"
#!   INFO_NODE="false"
#!   COLOUR="1,1,0.78431372549019607,0.19215686274509805"
#!   SIZE_POLICY="8"
#!   ANCHORED_NODE="4"
#! />
#! </COMMENTS>
#! <CONSTANTS>
#! </CONSTANTS>
#! <BOOKMARKS>
#! </BOOKMARKS>
#! <TRANSFORMERS>
#! <TRANSFORMER
#!   IDENTIFIER="4"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="-1197.0014700146992 3.0000300003000007"
#!   BOUNDING_RECT="-1197.0014700146992 3.0000300003000007 516.04700000000003 71"
#!   ORDER="500000000000000"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18592"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_keys" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fmeobjects&lt;lf&gt;&lt;lf&gt;import&lt;space&gt;os&lt;lf&gt;import&lt;space&gt;os.path&lt;lf&gt;import&lt;space&gt;re&lt;lf&gt;import&lt;space&gt;csv&lt;lf&gt;import&lt;space&gt;sys&lt;lf&gt;if&lt;space&gt;sys.version_info&lt;space&gt;&lt;gt&gt;&lt;space&gt;&lt;openparen&gt;3&lt;comma&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;buffer&lt;space&gt;=&lt;space&gt;memoryview&lt;lf&gt;import&lt;space&gt;random&lt;lf&gt;import&lt;space&gt;string&lt;lf&gt;import&lt;space&gt;traceback&lt;lf&gt;import&lt;space&gt;inspect&lt;lf&gt;&lt;lf&gt;import&lt;space&gt;sqlite3&lt;lf&gt;import&lt;space&gt;logging&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Random&lt;space&gt;String&lt;space&gt;Generators&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;random_string&lt;openparen&gt;size=24&lt;comma&gt;&lt;space&gt;characters=string.ascii_lowercase&lt;space&gt;+&lt;space&gt;string.digits&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;random.choice&lt;openparen&gt;characters&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;x&lt;space&gt;in&lt;space&gt;range&lt;openparen&gt;size&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;random_path&lt;openparen&gt;directory&lt;comma&gt;&lt;space&gt;prefix=&lt;quote&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;size=24&lt;comma&gt;&lt;space&gt;characters=string.ascii_lowercase&lt;space&gt;+&lt;space&gt;string.digits&lt;comma&gt;&lt;space&gt;suffix=&lt;quote&gt;&lt;quote&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;while&lt;space&gt;True:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;path&lt;space&gt;=&lt;space&gt;os.path.join&lt;openparen&gt;directory&lt;comma&gt;&lt;space&gt;prefix&lt;space&gt;+&lt;space&gt;random_string&lt;openparen&gt;size&lt;comma&gt;&lt;space&gt;characters&lt;closeparen&gt;&lt;space&gt;+&lt;space&gt;suffix&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;fd&lt;space&gt;=&lt;space&gt;os.open&lt;openparen&gt;path&lt;comma&gt;&lt;space&gt;os.O_RDONLY&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.close&lt;openparen&gt;fd&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;continue&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;OSError:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;break&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;path&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Text&lt;space&gt;Interpretation&lt;lf&gt;&lt;lf&gt;FME_TAG_CODE_TRANSLATIONS&lt;space&gt;=&lt;space&gt;&lt;opencurly&gt;&lt;apos&gt;lf&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;div.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;br.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;p.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;cr&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;r&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;space&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;tab&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;t&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;comma&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;solidus&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;solidus&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;apos&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;openparen&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;openparen&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closeparen&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;closeparen&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;openbracket&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;openbracket&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closebracket&lt;apos&gt;:&lt;space&gt;&lt;apos&gt;&lt;closebracket&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;opencurly&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;opencurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closecurly&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;closecurly&gt;&lt;apos&gt;&lt;closecurly&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;interpret_fme_character_tags&lt;openparen&gt;raw_text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;raw_text&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;fme_tag_code&lt;space&gt;in&lt;space&gt;FME_TAG_CODE_TRANSLATIONS.keys&lt;openparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;&lt;apos&gt;&lt;lt&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;fme_tag_code&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;FME_TAG_CODE_TRANSLATIONS&lt;openbracket&gt;fme_tag_code&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;result&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;result&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;sanitize_text&lt;openparen&gt;raw_text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Replace&lt;space&gt;FME&lt;space&gt;tags&lt;comma&gt;&lt;space&gt;HTML&lt;space&gt;tags&lt;space&gt;or&lt;space&gt;SQL&lt;space&gt;meta-characters&lt;space&gt;with&lt;space&gt;clean&lt;space&gt;and&lt;space&gt;safe&lt;space&gt;equivalents.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;interpret_fme_character_tags&lt;openparen&gt;raw_text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;quote&gt;&lt;apos&gt;&lt;openbracket&gt;&lt;closeparen&gt;&lt;backslash&gt;&lt;quote&gt;&lt;semicolon&gt;!=&lt;closebracket&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;SQL&lt;space&gt;metacharacters.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;lt&gt;.+?&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;all&lt;space&gt;HTML&lt;space&gt;tags.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;^&lt;gt&gt;&lt;openbracket&gt;&lt;backslash&gt;t&lt;space&gt;&lt;closebracket&gt;*&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;email&lt;space&gt;quoting&lt;space&gt;prefixes.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;result&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;extract_dict_from_tab_delimited_data&lt;openparen&gt;text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;rows&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;openbracket&gt;&lt;space&gt;&lt;backslash&gt;t&lt;closebracket&gt;+&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;&lt;backslash&gt;t&lt;quote&gt;&lt;comma&gt;&lt;space&gt;text&lt;closeparen&gt;.splitlines&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Replace&lt;space&gt;repeated&lt;space&gt;delimiter&lt;space&gt;characters&lt;space&gt;by&lt;space&gt;a&lt;space&gt;single&lt;space&gt;tab&lt;space&gt;to&lt;space&gt;simplify&lt;space&gt;extraction.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;&lt;openbracket&gt;row&lt;space&gt;for&lt;space&gt;row&lt;space&gt;in&lt;space&gt;csv.DictReader&lt;openparen&gt;rows&lt;comma&gt;&lt;space&gt;&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;type&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;ordinality&lt;apos&gt;&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;None&lt;comma&gt;&lt;space&gt;None&lt;comma&gt;&lt;space&gt;&lt;apos&gt;excel-tab&lt;apos&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Logging&lt;space&gt;Support&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FMELogFormatter&lt;openparen&gt;logging.Formatter&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;arg&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;super&lt;openparen&gt;FMELogFormatter&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.arg&lt;space&gt;=&lt;space&gt;arg&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FMELogHandler&lt;openparen&gt;logging.Handler&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;emit&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;record&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Emit&lt;space&gt;a&lt;space&gt;log&lt;space&gt;record.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger&lt;space&gt;=&lt;space&gt;fmeobjects.FMELogFile&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger.logMessageString&lt;openparen&gt;record.getMessage&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;getFMELogger&lt;openparen&gt;name&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Get&lt;space&gt;an&lt;space&gt;FME&lt;space&gt;logger.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger&lt;space&gt;=&lt;space&gt;logging.getLogger&lt;openparen&gt;name&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;formatter&lt;space&gt;=&lt;space&gt;logging.Formatter&lt;openparen&gt;&lt;quote&gt;%&lt;openparen&gt;asctime&lt;closeparen&gt;s&lt;space&gt;%&lt;openparen&gt;levelname&lt;closeparen&gt;s:&lt;space&gt;%&lt;openparen&gt;message&lt;closeparen&gt;s&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;handler&lt;space&gt;=&lt;space&gt;FMELogHandler&lt;openparen&gt;level=&lt;quote&gt;INFO&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;handler.setFormatter&lt;openparen&gt;formatter&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger.addHandler&lt;openparen&gt;handler&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;logger&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Exception&lt;solidus&gt;Error&lt;space&gt;Classes&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;MGSError&lt;openparen&gt;Exception&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;class&lt;space&gt;for&lt;space&gt;exceptions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;message&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;super&lt;openparen&gt;MGSError&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;message&lt;closeparen&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;type&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Error&lt;space&gt;type&lt;space&gt;string.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;Error&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;instructions&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Post-message&lt;space&gt;instructions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;MGSSystemError&lt;openparen&gt;MGSError&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;message&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;super&lt;openparen&gt;MGSSystemError&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;message&lt;closeparen&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;type&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Error&lt;space&gt;type&lt;space&gt;string.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;instructions&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Post-message&lt;space&gt;instructions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;FME&lt;space&gt;Template&lt;space&gt;Class&lt;space&gt;Interface&lt;lf&gt;&lt;lf&gt;TEMP&lt;space&gt;=&lt;space&gt;&lt;apos&gt;FME_SHAREDRESOURCE_TEMP&lt;apos&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.temp_directory&lt;space&gt;=&lt;space&gt;FME_MacroValues&lt;openbracket&gt;TEMP&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Default&lt;space&gt;for&lt;space&gt;ArcGIS&lt;space&gt;Interoperability&lt;space&gt;Extension&lt;space&gt;environment.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.temp_directory&lt;space&gt;=&lt;space&gt;os.path.join&lt;openparen&gt;&lt;apos&gt;Resources&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;Temp&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;If&lt;space&gt;temp&lt;space&gt;path&lt;space&gt;does&lt;space&gt;not&lt;space&gt;exist&lt;comma&gt;&lt;space&gt;attempt&lt;space&gt;to&lt;space&gt;create&lt;space&gt;it.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;not&lt;space&gt;os.path.isdir&lt;openparen&gt;self.temp_directory&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.makedirs&lt;openparen&gt;self.temp_directory&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;access&lt;space&gt;or&lt;space&gt;create&lt;space&gt;Temp&lt;space&gt;directory&lt;space&gt;&lt;quote&gt;%s&lt;quote&gt;&lt;space&gt;to&lt;space&gt;sort&lt;space&gt;records:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.temp_directory&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Load&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;into&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;sqlite_sort_record_number&lt;apos&gt;&lt;closeparen&gt;&lt;space&gt;==&lt;space&gt;1:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;temporary&lt;space&gt;SQLite&lt;space&gt;database&lt;space&gt;and&lt;space&gt;feature&lt;space&gt;table.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db&lt;space&gt;=&lt;space&gt;None&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;keys&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;sqlite_sort_keys&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Configure&lt;space&gt;database&lt;space&gt;file&lt;space&gt;path&lt;space&gt;and&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;name.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db_path&lt;space&gt;=&lt;space&gt;random_path&lt;openparen&gt;directory=self.temp_directory&lt;comma&gt;&lt;space&gt;prefix=&lt;apos&gt;SQLiteSorter_&lt;apos&gt;&lt;comma&gt;&lt;space&gt;suffix=&lt;apos&gt;.sqlite&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.table_name&lt;space&gt;=&lt;space&gt;&lt;apos&gt;features&lt;apos&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;SQL&lt;space&gt;DDF&lt;space&gt;key&lt;space&gt;column&lt;space&gt;definitions&lt;space&gt;from&lt;space&gt;the&lt;space&gt;Sort_Keys&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.keys&lt;space&gt;=&lt;space&gt;extract_dict_from_tab_delimited_data&lt;openparen&gt;sanitize_text&lt;openparen&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;lt&gt;apos&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;&lt;apos&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;keys&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;column_defs&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;openparen&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;type&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;temporary&lt;space&gt;database&lt;space&gt;and&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;with&lt;space&gt;a&lt;space&gt;BLOB&lt;space&gt;to&lt;space&gt;contain&lt;space&gt;the&lt;space&gt;serialized&lt;space&gt;feature.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db&lt;space&gt;=&lt;space&gt;sqlite3.connect&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.text_factory&lt;space&gt;=&lt;space&gt;str&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor&lt;space&gt;=&lt;space&gt;self.db.execute&lt;openparen&gt;&lt;quote&gt;create&lt;space&gt;table&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;column_defs&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;feature&lt;space&gt;BLOB&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;create&lt;space&gt;index&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;quote&gt;_index&lt;space&gt;on&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;asc&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;Exception&lt;space&gt;as&lt;space&gt;e:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;open&lt;space&gt;SQLite&lt;space&gt;database&lt;space&gt;&lt;quote&gt;%s&lt;quote&gt;&lt;space&gt;to&lt;space&gt;sort&lt;space&gt;records:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.db_path&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;hasattr&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;&lt;apos&gt;db&lt;apos&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Construct&lt;space&gt;insertion&lt;space&gt;statement&lt;space&gt;elements.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;key_names&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;key_placeholders&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;apos&gt;?&lt;apos&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;all_values&lt;space&gt;=&lt;space&gt;&lt;openbracket&gt;self.get_feature_attribute&lt;openparen&gt;feature&lt;comma&gt;&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;openbracket&gt;buffer&lt;openparen&gt;self.serialize_feature&lt;openparen&gt;feature&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Insert&lt;space&gt;the&lt;space&gt;feature&lt;space&gt;record&lt;space&gt;into&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;insert&lt;space&gt;into&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key_names&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;&lt;space&gt;values&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key_placeholders&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;?&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;all_values&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;store&lt;space&gt;records&lt;space&gt;in&lt;space&gt;SQLite&lt;space&gt;for&lt;space&gt;sorting:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Read&lt;space&gt;all&lt;space&gt;stored&lt;space&gt;features&lt;space&gt;from&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;in&lt;space&gt;the&lt;space&gt;requested&lt;space&gt;order.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;hasattr&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;&lt;apos&gt;db&lt;apos&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.commit&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Construct&lt;space&gt;the&lt;space&gt;ORDER&lt;space&gt;BY&lt;space&gt;clause.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;sort_defs&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;openparen&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;ordinality&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Execute&lt;space&gt;the&lt;space&gt;query&lt;space&gt;and&lt;space&gt;output&lt;space&gt;the&lt;space&gt;features&lt;space&gt;in&lt;space&gt;sorted&lt;space&gt;order&lt;comma&gt;&lt;space&gt;reconstructing&lt;space&gt;them&lt;space&gt;from&lt;space&gt;the&lt;space&gt;serialized&lt;space&gt;copy&lt;space&gt;in&lt;space&gt;the&lt;space&gt;temporary&lt;space&gt;table.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;feature_record&lt;space&gt;in&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;select&lt;space&gt;feature&lt;space&gt;from&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;order&lt;space&gt;by&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;sort_defs&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.output_feature_from_blob&lt;openparen&gt;feature_record&lt;openbracket&gt;0&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;sort&lt;space&gt;records&lt;space&gt;via&lt;space&gt;SQLite:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Don&lt;apos&gt;t&lt;space&gt;leave&lt;space&gt;temporary&lt;space&gt;resource&lt;space&gt;files&lt;space&gt;behind.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;output_feature_from_blob&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;blob&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature&lt;space&gt;=&lt;space&gt;self.deserialize_feature&lt;openparen&gt;blob&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.output_feature&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;deserialize_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;blob&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.deserialize&lt;openparen&gt;bytearray&lt;openparen&gt;blob&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;output_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;get_feature_attribute&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;comma&gt;&lt;space&gt;feature_name&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature.getAttribute&lt;openparen&gt;feature_name&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;serialize_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature.serialize&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="SQLiteSortPythonCaller"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="8"
#!   TYPE="Counter"
#!   VERSION="2"
#!   POSITION="-3600 0"
#!   BOUNDING_RECT="-3600 0 -1 -1"
#!   ORDER="500000000000001"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="fme_rejection_code" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="CNT_ATTR" PARM_VALUE="sqlite_sort_record_number"/>
#!     <XFORM_PARM PARM_NAME="DOMAIN" PARM_VALUE="sqlite_sort_counter"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SCOPE" PARM_VALUE="Local"/>
#!     <XFORM_PARM PARM_NAME="START" PARM_VALUE="1"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Counter"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="11"
#!   TYPE="ParameterFetcher"
#!   VERSION="4"
#!   POSITION="-1946.9999699997002 303.00303003030035"
#!   BOUNDING_RECT="-1946.9999699997002 303.00303003030035 -1 -1"
#!   ORDER="500000000000002"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_keys" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ATTR_LIST" PARM_VALUE="sqlite_sort_keys $(Sort_Keys)"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ParameterFetcher"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="14"
#!   TYPE="Sampler"
#!   VERSION="4"
#!   POSITION="-2843.990939909399 -3.0000300002999438"
#!   BOUNDING_RECT="-2843.990939909399 -3.0000300002999438 -1 -1"
#!   ORDER="500000000000003"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="SAMPLED"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="NOT_SAMPLED"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="RATE" PARM_VALUE="1"/>
#!     <XFORM_PARM PARM_NAME="SAMPLE_MODE" PARM_VALUE="No"/>
#!     <XFORM_PARM PARM_NAME="SAMPLE_TYPE_LONG" PARM_VALUE="First N Features"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Sampler"/>
#! </TRANSFORMER>
#! </TRANSFORMERS>
#! <SUBDOCUMENT_IOS>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="2"
#!   NAME="Input"
#!   POSITION="-4350 0"
#!   BOUNDING_RECT="-4350 0 -1 -1"
#!   COLLAPSED="true"
#!   PUBLISHED="true"
#!   IS_SOURCE="true"
#!   ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="3"
#!   NAME="Sorted"
#!   POSITION="-447.00147001469827 3.0000300003000007"
#!   BOUNDING_RECT="-447.00147001469827 3.0000300003000007 -1 -1"
#!   COLLAPSED="true"
#!   IS_SOURCE="false"
#!   ATTR_MODE="1"
#! >
#! </SUBDOCUMENT_IO>
#! </SUBDOCUMENT_IOS>
#! <FEAT_LINKS>
#! <FEAT_LINK
#!   IDENTIFIER="21"
#!   SOURCE_NODE="2"
#!   TARGET_NODE="8"
#!   SOURCE_PORT_DESC="0"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="6"
#!   SOURCE_NODE="4"
#!   TARGET_NODE="3"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="0"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="15"
#!   SOURCE_NODE="8"
#!   TARGET_NODE="14"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="13"
#!   SOURCE_NODE="11"
#!   TARGET_NODE="4"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="16"
#!   SOURCE_NODE="14"
#!   TARGET_NODE="11"
#!   SOURCE_PORT_DESC="fo 0 SAMPLED"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="17"
#!   SOURCE_NODE="14"
#!   TARGET_NODE="4"
#!   SOURCE_PORT_DESC="fo 1 NOT_SAMPLED"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! </FEAT_LINKS>
#! <BREAKPOINTS>
#! </BREAKPOINTS>
#! <ATTR_LINKS>
#! </ATTR_LINKS>
#! <SUBDOCUMENTS>
#! </SUBDOCUMENTS>
#! <LOOKUP_TABLES>
#! </LOOKUP_TABLES>
#! </TRANSFORMER>

FME_PYTHON_VERSION 2or3
DEFAULT_MACRO $(SQLiteSorter_WORKSPACE_NAME)_Sort_Keys 
#! START_HEADER
#! END_HEADER

DEFAULT_MACRO WB_CURRENT_CONTEXT
DEFAULT_MACRO SQLiteSorter_WORKSPACE_NAME ""
INCLUDE [puts {MACRO WB_OLD_CONTEXT_$(SQLiteSorter_WORKSPACE_NAME) $(WB_CURRENT_CONTEXT)};          puts {MACRO WB_CURRENT_CONTEXT $(SQLiteSorter_WORKSPACE_NAME)}]
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Input1563835989 Input Splitter"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"   OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"
# -------------------------------------------------------------------------
# Create the DomainName that this transformer will use.
# Because @Count itself will evalute the expression to calculate the
# domain, we don't need to do anything in Tcl per feature going by
INCLUDE [    set domainPrefix {};    if { {Local} == {Local} }    {       set domainPrefix [FME_EncodeText {$(SQLiteSorter_WORKSPACE_NAME)_Counter_}];    };    puts "MACRO $(SQLiteSorter_WORKSPACE_NAME)_Counter_FULL_DOMAIN ${domainPrefix}sqlite_sort_counter"; ]
FACTORY_DEF * ExecuteFunctionFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Counter_Rejector    COMMAND_PARM_EVALUATION SINGLE_PASS    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"    FUNCTION_DEFINITION @Count(REJECTABLE_WITH_FLAG,fme_encoded,$($(SQLiteSorter_WORKSPACE_NAME)_Counter_FULL_DOMAIN),"1")    RESULT_ATTRIBUTE "sqlite_sort_record_number"    OUTPUT COMPLETE FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_OUTPUT"    OUTPUT REJECTED FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_<REJECTED>"
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Counter <REJECTED> Transformer Output Nuker"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_<REJECTED>"
# -------------------------------------------------------------------------
# If we're doing LAST N features, then the multiplier comes in as 0.
# If we're doing First N, multiplier is -1.
# For RANDOM, we need to treat LAST N as if it was first N (i.e. have a -1)
# That is what the ? : does in the rate multiplier.
INCLUDE [ if { {-1} == {0} && {ORIGINAL} == {ORIGINAL} } {              puts "MACRO REAL_MODE LAST"; 	         puts "MACRO REAL_RATE 1"; 	      } else {              puts "MACRO REAL_MODE ORIGINAL";              puts "MACRO REAL_RATE [expr 1 * ( -1 ? -1 : -1 ) ]"; 	      } ]
FACTORY_DEF {*} SamplingFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Sampler    COMMAND_PARM_EVALUATION SINGLE_PASS    SAMPLE_RATE $(REAL_RATE)    SAMPLE_ORDER $(REAL_MODE)    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_OUTPUT"    OUTPUT SAMPLED FEATURE_TYPE ___SAMPLED___    OUTPUT NOT_SAMPLED FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_NOT_SAMPLED"
# This TeeFactory is needed because Sampler will still output features if it has no OUTPUT clauses specified.
# This way we behave nicely even if there are no output connections on the transformer. See PR#28886.
FACTORY_DEF * TeeFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Sampler_Sampled    INPUT FEATURE_TYPE ___SAMPLED___    OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_SAMPLED"
# -------------------------------------------------------------------------
Tcl2 proc $(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_doFetch {} {    foreach {name val} {"sqlite_sort_keys {$($(SQLiteSorter_WORKSPACE_NAME)_Sort_Keys)}"} {         if { [string match {*<at>*} $val] == 1 } {             set val [FME_Execute EvaluateExpression {STRING} $val {$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher}];         } elseif {[string match {*FME_CONDITIONAL*} $val] == 1} {             set val [FME_Execute EvaluateExpression {STRING} $val {$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher}];         } else {             set val [FME_DecodeTextOrAttr $val];         };       FME_SetAttribute [FME_DecodeText $name] $val    } }
FACTORY_DEF * TeeFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_SAMPLED"    OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_OUTPUT"         @Tcl2($(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_doFetch)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF * PythonFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_OUTPUT"    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_NOT_SAMPLED"    SYMBOL_NAME FeatureProcessor    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE import<space>fmeobjects<lf><lf>import<space>os<lf>import<space>os.path<lf>import<space>re<lf>import<space>csv<lf>import<space>sys<lf>if<space>sys.version_info<space><gt><space><openparen>3<comma><closeparen>:<lf><space><space><space><space>buffer<space>=<space>memoryview<lf>import<space>random<lf>import<space>string<lf>import<space>traceback<lf>import<space>inspect<lf><lf>import<space>sqlite3<lf>import<space>logging<lf><lf><lf><lf>#<space>Random<space>String<space>Generators<lf><lf>def<space>random_string<openparen>size=24<comma><space>characters=string.ascii_lowercase<space>+<space>string.digits<closeparen>:<lf><space><space><space><space>return<space><apos><apos>.join<openparen>random.choice<openparen>characters<closeparen><space>for<space>x<space>in<space>range<openparen>size<closeparen><closeparen><lf><lf><lf>def<space>random_path<openparen>directory<comma><space>prefix=<quote><quote><comma><space>size=24<comma><space>characters=string.ascii_lowercase<space>+<space>string.digits<comma><space>suffix=<quote><quote><closeparen>:<lf><space><space><space><space>while<space>True:<lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>path<space>=<space>os.path.join<openparen>directory<comma><space>prefix<space>+<space>random_string<openparen>size<comma><space>characters<closeparen><space>+<space>suffix<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>fd<space>=<space>os.open<openparen>path<comma><space>os.O_RDONLY<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>os.close<openparen>fd<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>continue<lf><space><space><space><space><space><space><space><space>except<space>OSError:<lf><space><space><space><space><space><space><space><space><space><space><space><space>break<lf><space><space><space><space>return<space>path<lf><lf><lf><lf>#<space>Text<space>Interpretation<lf><lf>FME_TAG_CODE_TRANSLATIONS<space>=<space><opencurly><apos>lf<apos>:<space><space><space><space><space><space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>div.*?<apos>:<space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>br.*?<apos>:<space><space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>p.*?<apos>:<space><space><space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>cr<apos>:<space><space><space><space><space><space><space><space><space><space><space><apos><backslash>r<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>space<apos>:<space><space><space><space><space><space><space><space><apos><space><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>tab<apos>:<space><space><space><space><space><space><space><space><space><space><apos><backslash>t<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>comma<apos>:<space><space><space><space><space><space><space><space><apos><comma><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>solidus<apos>:<space><space><space><space><space><space><apos><solidus><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>apos<apos>:<space><space><space><space><space><space><space><space><space><apos><comma><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>openparen<apos>:<space><space><space><space><apos><openparen><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closeparen<apos>:<space><space><space><apos><closeparen><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>openbracket<apos>:<space><space><apos><openbracket><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closebracket<apos>:<space><apos><closebracket><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>opencurly<apos>:<space><space><space><space><apos><opencurly><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closecurly<apos>:<space><space><space><apos><closecurly><apos><closecurly><lf><lf>def<space>interpret_fme_character_tags<openparen>raw_text<closeparen>:<lf><space><space><space><space>result<space>=<space>raw_text<lf><space><space><space><space>for<space>fme_tag_code<space>in<space>FME_TAG_CODE_TRANSLATIONS.keys<openparen><closeparen>:<lf><space><space><space><space><space><space><space><space>result<space>=<space>re.sub<openparen><apos><lt><apos><space>+<space>fme_tag_code<space>+<space><apos><gt><apos><comma><space>FME_TAG_CODE_TRANSLATIONS<openbracket>fme_tag_code<closebracket><comma><space>result<closeparen><lf><space><space><space><space>return<space>result<lf><lf>def<space>sanitize_text<openparen>raw_text<closeparen>:<lf><space><space><space><space><quote><quote><quote>Replace<space>FME<space>tags<comma><space>HTML<space>tags<space>or<space>SQL<space>meta-characters<space>with<space>clean<space>and<space>safe<space>equivalents.<quote><quote><quote><lf><space><space><space><space>result<space>=<space>interpret_fme_character_tags<openparen>raw_text<closeparen><lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<quote><apos><openbracket><closeparen><backslash><quote><semicolon>!=<closebracket><quote><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space>#<space>Sanitize<space>SQL<space>metacharacters.<lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<apos><lt>.+?<gt><apos><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space><space><space><space><space>#<space>Sanitize<space>all<space>HTML<space>tags.<lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<apos>^<gt><openbracket><backslash>t<space><closebracket>*<apos><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space><space>#<space>Sanitize<space>email<space>quoting<space>prefixes.<lf><space><space><space><space>return<space>result<lf><lf>def<space>extract_dict_from_tab_delimited_data<openparen>text<closeparen>:<lf><space><space><space><space>rows<space>=<space>re.sub<openparen>r<apos><openbracket><space><backslash>t<closebracket>+<apos><comma><space><quote><backslash>t<quote><comma><space>text<closeparen>.splitlines<openparen><closeparen><space><space>#<space>Replace<space>repeated<space>delimiter<space>characters<space>by<space>a<space>single<space>tab<space>to<space>simplify<space>extraction.<lf><space><space><space><space>return<space><openbracket>row<space>for<space>row<space>in<space>csv.DictReader<openparen>rows<comma><space><openbracket><apos>name<apos><comma><space><apos>type<apos><comma><space><apos>ordinality<apos><closebracket><comma><space>None<comma><space>None<comma><space><apos>excel-tab<apos><closeparen><closebracket><lf><lf><lf><lf>#<space>Logging<space>Support<lf><lf>class<space>FMELogFormatter<openparen>logging.Formatter<closeparen>:<lf><space><space><space><space>def<space>__init__<openparen>self<comma><space>arg<closeparen>:<lf><space><space><space><space><space><space><space><space>super<openparen>FMELogFormatter<comma><space>self<closeparen>.__init__<openparen><closeparen><lf><space><space><space><space><space><space><space><space>self.arg<space>=<space>arg<lf><lf><lf>class<space>FMELogHandler<openparen>logging.Handler<closeparen>:<lf><space><space><space><space>def<space>emit<openparen>self<comma><space>record<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Emit<space>a<space>log<space>record.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>logger<space>=<space>fmeobjects.FMELogFile<openparen><closeparen><lf><space><space><space><space><space><space><space><space>logger.logMessageString<openparen>record.getMessage<openparen><closeparen><closeparen><lf><lf>def<space>getFMELogger<openparen>name<closeparen>:<lf><space><space><space><space><quote><quote><quote>Get<space>an<space>FME<space>logger.<quote><quote><quote><lf><space><space><space><space>logger<space>=<space>logging.getLogger<openparen>name<closeparen><lf><space><space><space><space>formatter<space>=<space>logging.Formatter<openparen><quote>%<openparen>asctime<closeparen>s<space>%<openparen>levelname<closeparen>s:<space>%<openparen>message<closeparen>s<quote><closeparen><lf><space><space><space><space>handler<space>=<space>FMELogHandler<openparen>level=<quote>INFO<quote><closeparen><lf><space><space><space><space>handler.setFormatter<openparen>formatter<closeparen><lf><space><space><space><space>logger.addHandler<openparen>handler<closeparen><lf><space><space><space><space>return<space>logger<lf><lf><lf><lf>#<space>Exception<solidus>Error<space>Classes<lf><lf>class<space>MGSError<openparen>Exception<closeparen>:<lf><tab><quote><quote><quote>Base<space>class<space>for<space>exceptions.<quote><quote><quote><lf><tab><lf><tab>def<space>__init__<openparen>self<comma><space>message<closeparen>:<lf><tab><tab>super<openparen>MGSError<comma><space>self<closeparen>.__init__<openparen>message<closeparen><lf><tab><lf><tab>def<space>type<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Error<space>type<space>string.<quote><quote><quote><lf><tab><tab>return<space><quote>Error<quote><lf><tab><lf><tab>def<space>instructions<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Post-message<space>instructions.<quote><quote><quote><lf><tab><tab>return<space><quote><quote><quote>Please<space>try<space>again.<quote><quote><quote><lf><lf>class<space>MGSSystemError<openparen>MGSError<closeparen>:<lf><tab><lf><tab>def<space>__init__<openparen>self<comma><space>message<closeparen>:<lf><tab><tab>super<openparen>MGSSystemError<comma><space>self<closeparen>.__init__<openparen>message<closeparen><lf><tab><lf><tab>def<space>type<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Error<space>type<space>string.<quote><quote><quote><lf><tab><tab>return<space><quote>Unexpected<space>System<space>Error<quote><lf><tab><lf><tab>def<space>instructions<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Post-message<space>instructions.<quote><quote><quote><lf><tab><tab>return<space><quote><quote><quote>Please<space>try<space>again.<quote><quote><quote><lf><lf><lf><lf>#<space>FME<space>Template<space>Class<space>Interface<lf><lf>TEMP<space>=<space><apos>FME_SHAREDRESOURCE_TEMP<apos><lf><lf>class<space>FeatureProcessor:<lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.temp_directory<space>=<space>FME_MacroValues<openbracket>TEMP<closebracket><lf><space><space><space><space><space><space><space><space>except:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Default<space>for<space>ArcGIS<space>Interoperability<space>Extension<space>environment.<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.temp_directory<space>=<space>os.path.join<openparen><apos>Resources<apos><comma><space><apos>Temp<apos><closeparen><lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>If<space>temp<space>path<space>does<space>not<space>exist<comma><space>attempt<space>to<space>create<space>it.<lf><space><space><space><space><space><space><space><space><space><space><space><space>if<space>not<space>os.path.isdir<openparen>self.temp_directory<closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>os.makedirs<openparen>self.temp_directory<closeparen><lf><space><space><space><space><space><space><space><space>except:<lf><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>access<space>or<space>create<space>Temp<space>directory<space><quote>%s<quote><space>to<space>sort<space>records:<space>%s<backslash>n%s<apos><comma><space>self.temp_directory<comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Load<space>a<space>feature<space>into<space>the<space>sort<space>table.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>feature.getAttribute<openparen><apos>sqlite_sort_record_number<apos><closeparen><space>==<space>1:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>temporary<space>SQLite<space>database<space>and<space>feature<space>table.<quote><quote><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db<space>=<space>None<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>keys<space>=<space>feature.getAttribute<openparen><apos>sqlite_sort_keys<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Configure<space>database<space>file<space>path<space>and<space>sort<space>table<space>name.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db_path<space>=<space>random_path<openparen>directory=self.temp_directory<comma><space>prefix=<apos>SQLiteSorter_<apos><comma><space>suffix=<apos>.sqlite<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.table_name<space>=<space><apos>features<apos><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>SQL<space>DDF<space>key<space>column<space>definitions<space>from<space>the<space>Sort_Keys<space>parameter.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.keys<space>=<space>extract_dict_from_tab_delimited_data<openparen>sanitize_text<openparen>re.sub<openparen>r<apos><lt>apos<gt><apos><comma><space><quote><apos><quote><comma><space>keys<closeparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>column_defs<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><openparen>key<openbracket><apos>name<apos><closebracket><space>+<space><apos><space><apos><space>+<space>key<openbracket><apos>type<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>temporary<space>database<space>and<space>sort<space>table<space>with<space>a<space>BLOB<space>to<space>contain<space>the<space>serialized<space>feature.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db<space>=<space>sqlite3.connect<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.text_factory<space>=<space>str<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor<space>=<space>self.db.execute<openparen><quote>create<space>table<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>column_defs<space>+<space><quote><comma><space>feature<space>BLOB<closeparen><semicolon><quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>for<space>key<space>in<space>self.keys:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.execute<openparen><quote>create<space>index<space><quote><space>+<space>key<openbracket><apos>name<apos><closebracket><space>+<space><quote>_index<space>on<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>key<openbracket><apos>name<apos><closebracket><space>+<space><quote><space>asc<closeparen><semicolon><quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>except<space>Exception<space>as<space>e:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>open<space>SQLite<space>database<space><quote>%s<quote><space>to<space>sort<space>records:<space>%s<backslash>n%s<apos><comma><space>self.db_path<comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>if<space>hasattr<openparen>self<comma><space><apos>db<apos><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Construct<space>insertion<space>statement<space>elements.<lf><space><space><space><space><space><space><space><space><space><space><space><space>key_names<space>=<space><apos><comma><space><apos>.join<openparen><openbracket>key<openbracket><apos>name<apos><closebracket><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>key_placeholders<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><apos>?<apos><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>all_values<space>=<space><openbracket>self.get_feature_attribute<openparen>feature<comma><space>key<openbracket><apos>name<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><space>+<space><openbracket>buffer<openparen>self.serialize_feature<openparen>feature<closeparen><closeparen><closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Insert<space>the<space>feature<space>record<space>into<space>the<space>sort<space>table.<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.execute<openparen><quote>insert<space>into<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>key_names<space>+<space><quote><comma><space>feature<closeparen><space>values<space><openparen><quote><space>+<space>key_placeholders<space>+<space><quote><comma><space>?<closeparen><semicolon><quote><comma><space>all_values<closeparen><lf><space><space><space><space><space><space><space><space>except:<lf><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>store<space>records<space>in<space>SQLite<space>for<space>sorting:<space>%s<backslash>n%s<apos><comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Read<space>all<space>stored<space>features<space>from<space>the<space>sort<space>table<space>in<space>the<space>requested<space>order.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>hasattr<openparen>self<comma><space><apos>db<apos><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.commit<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Construct<space>the<space>ORDER<space>BY<space>clause.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>sort_defs<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><openparen>key<openbracket><apos>name<apos><closebracket><space>+<space><apos><space><apos><space>+<space>key<openbracket><apos>ordinality<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Execute<space>the<space>query<space>and<space>output<space>the<space>features<space>in<space>sorted<space>order<comma><space>reconstructing<space>them<space>from<space>the<space>serialized<space>copy<space>in<space>the<space>temporary<space>table.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>for<space>feature_record<space>in<space>self.cursor.execute<openparen><quote>select<space>feature<space>from<space><quote><space>+<space>self.table_name<space>+<space><quote><space>order<space>by<space><quote><space>+<space>sort_defs<space>+<space><quote><semicolon><quote><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.output_feature_from_blob<openparen>feature_record<openbracket>0<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>except:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>sort<space>records<space>via<space>SQLite:<space>%s<backslash>n%s<apos><comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Don<apos>t<space>leave<space>temporary<space>resource<space>files<space>behind.<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#os.unlink<openparen>self.db_path<closeparen><lf><lf><space><space><space><space>def<space>output_feature_from_blob<openparen>self<comma><space>blob<closeparen>:<lf><space><space><space><space><space><space><space><space>feature<space>=<space>self.deserialize_feature<openparen>blob<closeparen><lf><space><space><space><space><space><space><space><space>self.output_feature<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>deserialize_feature<openparen>self<comma><space>blob<closeparen>:<lf><space><space><space><space><space><space><space><space>feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space>feature.deserialize<openparen>bytearray<openparen>blob<closeparen><closeparen><lf><space><space><space><space><space><space><space><space>return<space>feature<lf><lf><space><space><space><space>def<space>output_feature<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>get_feature_attribute<openparen>self<comma><space>feature<comma><space>feature_name<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space>feature.getAttribute<openparen>feature_name<closeparen><lf><lf><space><space><space><space>def<space>serialize_feature<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space>feature.serialize<openparen><closeparen><lf>    OUTPUT PYOUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller_OUTPUT"
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Sorted1563835989 Output Collector"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller_OUTPUT"   OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sorted" @RemoveAttributes(sqlite_sort_record_number,sqlite_sort_keys)
INCLUDE [puts {MACRO WB_CURRENT_CONTEXT $(WB_OLD_CONTEXT_$(SQLiteSorter_WORKSPACE_NAME))}]
#! <?xml version="1.0" encoding="UTF-8" ?>
#! <TRANSFORMER
# TRANSFORMER_BEGIN SQLiteSorter,10,Workflows,5ae3c49c-091f-41eb-9e8d-1a348a8155cf,"Linked by Default",No,NO_PARALLELISM,,No,18592,YES,No,2or3
# <p>An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.</p>
# <p>For issues or questions, please Create an issue <a href="https://github.com/modgeosys/fme-components/issues_">here</a>.  For the source, including test driver components, please see the <a href="https://github.com/modgeosys/fme-components_">Github repository</a>.</p>
# <p>Copyright &copy; 2017-2019 by Modern geoSystems, released under <a href="https://github.com/modgeosys/fme-components/raw/master/LICENSE">this BSD 3-clause license</a>.</p>
# TRANSFORMER_END
#!   ATTR_TYPE_ENCODING="SDF"
#!   BLOCKED_LOOPING="No"
#!   CATEGORY="Workflows"
#!   DESCRIPTION="&lt;p&gt;An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.&lt;/p&gt;&#10;&lt;p&gt;For issues or questions, please Create an issue &lt;a href=&quot;https://github.com/modgeosys/fme-components/issues_&quot;&gt;here&lt;/a&gt;.  For the source, including test driver components, please see the &lt;a href=&quot;https://github.com/modgeosys/fme-components_&quot;&gt;Github repository&lt;/a&gt;.&lt;/p&gt;&#10;&lt;p&gt;Copyright &amp;copy; 2017-2019 by Modern geoSystems, released under &lt;a href=&quot;https://github.com/modgeosys/fme-components/raw/master/LICENSE&quot;&gt;this BSD 3-clause license&lt;/a&gt;.&lt;/p&gt;"
#!   DOC_EXTENTS="3903 371.003"
#!   DOC_TOP_LEFT="-600 -68"
#!   EXPLICIT_BOOKMARK_ORDER="false"
#!   FME_BUILD_NUM="18592"
#!   FME_DOCUMENT_GUID="5ae3c49c-091f-41eb-9e8d-1a348a8155cf"
#!   FME_DOCUMENT_PRIORGUID="509af878-12f7-4a30-a571-fa4f40b5ee35"
#!   FME_LINKED_TRANSFORMER_VERSION="10"
#!   FME_PROCESS_COUNT="NO_PARALLELISM"
#!   FME_PROCESS_GROUPS_ORDERED="No"
#!   FME_PROCESS_GROUP_BY=""
#!   FME_SERVER_SERVICES=""
#!   FMX_ATTRIBUTE_PROPOGATION_MODE="AUTO"
#!   FMX_INSERT_MODE="Linked by Default"
#!   HISTORY="2017-11-26,Kevin&lt;space&gt;Weller,Initial&lt;space&gt;publication&lt;semicolon&gt;&lt;space&gt;test&lt;space&gt;workspace&lt;space&gt;fails&lt;space&gt;due&lt;space&gt;to&lt;space&gt;FME&lt;space&gt;Hub&lt;space&gt;version&lt;space&gt;delay.,2017-11-30,Kevin&lt;space&gt;Weller,Enhance&lt;space&gt;stack&lt;space&gt;trace&lt;space&gt;reporting&lt;semicolon&gt;&lt;space&gt;use&lt;space&gt;truncated&lt;space&gt;test&lt;space&gt;data&lt;space&gt;and&lt;space&gt;universal&lt;space&gt;temp&lt;space&gt;directory.,2018-01-20,Kevin&lt;space&gt;Weller,Fix&lt;space&gt;absolute&lt;space&gt;parameter&lt;space&gt;name&lt;space&gt;references&lt;space&gt;from&lt;space&gt;PythonCaller&lt;space&gt;when&lt;space&gt;SQLiteServer&lt;space&gt;is&lt;space&gt;called&lt;space&gt;from&lt;space&gt;another&lt;space&gt;custom&lt;space&gt;transformer&lt;space&gt;rather&lt;space&gt;than&lt;space&gt;from&lt;space&gt;the&lt;space&gt;top-level&lt;space&gt;workspace.,2018-03-08,Kevin&lt;space&gt;Weller,Update&lt;space&gt;documentation&lt;space&gt;to&lt;space&gt;reflect&lt;space&gt;move&lt;space&gt;from&lt;space&gt;GitHub&lt;space&gt;to&lt;space&gt;Assembla&lt;space&gt;and&lt;space&gt;Atlassian.,2018-03-18,Kevin&lt;space&gt;Weller,Fix&lt;space&gt;Python&lt;space&gt;syntax&lt;space&gt;error&lt;semicolon&gt;&lt;space&gt;test&lt;space&gt;driver&lt;space&gt;failed&lt;space&gt;to&lt;space&gt;test&lt;space&gt;latest&lt;space&gt;version&lt;comma&gt;&lt;space&gt;so&lt;space&gt;it&lt;space&gt;looked&lt;space&gt;like&lt;space&gt;it&lt;space&gt;worked&lt;space&gt;10&lt;space&gt;days&lt;space&gt;ago&lt;comma&gt;&lt;space&gt;but&lt;space&gt;it&lt;space&gt;didn&lt;apos&gt;t.&lt;space&gt;&lt;amp&gt;*^*&lt;openparen&gt;^&lt;amp&gt;^&lt;openparen&gt;&lt;amp&gt;*!,2018-07-02,Kevin&lt;space&gt;Weller,Enhance&lt;space&gt;parameter&lt;space&gt;handling&lt;space&gt;to&lt;space&gt;allow&lt;space&gt;for&lt;space&gt;multiple&lt;space&gt;references&lt;space&gt;to&lt;space&gt;the&lt;space&gt;transformer&lt;space&gt;from&lt;space&gt;the&lt;space&gt;same&lt;space&gt;calling&lt;space&gt;workspace&lt;space&gt;or&lt;space&gt;transformer.,2018-07-27,Kevin&lt;space&gt;Weller,Don&lt;apos&gt;t&lt;space&gt;expose&lt;space&gt;working&lt;space&gt;attributes&lt;space&gt;on&lt;space&gt;output&lt;space&gt;port.,2019-05-09,Kevin&lt;space&gt;Weller,Update&lt;space&gt;to&lt;space&gt;FME&lt;space&gt;2018.1.2.1&lt;space&gt;and&lt;space&gt;use&lt;space&gt;new&lt;space&gt;AttributeValidation*&lt;space&gt;framework&lt;space&gt;in&lt;space&gt;test&lt;space&gt;driver.,2019-07-22,Kevin&lt;space&gt;Weller,Allow&lt;space&gt;for&lt;space&gt;non-existent&lt;space&gt;server&lt;space&gt;parameters&lt;space&gt;as&lt;space&gt;in&lt;space&gt;the&lt;space&gt;ArcGIS&lt;space&gt;Interoperability&lt;space&gt;Extension&lt;space&gt;environment."
#!   ITERATION_COUNT_ATTR=""
#!   LAST_SAVE_BUILD="FME(R) 2018.1.2.1 (20190319 - Build 18592 - linux-x64)"
#!   LAST_SAVE_DATE="2019-07-22T12:40:34"
#!   MARKDOWN_DESCRIPTION="An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.&#10;&#10;For issues or questions, please Create an issue [here](https://github.com/modgeosys/fme-components/issues_).  For the source, including test driver components, please see the [Github repository](https://github.com/modgeosys/fme-components_).&#10;&#10;Copyright &amp;copy; 2017-2019 by Modern geoSystems, released under [this BSD 3-clause license](https://github.com/modgeosys/fme-components/raw/master/LICENSE)."
#!   MARKDOWN_USAGE="### Ports&#10;&#10;#### Input&#10;Feed the features to be sorted here.  If the input features consist of a variety of different feature types, it would be wise to ensure the sort key fields are represented in all of them.&#10;&#10;#### Output&#10;The sorted features emerge here.&#10;&#10;### Parameters&#10;&#10;#### Sort_Keys&#10;A tab- or space-delimited table of the sort keys to be applied.  The first column contains the names of the fields to be sorted, in order of sort priority.  The second column contains the database field data type.  The third and last column specifies whether the field is to be sorted in `asc`ending or `desc`ending order, e.g.:  &#10;  &#10;   `kml_name&#9;varchar asc`&#10;&#10;   `kml_id  varchar desc`  &#10;"
#!   MAX_LOOP_ITERATIONS=""
#!   PASSWORD=""
#!   PYTHON_COMPATIBILITY="2or3"
#!   SHOW_ANNOTATIONS="true"
#!   SHOW_INFO_NODES="true"
#!   TITLE="SQLiteSorter"
#!   USAGE="&lt;h3&gt;Ports&lt;/h3&gt;&#10;&lt;h4&gt;Input&lt;/h4&gt;&#10;&lt;p&gt;Feed the features to be sorted here.  If the input features consist of a variety of different feature types, it would be wise to ensure the sort key fields are represented in all of them.&lt;/p&gt;&#10;&lt;h4&gt;Output&lt;/h4&gt;&#10;&lt;p&gt;The sorted features emerge here.&lt;/p&gt;&#10;&lt;h3&gt;Parameters&lt;/h3&gt;&#10;&lt;h4&gt;Sort_Keys&lt;/h4&gt;&#10;&lt;p&gt;A tab- or space-delimited table of the sort keys to be applied.  The first column contains the names of the fields to be sorted, in order of sort priority.  The second column contains the database field data type.  The third and last column specifies whether the field is to be sorted in &lt;code&gt;asc&lt;/code&gt;ending or &lt;code&gt;desc&lt;/code&gt;ending order, e.g.:  &lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;kml_name    varchar asc&lt;/code&gt;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;kml_id  varchar desc&lt;/code&gt;  &lt;/p&gt;"
#!   USE_MARKDOWN="YES"
#!   VIEW_POSITION="-699.007 825.008"
#!   WARN_INVALID_XFORM_PARAM="Yes"
#!   WORKSPACE_VERSION="1"
#!   XFORM_DEPRECATED="No"
#!   ZOOM_SCALE="100"
#! >
#! <DATASETS>
#! </DATASETS>
#! <DATA_TYPES>
#! </DATA_TYPES>
#! <GEOM_TYPES>
#! </GEOM_TYPES>
#! <FEATURE_TYPES>
#! </FEATURE_TYPES>
#! <FMESERVER>
#! </FMESERVER>
#! <GLOBAL_PARAMETERS>
#! <GLOBAL_PARAMETER
#!   GUI_LINE="GUI TEXT_EDIT_OR_ATTR Sort_Keys &quot; &quot; Sort Keys:"
#!   DEFAULT_VALUE=""
#!   IS_STAND_ALONE="true"
#! />
#! </GLOBAL_PARAMETERS>
#! <COMMENTS>
#! <COMMENT
#!   IDENTIFIER="7"
#!   COMMENT_VALUE="&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0//EN&quot; &quot;http://www.w3.org/TR/REC-html40/strict.dtd&quot;&gt;&#10;&lt;html&gt;&lt;head&gt;&lt;meta name=&quot;qrichtext&quot; content=&quot;1&quot; /&gt;&lt;style type=&quot;text/css&quot;&gt;&#10;p, li { white-space: pre-wrap; }&#10;&lt;/style&gt;&lt;/head&gt;&lt;body style=&quot; font-family:&apos;Arial&apos;; font-size:10pt; font-weight:400; font-style:normal;&quot;&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&lt;span style=&quot; font-family:&apos;helvetica neue&apos;; font-size:9pt;&quot;&gt;This is much easier in&lt;/span&gt;&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&lt;span style=&quot; font-family:&apos;helvetica neue&apos;; font-size:9pt;&quot;&gt;Python than with FME&lt;/span&gt;&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&lt;span style=&quot; font-family:&apos;helvetica neue&apos;; font-size:9pt;&quot;&gt;transformers.&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;"
#!   POSITION="2550 300"
#!   TOP_LEFT="2550 300"
#!   BOTTOM_RIGHT="3048.0826058260582 92.998229982299819"
#!   BOUNDING_RECT="2550 300 498.08260582605823 207.00177001770018"
#!   ORDER="500000000000000"
#!   FOLLOW_ANCHOR="true"
#!   INFO_NODE="false"
#!   COLOUR="1,1,0.78431372549019607,0.19215686274509805"
#!   SIZE_POLICY="8"
#!   ANCHORED_NODE="4"
#! />
#! </COMMENTS>
#! <CONSTANTS>
#! </CONSTANTS>
#! <BOOKMARKS>
#! </BOOKMARKS>
#! <TRANSFORMERS>
#! <TRANSFORMER
#!   IDENTIFIER="4"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="2552.9985299853006 3.0000300003000007"
#!   BOUNDING_RECT="2552.9985299853006 3.0000300003000007 516.04700000000003 71"
#!   ORDER="500000000000000"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18592"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_keys" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fmeobjects&lt;lf&gt;&lt;lf&gt;import&lt;space&gt;os&lt;lf&gt;import&lt;space&gt;os.path&lt;lf&gt;import&lt;space&gt;re&lt;lf&gt;import&lt;space&gt;csv&lt;lf&gt;import&lt;space&gt;sys&lt;lf&gt;if&lt;space&gt;sys.version_info&lt;space&gt;&lt;gt&gt;&lt;space&gt;&lt;openparen&gt;3&lt;comma&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;buffer&lt;space&gt;=&lt;space&gt;memoryview&lt;lf&gt;import&lt;space&gt;random&lt;lf&gt;import&lt;space&gt;string&lt;lf&gt;import&lt;space&gt;traceback&lt;lf&gt;import&lt;space&gt;inspect&lt;lf&gt;&lt;lf&gt;import&lt;space&gt;sqlite3&lt;lf&gt;import&lt;space&gt;logging&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Random&lt;space&gt;String&lt;space&gt;Generators&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;random_string&lt;openparen&gt;size=24&lt;comma&gt;&lt;space&gt;characters=string.ascii_lowercase&lt;space&gt;+&lt;space&gt;string.digits&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;random.choice&lt;openparen&gt;characters&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;x&lt;space&gt;in&lt;space&gt;range&lt;openparen&gt;size&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;random_path&lt;openparen&gt;directory&lt;comma&gt;&lt;space&gt;prefix=&lt;quote&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;size=24&lt;comma&gt;&lt;space&gt;characters=string.ascii_lowercase&lt;space&gt;+&lt;space&gt;string.digits&lt;comma&gt;&lt;space&gt;suffix=&lt;quote&gt;&lt;quote&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;while&lt;space&gt;True:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;path&lt;space&gt;=&lt;space&gt;os.path.join&lt;openparen&gt;directory&lt;comma&gt;&lt;space&gt;prefix&lt;space&gt;+&lt;space&gt;random_string&lt;openparen&gt;size&lt;comma&gt;&lt;space&gt;characters&lt;closeparen&gt;&lt;space&gt;+&lt;space&gt;suffix&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;fd&lt;space&gt;=&lt;space&gt;os.open&lt;openparen&gt;path&lt;comma&gt;&lt;space&gt;os.O_RDONLY&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.close&lt;openparen&gt;fd&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;continue&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;OSError:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;break&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;path&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Text&lt;space&gt;Interpretation&lt;lf&gt;&lt;lf&gt;FME_TAG_CODE_TRANSLATIONS&lt;space&gt;=&lt;space&gt;&lt;opencurly&gt;&lt;apos&gt;lf&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;div.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;br.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;p.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;cr&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;r&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;space&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;tab&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;t&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;comma&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;solidus&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;solidus&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;apos&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;openparen&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;openparen&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closeparen&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;closeparen&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;openbracket&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;openbracket&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closebracket&lt;apos&gt;:&lt;space&gt;&lt;apos&gt;&lt;closebracket&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;opencurly&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;opencurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closecurly&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;closecurly&gt;&lt;apos&gt;&lt;closecurly&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;interpret_fme_character_tags&lt;openparen&gt;raw_text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;raw_text&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;fme_tag_code&lt;space&gt;in&lt;space&gt;FME_TAG_CODE_TRANSLATIONS.keys&lt;openparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;&lt;apos&gt;&lt;lt&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;fme_tag_code&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;FME_TAG_CODE_TRANSLATIONS&lt;openbracket&gt;fme_tag_code&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;result&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;result&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;sanitize_text&lt;openparen&gt;raw_text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Replace&lt;space&gt;FME&lt;space&gt;tags&lt;comma&gt;&lt;space&gt;HTML&lt;space&gt;tags&lt;space&gt;or&lt;space&gt;SQL&lt;space&gt;meta-characters&lt;space&gt;with&lt;space&gt;clean&lt;space&gt;and&lt;space&gt;safe&lt;space&gt;equivalents.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;interpret_fme_character_tags&lt;openparen&gt;raw_text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;quote&gt;&lt;apos&gt;&lt;openbracket&gt;&lt;closeparen&gt;&lt;backslash&gt;&lt;quote&gt;&lt;semicolon&gt;!=&lt;closebracket&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;SQL&lt;space&gt;metacharacters.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;lt&gt;.+?&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;all&lt;space&gt;HTML&lt;space&gt;tags.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;^&lt;gt&gt;&lt;openbracket&gt;&lt;backslash&gt;t&lt;space&gt;&lt;closebracket&gt;*&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;email&lt;space&gt;quoting&lt;space&gt;prefixes.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;result&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;extract_dict_from_tab_delimited_data&lt;openparen&gt;text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;rows&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;openbracket&gt;&lt;space&gt;&lt;backslash&gt;t&lt;closebracket&gt;+&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;&lt;backslash&gt;t&lt;quote&gt;&lt;comma&gt;&lt;space&gt;text&lt;closeparen&gt;.splitlines&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Replace&lt;space&gt;repeated&lt;space&gt;delimiter&lt;space&gt;characters&lt;space&gt;by&lt;space&gt;a&lt;space&gt;single&lt;space&gt;tab&lt;space&gt;to&lt;space&gt;simplify&lt;space&gt;extraction.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;&lt;openbracket&gt;row&lt;space&gt;for&lt;space&gt;row&lt;space&gt;in&lt;space&gt;csv.DictReader&lt;openparen&gt;rows&lt;comma&gt;&lt;space&gt;&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;type&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;ordinality&lt;apos&gt;&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;None&lt;comma&gt;&lt;space&gt;None&lt;comma&gt;&lt;space&gt;&lt;apos&gt;excel-tab&lt;apos&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Logging&lt;space&gt;Support&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FMELogFormatter&lt;openparen&gt;logging.Formatter&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;arg&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;super&lt;openparen&gt;FMELogFormatter&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.arg&lt;space&gt;=&lt;space&gt;arg&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FMELogHandler&lt;openparen&gt;logging.Handler&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;emit&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;record&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Emit&lt;space&gt;a&lt;space&gt;log&lt;space&gt;record.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger&lt;space&gt;=&lt;space&gt;fmeobjects.FMELogFile&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger.logMessageString&lt;openparen&gt;record.getMessage&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;getFMELogger&lt;openparen&gt;name&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Get&lt;space&gt;an&lt;space&gt;FME&lt;space&gt;logger.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger&lt;space&gt;=&lt;space&gt;logging.getLogger&lt;openparen&gt;name&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;formatter&lt;space&gt;=&lt;space&gt;logging.Formatter&lt;openparen&gt;&lt;quote&gt;%&lt;openparen&gt;asctime&lt;closeparen&gt;s&lt;space&gt;%&lt;openparen&gt;levelname&lt;closeparen&gt;s:&lt;space&gt;%&lt;openparen&gt;message&lt;closeparen&gt;s&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;handler&lt;space&gt;=&lt;space&gt;FMELogHandler&lt;openparen&gt;level=&lt;quote&gt;INFO&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;handler.setFormatter&lt;openparen&gt;formatter&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger.addHandler&lt;openparen&gt;handler&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;logger&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Exception&lt;solidus&gt;Error&lt;space&gt;Classes&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;MGSError&lt;openparen&gt;Exception&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;class&lt;space&gt;for&lt;space&gt;exceptions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;message&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;super&lt;openparen&gt;MGSError&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;message&lt;closeparen&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;type&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Error&lt;space&gt;type&lt;space&gt;string.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;Error&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;instructions&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Post-message&lt;space&gt;instructions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;MGSSystemError&lt;openparen&gt;MGSError&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;message&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;super&lt;openparen&gt;MGSSystemError&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;message&lt;closeparen&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;type&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Error&lt;space&gt;type&lt;space&gt;string.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;instructions&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Post-message&lt;space&gt;instructions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;FME&lt;space&gt;Template&lt;space&gt;Class&lt;space&gt;Interface&lt;lf&gt;&lt;lf&gt;TEMP&lt;space&gt;=&lt;space&gt;&lt;apos&gt;FME_SHAREDRESOURCE_TEMP&lt;apos&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.temp_directory&lt;space&gt;=&lt;space&gt;FME_MacroValues&lt;openbracket&gt;TEMP&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.temp_directory&lt;space&gt;=&lt;space&gt;os.path.join&lt;openparen&gt;&lt;apos&gt;Resources&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;Temp&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Load&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;into&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;sqlite_sort_record_number&lt;apos&gt;&lt;closeparen&gt;&lt;space&gt;==&lt;space&gt;1:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;temporary&lt;space&gt;SQLite&lt;space&gt;database&lt;space&gt;and&lt;space&gt;feature&lt;space&gt;table.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db&lt;space&gt;=&lt;space&gt;None&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;keys&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;sqlite_sort_keys&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Configure&lt;space&gt;database&lt;space&gt;file&lt;space&gt;path&lt;space&gt;and&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;name.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db_path&lt;space&gt;=&lt;space&gt;random_path&lt;openparen&gt;directory=self.temp_directory&lt;comma&gt;&lt;space&gt;prefix=&lt;apos&gt;SQLiteSorter_&lt;apos&gt;&lt;comma&gt;&lt;space&gt;suffix=&lt;apos&gt;.sqlite&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.table_name&lt;space&gt;=&lt;space&gt;&lt;apos&gt;features&lt;apos&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;SQL&lt;space&gt;DDF&lt;space&gt;key&lt;space&gt;column&lt;space&gt;definitions&lt;space&gt;from&lt;space&gt;the&lt;space&gt;Sort_Keys&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.keys&lt;space&gt;=&lt;space&gt;extract_dict_from_tab_delimited_data&lt;openparen&gt;sanitize_text&lt;openparen&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;lt&gt;apos&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;&lt;apos&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;keys&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;column_defs&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;openparen&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;type&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;temporary&lt;space&gt;database&lt;space&gt;and&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;with&lt;space&gt;a&lt;space&gt;BLOB&lt;space&gt;to&lt;space&gt;contain&lt;space&gt;the&lt;space&gt;serialized&lt;space&gt;feature.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db&lt;space&gt;=&lt;space&gt;sqlite3.connect&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.text_factory&lt;space&gt;=&lt;space&gt;str&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor&lt;space&gt;=&lt;space&gt;self.db.execute&lt;openparen&gt;&lt;quote&gt;create&lt;space&gt;table&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;column_defs&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;feature&lt;space&gt;BLOB&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;create&lt;space&gt;index&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;quote&gt;_index&lt;space&gt;on&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;asc&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;Exception&lt;space&gt;as&lt;space&gt;e:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;open&lt;space&gt;SQLite&lt;space&gt;database&lt;space&gt;&lt;quote&gt;%s&lt;quote&gt;&lt;space&gt;to&lt;space&gt;sort&lt;space&gt;records:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.db_path&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;hasattr&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;&lt;apos&gt;db&lt;apos&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Construct&lt;space&gt;insertion&lt;space&gt;statement&lt;space&gt;elements.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;key_names&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;key_placeholders&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;apos&gt;?&lt;apos&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;all_values&lt;space&gt;=&lt;space&gt;&lt;openbracket&gt;self.get_feature_attribute&lt;openparen&gt;feature&lt;comma&gt;&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;openbracket&gt;buffer&lt;openparen&gt;self.serialize_feature&lt;openparen&gt;feature&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Insert&lt;space&gt;the&lt;space&gt;feature&lt;space&gt;record&lt;space&gt;into&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;insert&lt;space&gt;into&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key_names&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;&lt;space&gt;values&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key_placeholders&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;?&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;all_values&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;store&lt;space&gt;records&lt;space&gt;in&lt;space&gt;SQLite&lt;space&gt;for&lt;space&gt;sorting:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Read&lt;space&gt;all&lt;space&gt;stored&lt;space&gt;features&lt;space&gt;from&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;in&lt;space&gt;the&lt;space&gt;requested&lt;space&gt;order.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;hasattr&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;&lt;apos&gt;db&lt;apos&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.commit&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Construct&lt;space&gt;the&lt;space&gt;ORDER&lt;space&gt;BY&lt;space&gt;clause.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;sort_defs&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;openparen&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;ordinality&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Execute&lt;space&gt;the&lt;space&gt;query&lt;space&gt;and&lt;space&gt;output&lt;space&gt;the&lt;space&gt;features&lt;space&gt;in&lt;space&gt;sorted&lt;space&gt;order&lt;comma&gt;&lt;space&gt;reconstructing&lt;space&gt;them&lt;space&gt;from&lt;space&gt;the&lt;space&gt;serialized&lt;space&gt;copy&lt;space&gt;in&lt;space&gt;the&lt;space&gt;temporary&lt;space&gt;table.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;feature_record&lt;space&gt;in&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;select&lt;space&gt;feature&lt;space&gt;from&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;order&lt;space&gt;by&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;sort_defs&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.output_feature_from_blob&lt;openparen&gt;feature_record&lt;openbracket&gt;0&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;sort&lt;space&gt;records&lt;space&gt;via&lt;space&gt;SQLite:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Don&lt;apos&gt;t&lt;space&gt;leave&lt;space&gt;temporary&lt;space&gt;resource&lt;space&gt;files&lt;space&gt;behind.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;output_feature_from_blob&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;blob&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature&lt;space&gt;=&lt;space&gt;self.deserialize_feature&lt;openparen&gt;blob&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.output_feature&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;deserialize_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;blob&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.deserialize&lt;openparen&gt;bytearray&lt;openparen&gt;blob&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;output_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;get_feature_attribute&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;comma&gt;&lt;space&gt;feature_name&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature.getAttribute&lt;openparen&gt;feature_name&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;serialize_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature.serialize&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="SQLiteSortPythonCaller"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="8"
#!   TYPE="Counter"
#!   VERSION="2"
#!   POSITION="150 0"
#!   BOUNDING_RECT="150 0 -1 -1"
#!   ORDER="500000000000001"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="fme_rejection_code" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="CNT_ATTR" PARM_VALUE="sqlite_sort_record_number"/>
#!     <XFORM_PARM PARM_NAME="DOMAIN" PARM_VALUE="sqlite_sort_counter"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SCOPE" PARM_VALUE="Local"/>
#!     <XFORM_PARM PARM_NAME="START" PARM_VALUE="1"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Counter"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="11"
#!   TYPE="ParameterFetcher"
#!   VERSION="4"
#!   POSITION="1803.0000300002998 303.00303003030029"
#!   BOUNDING_RECT="1803.0000300002998 303.00303003030029 -1 -1"
#!   ORDER="500000000000002"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_keys" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ATTR_LIST" PARM_VALUE="sqlite_sort_keys $(Sort_Keys)"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ParameterFetcher"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="14"
#!   TYPE="Sampler"
#!   VERSION="4"
#!   POSITION="906.009060090601 -3.0000300002999438"
#!   BOUNDING_RECT="906.009060090601 -3.0000300002999438 -1 -1"
#!   ORDER="500000000000003"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="SAMPLED"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="NOT_SAMPLED"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="RATE" PARM_VALUE="1"/>
#!     <XFORM_PARM PARM_NAME="SAMPLE_MODE" PARM_VALUE="No"/>
#!     <XFORM_PARM PARM_NAME="SAMPLE_TYPE_LONG" PARM_VALUE="First N Features"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Sampler"/>
#! </TRANSFORMER>
#! </TRANSFORMERS>
#! <SUBDOCUMENT_IOS>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="2"
#!   NAME="Input"
#!   POSITION="-600 0"
#!   BOUNDING_RECT="-600 0 -1 -1"
#!   COLLAPSED="true"
#!   PUBLISHED="true"
#!   IS_SOURCE="true"
#!   ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="3"
#!   NAME="Sorted"
#!   POSITION="3302.9985299853006 3.0000300003000007"
#!   BOUNDING_RECT="3302.9985299853006 3.0000300003000007 -1 -1"
#!   COLLAPSED="true"
#!   IS_SOURCE="false"
#!   ATTR_MODE="1"
#! >
#! </SUBDOCUMENT_IO>
#! </SUBDOCUMENT_IOS>
#! <FEAT_LINKS>
#! <FEAT_LINK
#!   IDENTIFIER="21"
#!   SOURCE_NODE="2"
#!   TARGET_NODE="8"
#!   SOURCE_PORT_DESC="0"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="6"
#!   SOURCE_NODE="4"
#!   TARGET_NODE="3"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="0"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="15"
#!   SOURCE_NODE="8"
#!   TARGET_NODE="14"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="13"
#!   SOURCE_NODE="11"
#!   TARGET_NODE="4"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="16"
#!   SOURCE_NODE="14"
#!   TARGET_NODE="11"
#!   SOURCE_PORT_DESC="fo 0 SAMPLED"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="17"
#!   SOURCE_NODE="14"
#!   TARGET_NODE="4"
#!   SOURCE_PORT_DESC="fo 1 NOT_SAMPLED"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! </FEAT_LINKS>
#! <BREAKPOINTS>
#! </BREAKPOINTS>
#! <ATTR_LINKS>
#! </ATTR_LINKS>
#! <SUBDOCUMENTS>
#! </SUBDOCUMENTS>
#! <LOOKUP_TABLES>
#! </LOOKUP_TABLES>
#! </TRANSFORMER>

FME_PYTHON_VERSION 2or3
DEFAULT_MACRO $(SQLiteSorter_WORKSPACE_NAME)_Sort_Keys 
#! START_HEADER
#! END_HEADER

DEFAULT_MACRO WB_CURRENT_CONTEXT
DEFAULT_MACRO SQLiteSorter_WORKSPACE_NAME ""
INCLUDE [puts {MACRO WB_OLD_CONTEXT_$(SQLiteSorter_WORKSPACE_NAME) $(WB_CURRENT_CONTEXT)};          puts {MACRO WB_CURRENT_CONTEXT $(SQLiteSorter_WORKSPACE_NAME)}]
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Input1563820834 Input Splitter"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"   OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"
# -------------------------------------------------------------------------
# Create the DomainName that this transformer will use.
# Because @Count itself will evalute the expression to calculate the
# domain, we don't need to do anything in Tcl per feature going by
INCLUDE [    set domainPrefix {};    if { {Local} == {Local} }    {       set domainPrefix [FME_EncodeText {$(SQLiteSorter_WORKSPACE_NAME)_Counter_}];    };    puts "MACRO $(SQLiteSorter_WORKSPACE_NAME)_Counter_FULL_DOMAIN ${domainPrefix}sqlite_sort_counter"; ]
FACTORY_DEF * ExecuteFunctionFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Counter_Rejector    COMMAND_PARM_EVALUATION SINGLE_PASS    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"    FUNCTION_DEFINITION @Count(REJECTABLE_WITH_FLAG,fme_encoded,$($(SQLiteSorter_WORKSPACE_NAME)_Counter_FULL_DOMAIN),"1")    RESULT_ATTRIBUTE "sqlite_sort_record_number"    OUTPUT COMPLETE FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_OUTPUT"    OUTPUT REJECTED FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_<REJECTED>"
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Counter <REJECTED> Transformer Output Nuker"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_<REJECTED>"
# -------------------------------------------------------------------------
# If we're doing LAST N features, then the multiplier comes in as 0.
# If we're doing First N, multiplier is -1.
# For RANDOM, we need to treat LAST N as if it was first N (i.e. have a -1)
# That is what the ? : does in the rate multiplier.
INCLUDE [ if { {-1} == {0} && {ORIGINAL} == {ORIGINAL} } {              puts "MACRO REAL_MODE LAST"; 	         puts "MACRO REAL_RATE 1"; 	      } else {              puts "MACRO REAL_MODE ORIGINAL";              puts "MACRO REAL_RATE [expr 1 * ( -1 ? -1 : -1 ) ]"; 	      } ]
FACTORY_DEF {*} SamplingFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Sampler    COMMAND_PARM_EVALUATION SINGLE_PASS    SAMPLE_RATE $(REAL_RATE)    SAMPLE_ORDER $(REAL_MODE)    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_OUTPUT"    OUTPUT SAMPLED FEATURE_TYPE ___SAMPLED___    OUTPUT NOT_SAMPLED FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_NOT_SAMPLED"
# This TeeFactory is needed because Sampler will still output features if it has no OUTPUT clauses specified.
# This way we behave nicely even if there are no output connections on the transformer. See PR#28886.
FACTORY_DEF * TeeFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Sampler_Sampled    INPUT FEATURE_TYPE ___SAMPLED___    OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_SAMPLED"
# -------------------------------------------------------------------------
Tcl2 proc $(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_doFetch {} {    foreach {name val} {"sqlite_sort_keys {$($(SQLiteSorter_WORKSPACE_NAME)_Sort_Keys)}"} {         if { [string match {*<at>*} $val] == 1 } {             set val [FME_Execute EvaluateExpression {STRING} $val {$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher}];         } elseif {[string match {*FME_CONDITIONAL*} $val] == 1} {             set val [FME_Execute EvaluateExpression {STRING} $val {$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher}];         } else {             set val [FME_DecodeTextOrAttr $val];         };       FME_SetAttribute [FME_DecodeText $name] $val    } }
FACTORY_DEF * TeeFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_SAMPLED"    OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_OUTPUT"         @Tcl2($(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_doFetch)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF * PythonFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_OUTPUT"    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_NOT_SAMPLED"    SYMBOL_NAME FeatureProcessor    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE import<space>fmeobjects<lf><lf>import<space>os<lf>import<space>os.path<lf>import<space>re<lf>import<space>csv<lf>import<space>sys<lf>if<space>sys.version_info<space><gt><space><openparen>3<comma><closeparen>:<lf><space><space><space><space>buffer<space>=<space>memoryview<lf>import<space>random<lf>import<space>string<lf>import<space>traceback<lf>import<space>inspect<lf><lf>import<space>sqlite3<lf>import<space>logging<lf><lf><lf><lf>#<space>Random<space>String<space>Generators<lf><lf>def<space>random_string<openparen>size=24<comma><space>characters=string.ascii_lowercase<space>+<space>string.digits<closeparen>:<lf><space><space><space><space>return<space><apos><apos>.join<openparen>random.choice<openparen>characters<closeparen><space>for<space>x<space>in<space>range<openparen>size<closeparen><closeparen><lf><lf><lf>def<space>random_path<openparen>directory<comma><space>prefix=<quote><quote><comma><space>size=24<comma><space>characters=string.ascii_lowercase<space>+<space>string.digits<comma><space>suffix=<quote><quote><closeparen>:<lf><space><space><space><space>while<space>True:<lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>path<space>=<space>os.path.join<openparen>directory<comma><space>prefix<space>+<space>random_string<openparen>size<comma><space>characters<closeparen><space>+<space>suffix<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>fd<space>=<space>os.open<openparen>path<comma><space>os.O_RDONLY<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>os.close<openparen>fd<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>continue<lf><space><space><space><space><space><space><space><space>except<space>OSError:<lf><space><space><space><space><space><space><space><space><space><space><space><space>break<lf><space><space><space><space>return<space>path<lf><lf><lf><lf>#<space>Text<space>Interpretation<lf><lf>FME_TAG_CODE_TRANSLATIONS<space>=<space><opencurly><apos>lf<apos>:<space><space><space><space><space><space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>div.*?<apos>:<space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>br.*?<apos>:<space><space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>p.*?<apos>:<space><space><space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>cr<apos>:<space><space><space><space><space><space><space><space><space><space><space><apos><backslash>r<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>space<apos>:<space><space><space><space><space><space><space><space><apos><space><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>tab<apos>:<space><space><space><space><space><space><space><space><space><space><apos><backslash>t<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>comma<apos>:<space><space><space><space><space><space><space><space><apos><comma><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>solidus<apos>:<space><space><space><space><space><space><apos><solidus><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>apos<apos>:<space><space><space><space><space><space><space><space><space><apos><comma><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>openparen<apos>:<space><space><space><space><apos><openparen><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closeparen<apos>:<space><space><space><apos><closeparen><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>openbracket<apos>:<space><space><apos><openbracket><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closebracket<apos>:<space><apos><closebracket><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>opencurly<apos>:<space><space><space><space><apos><opencurly><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closecurly<apos>:<space><space><space><apos><closecurly><apos><closecurly><lf><lf>def<space>interpret_fme_character_tags<openparen>raw_text<closeparen>:<lf><space><space><space><space>result<space>=<space>raw_text<lf><space><space><space><space>for<space>fme_tag_code<space>in<space>FME_TAG_CODE_TRANSLATIONS.keys<openparen><closeparen>:<lf><space><space><space><space><space><space><space><space>result<space>=<space>re.sub<openparen><apos><lt><apos><space>+<space>fme_tag_code<space>+<space><apos><gt><apos><comma><space>FME_TAG_CODE_TRANSLATIONS<openbracket>fme_tag_code<closebracket><comma><space>result<closeparen><lf><space><space><space><space>return<space>result<lf><lf>def<space>sanitize_text<openparen>raw_text<closeparen>:<lf><space><space><space><space><quote><quote><quote>Replace<space>FME<space>tags<comma><space>HTML<space>tags<space>or<space>SQL<space>meta-characters<space>with<space>clean<space>and<space>safe<space>equivalents.<quote><quote><quote><lf><space><space><space><space>result<space>=<space>interpret_fme_character_tags<openparen>raw_text<closeparen><lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<quote><apos><openbracket><closeparen><backslash><quote><semicolon>!=<closebracket><quote><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space>#<space>Sanitize<space>SQL<space>metacharacters.<lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<apos><lt>.+?<gt><apos><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space><space><space><space><space>#<space>Sanitize<space>all<space>HTML<space>tags.<lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<apos>^<gt><openbracket><backslash>t<space><closebracket>*<apos><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space><space>#<space>Sanitize<space>email<space>quoting<space>prefixes.<lf><space><space><space><space>return<space>result<lf><lf>def<space>extract_dict_from_tab_delimited_data<openparen>text<closeparen>:<lf><space><space><space><space>rows<space>=<space>re.sub<openparen>r<apos><openbracket><space><backslash>t<closebracket>+<apos><comma><space><quote><backslash>t<quote><comma><space>text<closeparen>.splitlines<openparen><closeparen><space><space>#<space>Replace<space>repeated<space>delimiter<space>characters<space>by<space>a<space>single<space>tab<space>to<space>simplify<space>extraction.<lf><space><space><space><space>return<space><openbracket>row<space>for<space>row<space>in<space>csv.DictReader<openparen>rows<comma><space><openbracket><apos>name<apos><comma><space><apos>type<apos><comma><space><apos>ordinality<apos><closebracket><comma><space>None<comma><space>None<comma><space><apos>excel-tab<apos><closeparen><closebracket><lf><lf><lf><lf>#<space>Logging<space>Support<lf><lf>class<space>FMELogFormatter<openparen>logging.Formatter<closeparen>:<lf><space><space><space><space>def<space>__init__<openparen>self<comma><space>arg<closeparen>:<lf><space><space><space><space><space><space><space><space>super<openparen>FMELogFormatter<comma><space>self<closeparen>.__init__<openparen><closeparen><lf><space><space><space><space><space><space><space><space>self.arg<space>=<space>arg<lf><lf><lf>class<space>FMELogHandler<openparen>logging.Handler<closeparen>:<lf><space><space><space><space>def<space>emit<openparen>self<comma><space>record<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Emit<space>a<space>log<space>record.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>logger<space>=<space>fmeobjects.FMELogFile<openparen><closeparen><lf><space><space><space><space><space><space><space><space>logger.logMessageString<openparen>record.getMessage<openparen><closeparen><closeparen><lf><lf>def<space>getFMELogger<openparen>name<closeparen>:<lf><space><space><space><space><quote><quote><quote>Get<space>an<space>FME<space>logger.<quote><quote><quote><lf><space><space><space><space>logger<space>=<space>logging.getLogger<openparen>name<closeparen><lf><space><space><space><space>formatter<space>=<space>logging.Formatter<openparen><quote>%<openparen>asctime<closeparen>s<space>%<openparen>levelname<closeparen>s:<space>%<openparen>message<closeparen>s<quote><closeparen><lf><space><space><space><space>handler<space>=<space>FMELogHandler<openparen>level=<quote>INFO<quote><closeparen><lf><space><space><space><space>handler.setFormatter<openparen>formatter<closeparen><lf><space><space><space><space>logger.addHandler<openparen>handler<closeparen><lf><space><space><space><space>return<space>logger<lf><lf><lf><lf>#<space>Exception<solidus>Error<space>Classes<lf><lf>class<space>MGSError<openparen>Exception<closeparen>:<lf><tab><quote><quote><quote>Base<space>class<space>for<space>exceptions.<quote><quote><quote><lf><tab><lf><tab>def<space>__init__<openparen>self<comma><space>message<closeparen>:<lf><tab><tab>super<openparen>MGSError<comma><space>self<closeparen>.__init__<openparen>message<closeparen><lf><tab><lf><tab>def<space>type<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Error<space>type<space>string.<quote><quote><quote><lf><tab><tab>return<space><quote>Error<quote><lf><tab><lf><tab>def<space>instructions<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Post-message<space>instructions.<quote><quote><quote><lf><tab><tab>return<space><quote><quote><quote>Please<space>try<space>again.<quote><quote><quote><lf><lf>class<space>MGSSystemError<openparen>MGSError<closeparen>:<lf><tab><lf><tab>def<space>__init__<openparen>self<comma><space>message<closeparen>:<lf><tab><tab>super<openparen>MGSSystemError<comma><space>self<closeparen>.__init__<openparen>message<closeparen><lf><tab><lf><tab>def<space>type<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Error<space>type<space>string.<quote><quote><quote><lf><tab><tab>return<space><quote>Unexpected<space>System<space>Error<quote><lf><tab><lf><tab>def<space>instructions<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Post-message<space>instructions.<quote><quote><quote><lf><tab><tab>return<space><quote><quote><quote>Please<space>try<space>again.<quote><quote><quote><lf><lf><lf><lf>#<space>FME<space>Template<space>Class<space>Interface<lf><lf>TEMP<space>=<space><apos>FME_SHAREDRESOURCE_TEMP<apos><lf><lf>class<space>FeatureProcessor:<lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.temp_directory<space>=<space>FME_MacroValues<openbracket>TEMP<closebracket><lf><space><space><space><space><space><space><space><space>except:<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.temp_directory<space>=<space>os.path.join<openparen><apos>Resources<apos><comma><space><apos>Temp<apos><closeparen><lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Load<space>a<space>feature<space>into<space>the<space>sort<space>table.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>feature.getAttribute<openparen><apos>sqlite_sort_record_number<apos><closeparen><space>==<space>1:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>temporary<space>SQLite<space>database<space>and<space>feature<space>table.<quote><quote><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db<space>=<space>None<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>keys<space>=<space>feature.getAttribute<openparen><apos>sqlite_sort_keys<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Configure<space>database<space>file<space>path<space>and<space>sort<space>table<space>name.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db_path<space>=<space>random_path<openparen>directory=self.temp_directory<comma><space>prefix=<apos>SQLiteSorter_<apos><comma><space>suffix=<apos>.sqlite<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.table_name<space>=<space><apos>features<apos><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>SQL<space>DDF<space>key<space>column<space>definitions<space>from<space>the<space>Sort_Keys<space>parameter.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.keys<space>=<space>extract_dict_from_tab_delimited_data<openparen>sanitize_text<openparen>re.sub<openparen>r<apos><lt>apos<gt><apos><comma><space><quote><apos><quote><comma><space>keys<closeparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>column_defs<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><openparen>key<openbracket><apos>name<apos><closebracket><space>+<space><apos><space><apos><space>+<space>key<openbracket><apos>type<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>temporary<space>database<space>and<space>sort<space>table<space>with<space>a<space>BLOB<space>to<space>contain<space>the<space>serialized<space>feature.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db<space>=<space>sqlite3.connect<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.text_factory<space>=<space>str<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor<space>=<space>self.db.execute<openparen><quote>create<space>table<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>column_defs<space>+<space><quote><comma><space>feature<space>BLOB<closeparen><semicolon><quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>for<space>key<space>in<space>self.keys:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.execute<openparen><quote>create<space>index<space><quote><space>+<space>key<openbracket><apos>name<apos><closebracket><space>+<space><quote>_index<space>on<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>key<openbracket><apos>name<apos><closebracket><space>+<space><quote><space>asc<closeparen><semicolon><quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>except<space>Exception<space>as<space>e:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>open<space>SQLite<space>database<space><quote>%s<quote><space>to<space>sort<space>records:<space>%s<backslash>n%s<apos><comma><space>self.db_path<comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>if<space>hasattr<openparen>self<comma><space><apos>db<apos><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Construct<space>insertion<space>statement<space>elements.<lf><space><space><space><space><space><space><space><space><space><space><space><space>key_names<space>=<space><apos><comma><space><apos>.join<openparen><openbracket>key<openbracket><apos>name<apos><closebracket><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>key_placeholders<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><apos>?<apos><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>all_values<space>=<space><openbracket>self.get_feature_attribute<openparen>feature<comma><space>key<openbracket><apos>name<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><space>+<space><openbracket>buffer<openparen>self.serialize_feature<openparen>feature<closeparen><closeparen><closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Insert<space>the<space>feature<space>record<space>into<space>the<space>sort<space>table.<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.execute<openparen><quote>insert<space>into<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>key_names<space>+<space><quote><comma><space>feature<closeparen><space>values<space><openparen><quote><space>+<space>key_placeholders<space>+<space><quote><comma><space>?<closeparen><semicolon><quote><comma><space>all_values<closeparen><lf><space><space><space><space><space><space><space><space>except:<lf><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>store<space>records<space>in<space>SQLite<space>for<space>sorting:<space>%s<backslash>n%s<apos><comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Read<space>all<space>stored<space>features<space>from<space>the<space>sort<space>table<space>in<space>the<space>requested<space>order.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>hasattr<openparen>self<comma><space><apos>db<apos><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.commit<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Construct<space>the<space>ORDER<space>BY<space>clause.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>sort_defs<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><openparen>key<openbracket><apos>name<apos><closebracket><space>+<space><apos><space><apos><space>+<space>key<openbracket><apos>ordinality<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Execute<space>the<space>query<space>and<space>output<space>the<space>features<space>in<space>sorted<space>order<comma><space>reconstructing<space>them<space>from<space>the<space>serialized<space>copy<space>in<space>the<space>temporary<space>table.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>for<space>feature_record<space>in<space>self.cursor.execute<openparen><quote>select<space>feature<space>from<space><quote><space>+<space>self.table_name<space>+<space><quote><space>order<space>by<space><quote><space>+<space>sort_defs<space>+<space><quote><semicolon><quote><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.output_feature_from_blob<openparen>feature_record<openbracket>0<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>except:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>sort<space>records<space>via<space>SQLite:<space>%s<backslash>n%s<apos><comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Don<apos>t<space>leave<space>temporary<space>resource<space>files<space>behind.<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><lf><space><space><space><space>def<space>output_feature_from_blob<openparen>self<comma><space>blob<closeparen>:<lf><space><space><space><space><space><space><space><space>feature<space>=<space>self.deserialize_feature<openparen>blob<closeparen><lf><space><space><space><space><space><space><space><space>self.output_feature<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>deserialize_feature<openparen>self<comma><space>blob<closeparen>:<lf><space><space><space><space><space><space><space><space>feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space>feature.deserialize<openparen>bytearray<openparen>blob<closeparen><closeparen><lf><space><space><space><space><space><space><space><space>return<space>feature<lf><lf><space><space><space><space>def<space>output_feature<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>get_feature_attribute<openparen>self<comma><space>feature<comma><space>feature_name<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space>feature.getAttribute<openparen>feature_name<closeparen><lf><lf><space><space><space><space>def<space>serialize_feature<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space>feature.serialize<openparen><closeparen><lf>    OUTPUT PYOUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller_OUTPUT"
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Sorted1563820834 Output Collector"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller_OUTPUT"   OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sorted" @RemoveAttributes(sqlite_sort_record_number,sqlite_sort_keys)
INCLUDE [puts {MACRO WB_CURRENT_CONTEXT $(WB_OLD_CONTEXT_$(SQLiteSorter_WORKSPACE_NAME))}]
#! <?xml version="1.0" encoding="UTF-8" ?>
#! <TRANSFORMER
# TRANSFORMER_BEGIN SQLiteSorter,9,Workflows,cf323c20-8ce3-4978-89bd-6bb0aac0adf7,"Linked by Default",No,NO_PARALLELISM,,No,18592,YES,No,2or3
# <p>An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.</p>
# <p>For issues or questions, please Create an issue <a href="https://github.com/modgeosys/fme-components/issues_">here</a>.  For the source, including test driver components, please see the <a href="https://github.com/modgeosys/fme-components_">Github repository</a>.</p>
# <p>Copyright &copy; 2017-2019 by Modern geoSystems, released under <a href="https://github.com/modgeosys/fme-components/raw/master/LICENSE">this BSD 3-clause license</a>.</p>
# TRANSFORMER_END
#!   ATTR_TYPE_ENCODING="SDF"
#!   BLOCKED_LOOPING="No"
#!   CATEGORY="Workflows"
#!   DESCRIPTION="&lt;p&gt;An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.&lt;/p&gt;&#10;&lt;p&gt;For issues or questions, please Create an issue &lt;a href=&quot;https://github.com/modgeosys/fme-components/issues_&quot;&gt;here&lt;/a&gt;.  For the source, including test driver components, please see the &lt;a href=&quot;https://github.com/modgeosys/fme-components_&quot;&gt;Github repository&lt;/a&gt;.&lt;/p&gt;&#10;&lt;p&gt;Copyright &amp;copy; 2017-2019 by Modern geoSystems, released under &lt;a href=&quot;https://github.com/modgeosys/fme-components/raw/master/LICENSE&quot;&gt;this BSD 3-clause license&lt;/a&gt;.&lt;/p&gt;"
#!   DOC_EXTENTS="3903 371.003"
#!   DOC_TOP_LEFT="-600 -68"
#!   EXPLICIT_BOOKMARK_ORDER="false"
#!   FME_BUILD_NUM="18592"
#!   FME_DOCUMENT_GUID="cf323c20-8ce3-4978-89bd-6bb0aac0adf7"
#!   FME_DOCUMENT_PRIORGUID="2ecbc276-298c-480c-8962-0b3a599d0b48"
#!   FME_LINKED_TRANSFORMER_VERSION="9"
#!   FME_PROCESS_COUNT="NO_PARALLELISM"
#!   FME_PROCESS_GROUPS_ORDERED="No"
#!   FME_PROCESS_GROUP_BY=""
#!   FME_SERVER_SERVICES=""
#!   FMX_ATTRIBUTE_PROPOGATION_MODE="AUTO"
#!   FMX_INSERT_MODE="Linked by Default"
#!   HISTORY="2017-11-26,Kevin&lt;space&gt;Weller,Initial&lt;space&gt;publication&lt;semicolon&gt;&lt;space&gt;test&lt;space&gt;workspace&lt;space&gt;fails&lt;space&gt;due&lt;space&gt;to&lt;space&gt;FME&lt;space&gt;Hub&lt;space&gt;version&lt;space&gt;delay.,2017-11-30,Kevin&lt;space&gt;Weller,Enhance&lt;space&gt;stack&lt;space&gt;trace&lt;space&gt;reporting&lt;semicolon&gt;&lt;space&gt;use&lt;space&gt;truncated&lt;space&gt;test&lt;space&gt;data&lt;space&gt;and&lt;space&gt;universal&lt;space&gt;temp&lt;space&gt;directory.,2018-01-20,Kevin&lt;space&gt;Weller,Fix&lt;space&gt;absolute&lt;space&gt;parameter&lt;space&gt;name&lt;space&gt;references&lt;space&gt;from&lt;space&gt;PythonCaller&lt;space&gt;when&lt;space&gt;SQLiteServer&lt;space&gt;is&lt;space&gt;called&lt;space&gt;from&lt;space&gt;another&lt;space&gt;custom&lt;space&gt;transformer&lt;space&gt;rather&lt;space&gt;than&lt;space&gt;from&lt;space&gt;the&lt;space&gt;top-level&lt;space&gt;workspace.,2018-03-08,Kevin&lt;space&gt;Weller,Update&lt;space&gt;documentation&lt;space&gt;to&lt;space&gt;reflect&lt;space&gt;move&lt;space&gt;from&lt;space&gt;GitHub&lt;space&gt;to&lt;space&gt;Assembla&lt;space&gt;and&lt;space&gt;Atlassian.,2018-03-18,Kevin&lt;space&gt;Weller,Fix&lt;space&gt;Python&lt;space&gt;syntax&lt;space&gt;error&lt;semicolon&gt;&lt;space&gt;test&lt;space&gt;driver&lt;space&gt;failed&lt;space&gt;to&lt;space&gt;test&lt;space&gt;latest&lt;space&gt;version&lt;comma&gt;&lt;space&gt;so&lt;space&gt;it&lt;space&gt;looked&lt;space&gt;like&lt;space&gt;it&lt;space&gt;worked&lt;space&gt;10&lt;space&gt;days&lt;space&gt;ago&lt;comma&gt;&lt;space&gt;but&lt;space&gt;it&lt;space&gt;didn&lt;apos&gt;t.&lt;space&gt;&lt;amp&gt;*^*&lt;openparen&gt;^&lt;amp&gt;^&lt;openparen&gt;&lt;amp&gt;*!,2018-07-02,Kevin&lt;space&gt;Weller,Enhance&lt;space&gt;parameter&lt;space&gt;handling&lt;space&gt;to&lt;space&gt;allow&lt;space&gt;for&lt;space&gt;multiple&lt;space&gt;references&lt;space&gt;to&lt;space&gt;the&lt;space&gt;transformer&lt;space&gt;from&lt;space&gt;the&lt;space&gt;same&lt;space&gt;calling&lt;space&gt;workspace&lt;space&gt;or&lt;space&gt;transformer.,2018-07-27,Kevin&lt;space&gt;Weller,Don&lt;apos&gt;t&lt;space&gt;expose&lt;space&gt;working&lt;space&gt;attributes&lt;space&gt;on&lt;space&gt;output&lt;space&gt;port.,2019-05-09,Kevin&lt;space&gt;Weller,Update&lt;space&gt;to&lt;space&gt;FME&lt;space&gt;2018.1.2.1&lt;space&gt;and&lt;space&gt;use&lt;space&gt;new&lt;space&gt;AttributeValidation*&lt;space&gt;framework&lt;space&gt;in&lt;space&gt;test&lt;space&gt;driver."
#!   ITERATION_COUNT_ATTR=""
#!   LAST_SAVE_BUILD="FME(R) 2018.1.2.1 (20190319 - Build 18592 - linux-x64)"
#!   LAST_SAVE_DATE="2019-05-09T16:28:11"
#!   MARKDOWN_DESCRIPTION="An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.&#10;&#10;For issues or questions, please Create an issue [here](https://github.com/modgeosys/fme-components/issues_).  For the source, including test driver components, please see the [Github repository](https://github.com/modgeosys/fme-components_).&#10;&#10;Copyright &amp;copy; 2017-2019 by Modern geoSystems, released under [this BSD 3-clause license](https://github.com/modgeosys/fme-components/raw/master/LICENSE)."
#!   MARKDOWN_USAGE="### Ports&#10;&#10;#### Input&#10;Feed the features to be sorted here.  If the input features consist of a variety of different feature types, it would be wise to ensure the sort key fields are represented in all of them.&#10;&#10;#### Output&#10;The sorted features emerge here.&#10;&#10;### Parameters&#10;&#10;#### Sort_Keys&#10;A tab- or space-delimited table of the sort keys to be applied.  The first column contains the names of the fields to be sorted, in order of sort priority.  The second column contains the database field data type.  The third and last column specifies whether the field is to be sorted in `asc`ending or `desc`ending order, e.g.:  &#10;  &#10;   `kml_name&#9;varchar asc`&#10;&#10;   `kml_id  varchar desc`  &#10;"
#!   MAX_LOOP_ITERATIONS=""
#!   PASSWORD=""
#!   PYTHON_COMPATIBILITY="2or3"
#!   SHOW_ANNOTATIONS="true"
#!   SHOW_INFO_NODES="true"
#!   TITLE="SQLiteSorter"
#!   USAGE="&lt;h3&gt;Ports&lt;/h3&gt;&#10;&lt;h4&gt;Input&lt;/h4&gt;&#10;&lt;p&gt;Feed the features to be sorted here.  If the input features consist of a variety of different feature types, it would be wise to ensure the sort key fields are represented in all of them.&lt;/p&gt;&#10;&lt;h4&gt;Output&lt;/h4&gt;&#10;&lt;p&gt;The sorted features emerge here.&lt;/p&gt;&#10;&lt;h3&gt;Parameters&lt;/h3&gt;&#10;&lt;h4&gt;Sort_Keys&lt;/h4&gt;&#10;&lt;p&gt;A tab- or space-delimited table of the sort keys to be applied.  The first column contains the names of the fields to be sorted, in order of sort priority.  The second column contains the database field data type.  The third and last column specifies whether the field is to be sorted in &lt;code&gt;asc&lt;/code&gt;ending or &lt;code&gt;desc&lt;/code&gt;ending order, e.g.:  &lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;kml_name    varchar asc&lt;/code&gt;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;kml_id  varchar desc&lt;/code&gt;  &lt;/p&gt;"
#!   USE_MARKDOWN="YES"
#!   VIEW_POSITION="132.001 831.008"
#!   WARN_INVALID_XFORM_PARAM="Yes"
#!   WORKSPACE_VERSION="1"
#!   XFORM_DEPRECATED="No"
#!   ZOOM_SCALE="100"
#! >
#! <DATASETS>
#! </DATASETS>
#! <DATA_TYPES>
#! </DATA_TYPES>
#! <GEOM_TYPES>
#! </GEOM_TYPES>
#! <FEATURE_TYPES>
#! </FEATURE_TYPES>
#! <FMESERVER>
#! </FMESERVER>
#! <GLOBAL_PARAMETERS>
#! <GLOBAL_PARAMETER
#!   GUI_LINE="GUI TEXT_EDIT_OR_ATTR Sort_Keys &quot; &quot; Sort Keys:"
#!   DEFAULT_VALUE=""
#!   IS_STAND_ALONE="true"
#! />
#! </GLOBAL_PARAMETERS>
#! <COMMENTS>
#! <COMMENT
#!   IDENTIFIER="7"
#!   COMMENT_VALUE="&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0//EN&quot; &quot;http://www.w3.org/TR/REC-html40/strict.dtd&quot;&gt;&#10;&lt;html&gt;&lt;head&gt;&lt;meta name=&quot;qrichtext&quot; content=&quot;1&quot; /&gt;&lt;style type=&quot;text/css&quot;&gt;&#10;p, li { white-space: pre-wrap; }&#10;&lt;/style&gt;&lt;/head&gt;&lt;body style=&quot; font-family:&apos;Arial&apos;; font-size:10pt; font-weight:400; font-style:normal;&quot;&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&lt;span style=&quot; font-family:&apos;helvetica neue&apos;; font-size:9pt;&quot;&gt;This is much easier in&lt;/span&gt;&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&lt;span style=&quot; font-family:&apos;helvetica neue&apos;; font-size:9pt;&quot;&gt;Python than with FME&lt;/span&gt;&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;&lt;span style=&quot; font-family:&apos;helvetica neue&apos;; font-size:9pt;&quot;&gt;transformers.&lt;/span&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;"
#!   POSITION="2550 300"
#!   TOP_LEFT="2550 300"
#!   BOTTOM_RIGHT="3048.0826058260582 92.998229982299819"
#!   BOUNDING_RECT="2550 300 498.08260582605823 207.00177001770018"
#!   ORDER="500000000000000"
#!   FOLLOW_ANCHOR="true"
#!   INFO_NODE="false"
#!   COLOUR="1,1,0.78431372549019607,0.19215686274509805"
#!   SIZE_POLICY="8"
#!   ANCHORED_NODE="4"
#! />
#! </COMMENTS>
#! <CONSTANTS>
#! </CONSTANTS>
#! <BOOKMARKS>
#! </BOOKMARKS>
#! <TRANSFORMERS>
#! <TRANSFORMER
#!   IDENTIFIER="4"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="2552.9985299853006 3.0000300003000007"
#!   BOUNDING_RECT="2552.9985299853006 3.0000300003000007 516.04700000000003 71"
#!   ORDER="500000000000000"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_keys" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fmeobjects&lt;lf&gt;&lt;lf&gt;import&lt;space&gt;os&lt;lf&gt;import&lt;space&gt;os.path&lt;lf&gt;import&lt;space&gt;re&lt;lf&gt;import&lt;space&gt;csv&lt;lf&gt;import&lt;space&gt;sys&lt;lf&gt;if&lt;space&gt;sys.version_info&lt;space&gt;&lt;gt&gt;&lt;space&gt;&lt;openparen&gt;3&lt;comma&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;buffer&lt;space&gt;=&lt;space&gt;memoryview&lt;lf&gt;import&lt;space&gt;random&lt;lf&gt;import&lt;space&gt;string&lt;lf&gt;import&lt;space&gt;traceback&lt;lf&gt;import&lt;space&gt;inspect&lt;lf&gt;&lt;lf&gt;import&lt;space&gt;sqlite3&lt;lf&gt;import&lt;space&gt;logging&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Random&lt;space&gt;String&lt;space&gt;Generators&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;random_string&lt;openparen&gt;size=24&lt;comma&gt;&lt;space&gt;characters=string.ascii_lowercase&lt;space&gt;+&lt;space&gt;string.digits&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;random.choice&lt;openparen&gt;characters&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;x&lt;space&gt;in&lt;space&gt;range&lt;openparen&gt;size&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;random_path&lt;openparen&gt;directory&lt;comma&gt;&lt;space&gt;prefix=&lt;quote&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;size=24&lt;comma&gt;&lt;space&gt;characters=string.ascii_lowercase&lt;space&gt;+&lt;space&gt;string.digits&lt;comma&gt;&lt;space&gt;suffix=&lt;quote&gt;&lt;quote&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;while&lt;space&gt;True:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;path&lt;space&gt;=&lt;space&gt;os.path.join&lt;openparen&gt;directory&lt;comma&gt;&lt;space&gt;prefix&lt;space&gt;+&lt;space&gt;random_string&lt;openparen&gt;size&lt;comma&gt;&lt;space&gt;characters&lt;closeparen&gt;&lt;space&gt;+&lt;space&gt;suffix&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;fd&lt;space&gt;=&lt;space&gt;os.open&lt;openparen&gt;path&lt;comma&gt;&lt;space&gt;os.O_RDONLY&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.close&lt;openparen&gt;fd&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;continue&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;OSError:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;break&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;path&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Text&lt;space&gt;Interpretation&lt;lf&gt;&lt;lf&gt;FME_TAG_CODE_TRANSLATIONS&lt;space&gt;=&lt;space&gt;&lt;opencurly&gt;&lt;apos&gt;lf&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;div.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;br.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;p.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;cr&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;r&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;space&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;tab&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;t&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;comma&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;solidus&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;solidus&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;apos&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;openparen&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;openparen&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closeparen&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;closeparen&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;openbracket&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;openbracket&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closebracket&lt;apos&gt;:&lt;space&gt;&lt;apos&gt;&lt;closebracket&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;opencurly&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;opencurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closecurly&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;closecurly&gt;&lt;apos&gt;&lt;closecurly&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;interpret_fme_character_tags&lt;openparen&gt;raw_text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;raw_text&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;fme_tag_code&lt;space&gt;in&lt;space&gt;FME_TAG_CODE_TRANSLATIONS.keys&lt;openparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;&lt;apos&gt;&lt;lt&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;fme_tag_code&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;FME_TAG_CODE_TRANSLATIONS&lt;openbracket&gt;fme_tag_code&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;result&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;result&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;sanitize_text&lt;openparen&gt;raw_text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Replace&lt;space&gt;FME&lt;space&gt;tags&lt;comma&gt;&lt;space&gt;HTML&lt;space&gt;tags&lt;space&gt;or&lt;space&gt;SQL&lt;space&gt;meta-characters&lt;space&gt;with&lt;space&gt;clean&lt;space&gt;and&lt;space&gt;safe&lt;space&gt;equivalents.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;interpret_fme_character_tags&lt;openparen&gt;raw_text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;quote&gt;&lt;apos&gt;&lt;openbracket&gt;&lt;closeparen&gt;&lt;backslash&gt;&lt;quote&gt;&lt;semicolon&gt;!=&lt;closebracket&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;SQL&lt;space&gt;metacharacters.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;lt&gt;.+?&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;all&lt;space&gt;HTML&lt;space&gt;tags.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;^&lt;gt&gt;&lt;openbracket&gt;&lt;backslash&gt;t&lt;space&gt;&lt;closebracket&gt;*&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;email&lt;space&gt;quoting&lt;space&gt;prefixes.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;result&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;extract_dict_from_tab_delimited_data&lt;openparen&gt;text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;rows&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;openbracket&gt;&lt;space&gt;&lt;backslash&gt;t&lt;closebracket&gt;+&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;&lt;backslash&gt;t&lt;quote&gt;&lt;comma&gt;&lt;space&gt;text&lt;closeparen&gt;.splitlines&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Replace&lt;space&gt;repeated&lt;space&gt;delimiter&lt;space&gt;characters&lt;space&gt;by&lt;space&gt;a&lt;space&gt;single&lt;space&gt;tab&lt;space&gt;to&lt;space&gt;simplify&lt;space&gt;extraction.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;&lt;openbracket&gt;row&lt;space&gt;for&lt;space&gt;row&lt;space&gt;in&lt;space&gt;csv.DictReader&lt;openparen&gt;rows&lt;comma&gt;&lt;space&gt;&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;type&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;ordinality&lt;apos&gt;&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;None&lt;comma&gt;&lt;space&gt;None&lt;comma&gt;&lt;space&gt;&lt;apos&gt;excel-tab&lt;apos&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Logging&lt;space&gt;Support&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FMELogFormatter&lt;openparen&gt;logging.Formatter&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;arg&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;super&lt;openparen&gt;FMELogFormatter&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.arg&lt;space&gt;=&lt;space&gt;arg&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FMELogHandler&lt;openparen&gt;logging.Handler&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;emit&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;record&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Emit&lt;space&gt;a&lt;space&gt;log&lt;space&gt;record.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger&lt;space&gt;=&lt;space&gt;fmeobjects.FMELogFile&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger.logMessageString&lt;openparen&gt;record.getMessage&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;getFMELogger&lt;openparen&gt;name&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Get&lt;space&gt;an&lt;space&gt;FME&lt;space&gt;logger.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger&lt;space&gt;=&lt;space&gt;logging.getLogger&lt;openparen&gt;name&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;formatter&lt;space&gt;=&lt;space&gt;logging.Formatter&lt;openparen&gt;&lt;quote&gt;%&lt;openparen&gt;asctime&lt;closeparen&gt;s&lt;space&gt;%&lt;openparen&gt;levelname&lt;closeparen&gt;s:&lt;space&gt;%&lt;openparen&gt;message&lt;closeparen&gt;s&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;handler&lt;space&gt;=&lt;space&gt;FMELogHandler&lt;openparen&gt;level=&lt;quote&gt;INFO&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;handler.setFormatter&lt;openparen&gt;formatter&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger.addHandler&lt;openparen&gt;handler&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;logger&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Exception&lt;solidus&gt;Error&lt;space&gt;Classes&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;MGSError&lt;openparen&gt;Exception&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;class&lt;space&gt;for&lt;space&gt;exceptions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;message&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;super&lt;openparen&gt;MGSError&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;message&lt;closeparen&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;type&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Error&lt;space&gt;type&lt;space&gt;string.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;Error&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;instructions&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Post-message&lt;space&gt;instructions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;MGSSystemError&lt;openparen&gt;MGSError&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;message&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;super&lt;openparen&gt;MGSSystemError&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;message&lt;closeparen&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;type&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Error&lt;space&gt;type&lt;space&gt;string.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;instructions&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Post-message&lt;space&gt;instructions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;FME&lt;space&gt;Template&lt;space&gt;Class&lt;space&gt;Interface&lt;lf&gt;&lt;lf&gt;TEMP&lt;space&gt;=&lt;space&gt;&lt;apos&gt;FME_SHAREDRESOURCE_TEMP&lt;apos&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Load&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;into&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;sqlite_sort_record_number&lt;apos&gt;&lt;closeparen&gt;&lt;space&gt;==&lt;space&gt;1:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;temporary&lt;space&gt;SQLite&lt;space&gt;database&lt;space&gt;and&lt;space&gt;feature&lt;space&gt;table.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db&lt;space&gt;=&lt;space&gt;None&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;keys&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;sqlite_sort_keys&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Configure&lt;space&gt;database&lt;space&gt;file&lt;space&gt;path&lt;space&gt;and&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;name.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db_path&lt;space&gt;=&lt;space&gt;random_path&lt;openparen&gt;directory=FME_MacroValues&lt;openbracket&gt;TEMP&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;prefix=&lt;apos&gt;SQLiteSorter_&lt;apos&gt;&lt;comma&gt;&lt;space&gt;suffix=&lt;apos&gt;.sqlite&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.table_name&lt;space&gt;=&lt;space&gt;&lt;apos&gt;features&lt;apos&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;SQL&lt;space&gt;DDF&lt;space&gt;key&lt;space&gt;column&lt;space&gt;definitions&lt;space&gt;from&lt;space&gt;the&lt;space&gt;Sort_Keys&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.keys&lt;space&gt;=&lt;space&gt;extract_dict_from_tab_delimited_data&lt;openparen&gt;sanitize_text&lt;openparen&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;lt&gt;apos&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;&lt;apos&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;keys&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;column_defs&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;openparen&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;type&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;temporary&lt;space&gt;database&lt;space&gt;and&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;with&lt;space&gt;a&lt;space&gt;BLOB&lt;space&gt;to&lt;space&gt;contain&lt;space&gt;the&lt;space&gt;serialized&lt;space&gt;feature.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db&lt;space&gt;=&lt;space&gt;sqlite3.connect&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.text_factory&lt;space&gt;=&lt;space&gt;str&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor&lt;space&gt;=&lt;space&gt;self.db.execute&lt;openparen&gt;&lt;quote&gt;create&lt;space&gt;table&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;column_defs&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;feature&lt;space&gt;BLOB&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;create&lt;space&gt;index&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;quote&gt;_index&lt;space&gt;on&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;asc&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;Exception&lt;space&gt;as&lt;space&gt;e:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;open&lt;space&gt;SQLite&lt;space&gt;database&lt;space&gt;&lt;quote&gt;%s&lt;quote&gt;&lt;space&gt;to&lt;space&gt;sort&lt;space&gt;records:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.db_path&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;hasattr&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;&lt;apos&gt;db&lt;apos&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Construct&lt;space&gt;insertion&lt;space&gt;statement&lt;space&gt;elements.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;key_names&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;key_placeholders&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;apos&gt;?&lt;apos&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;all_values&lt;space&gt;=&lt;space&gt;&lt;openbracket&gt;self.get_feature_attribute&lt;openparen&gt;feature&lt;comma&gt;&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;openbracket&gt;buffer&lt;openparen&gt;self.serialize_feature&lt;openparen&gt;feature&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Insert&lt;space&gt;the&lt;space&gt;feature&lt;space&gt;record&lt;space&gt;into&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;insert&lt;space&gt;into&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key_names&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;&lt;space&gt;values&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key_placeholders&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;?&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;all_values&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;store&lt;space&gt;records&lt;space&gt;in&lt;space&gt;SQLite&lt;space&gt;for&lt;space&gt;sorting:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Read&lt;space&gt;all&lt;space&gt;stored&lt;space&gt;features&lt;space&gt;from&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;in&lt;space&gt;the&lt;space&gt;requested&lt;space&gt;order.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;hasattr&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;&lt;apos&gt;db&lt;apos&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.commit&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Construct&lt;space&gt;the&lt;space&gt;ORDER&lt;space&gt;BY&lt;space&gt;clause.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;sort_defs&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;openparen&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;ordinality&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Execute&lt;space&gt;the&lt;space&gt;query&lt;space&gt;and&lt;space&gt;output&lt;space&gt;the&lt;space&gt;features&lt;space&gt;in&lt;space&gt;sorted&lt;space&gt;order&lt;comma&gt;&lt;space&gt;reconstructing&lt;space&gt;them&lt;space&gt;from&lt;space&gt;the&lt;space&gt;serialized&lt;space&gt;copy&lt;space&gt;in&lt;space&gt;the&lt;space&gt;temporary&lt;space&gt;table.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;feature_record&lt;space&gt;in&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;select&lt;space&gt;feature&lt;space&gt;from&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;order&lt;space&gt;by&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;sort_defs&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.output_feature_from_blob&lt;openparen&gt;feature_record&lt;openbracket&gt;0&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;sort&lt;space&gt;records&lt;space&gt;via&lt;space&gt;SQLite:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Don&lt;apos&gt;t&lt;space&gt;leave&lt;space&gt;temporary&lt;space&gt;resource&lt;space&gt;files&lt;space&gt;behind.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;output_feature_from_blob&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;blob&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature&lt;space&gt;=&lt;space&gt;self.deserialize_feature&lt;openparen&gt;blob&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.output_feature&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;deserialize_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;blob&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.deserialize&lt;openparen&gt;bytearray&lt;openparen&gt;blob&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;output_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;get_feature_attribute&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;comma&gt;&lt;space&gt;feature_name&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature.getAttribute&lt;openparen&gt;feature_name&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;serialize_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature.serialize&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="SQLiteSortPythonCaller"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="8"
#!   TYPE="Counter"
#!   VERSION="2"
#!   POSITION="150 0"
#!   BOUNDING_RECT="150 0 -1 -1"
#!   ORDER="500000000000001"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="fme_rejection_code" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="CNT_ATTR" PARM_VALUE="sqlite_sort_record_number"/>
#!     <XFORM_PARM PARM_NAME="DOMAIN" PARM_VALUE="sqlite_sort_counter"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SCOPE" PARM_VALUE="Local"/>
#!     <XFORM_PARM PARM_NAME="START" PARM_VALUE="1"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Counter"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="11"
#!   TYPE="ParameterFetcher"
#!   VERSION="4"
#!   POSITION="1803.0000300002998 303.00303003030029"
#!   BOUNDING_RECT="1803.0000300002998 303.00303003030029 -1 -1"
#!   ORDER="500000000000002"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_keys" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ATTR_LIST" PARM_VALUE="sqlite_sort_keys $(Sort_Keys)"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ParameterFetcher"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="14"
#!   TYPE="Sampler"
#!   VERSION="4"
#!   POSITION="906.009060090601 -3.0000300002999438"
#!   BOUNDING_RECT="906.009060090601 -3.0000300002999438 -1 -1"
#!   ORDER="500000000000003"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="SAMPLED"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="NOT_SAMPLED"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="RATE" PARM_VALUE="1"/>
#!     <XFORM_PARM PARM_NAME="SAMPLE_MODE" PARM_VALUE="No"/>
#!     <XFORM_PARM PARM_NAME="SAMPLE_TYPE_LONG" PARM_VALUE="First N Features"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Sampler"/>
#! </TRANSFORMER>
#! </TRANSFORMERS>
#! <SUBDOCUMENT_IOS>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="2"
#!   NAME="Input"
#!   POSITION="-600 0"
#!   BOUNDING_RECT="-600 0 -1 -1"
#!   COLLAPSED="true"
#!   PUBLISHED="true"
#!   IS_SOURCE="true"
#!   ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="3"
#!   NAME="Sorted"
#!   POSITION="3302.9985299853006 3.0000300003000007"
#!   BOUNDING_RECT="3302.9985299853006 3.0000300003000007 -1 -1"
#!   COLLAPSED="true"
#!   IS_SOURCE="false"
#!   ATTR_MODE="1"
#! >
#! </SUBDOCUMENT_IO>
#! </SUBDOCUMENT_IOS>
#! <FEAT_LINKS>
#! <FEAT_LINK
#!   IDENTIFIER="21"
#!   SOURCE_NODE="2"
#!   TARGET_NODE="8"
#!   SOURCE_PORT_DESC="0"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="6"
#!   SOURCE_NODE="4"
#!   TARGET_NODE="3"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="0"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="15"
#!   SOURCE_NODE="8"
#!   TARGET_NODE="14"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="13"
#!   SOURCE_NODE="11"
#!   TARGET_NODE="4"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="16"
#!   SOURCE_NODE="14"
#!   TARGET_NODE="11"
#!   SOURCE_PORT_DESC="fo 0 SAMPLED"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="17"
#!   SOURCE_NODE="14"
#!   TARGET_NODE="4"
#!   SOURCE_PORT_DESC="fo 1 NOT_SAMPLED"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! </FEAT_LINKS>
#! <BREAKPOINTS>
#! </BREAKPOINTS>
#! <ATTR_LINKS>
#! </ATTR_LINKS>
#! <SUBDOCUMENTS>
#! </SUBDOCUMENTS>
#! <LOOKUP_TABLES>
#! </LOOKUP_TABLES>
#! </TRANSFORMER>

FME_PYTHON_VERSION 2or3
DEFAULT_MACRO $(SQLiteSorter_WORKSPACE_NAME)_Sort_Keys 
#! START_HEADER
#! END_HEADER

DEFAULT_MACRO WB_CURRENT_CONTEXT
DEFAULT_MACRO SQLiteSorter_WORKSPACE_NAME ""
INCLUDE [puts {MACRO WB_OLD_CONTEXT_$(SQLiteSorter_WORKSPACE_NAME) $(WB_CURRENT_CONTEXT)};          puts {MACRO WB_CURRENT_CONTEXT $(SQLiteSorter_WORKSPACE_NAME)}]
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Input1557440891 Input Splitter"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"   OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"
# -------------------------------------------------------------------------
# Create the DomainName that this transformer will use.
# Because @Count itself will evalute the expression to calculate the
# domain, we don't need to do anything in Tcl per feature going by
INCLUDE [    set domainPrefix {};    if { {Local} == {Local} }    {       set domainPrefix [FME_EncodeText {$(SQLiteSorter_WORKSPACE_NAME)_Counter_}];    };    puts "MACRO $(SQLiteSorter_WORKSPACE_NAME)_Counter_FULL_DOMAIN ${domainPrefix}sqlite_sort_counter"; ]
FACTORY_DEF * ExecuteFunctionFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Counter_Rejector    COMMAND_PARM_EVALUATION SINGLE_PASS    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"    FUNCTION_DEFINITION @Count(REJECTABLE_WITH_FLAG,fme_encoded,$($(SQLiteSorter_WORKSPACE_NAME)_Counter_FULL_DOMAIN),"1")    RESULT_ATTRIBUTE "sqlite_sort_record_number"    OUTPUT COMPLETE FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_OUTPUT"    OUTPUT REJECTED FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_<REJECTED>"
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Counter <REJECTED> Transformer Output Nuker"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_<REJECTED>"
# -------------------------------------------------------------------------
# If we're doing LAST N features, then the multiplier comes in as 0.
# If we're doing First N, multiplier is -1.
# For RANDOM, we need to treat LAST N as if it was first N (i.e. have a -1)
# That is what the ? : does in the rate multiplier.
INCLUDE [ if { {-1} == {0} && {ORIGINAL} == {ORIGINAL} } {              puts "MACRO REAL_MODE LAST"; 	         puts "MACRO REAL_RATE 1"; 	      } else {              puts "MACRO REAL_MODE ORIGINAL";              puts "MACRO REAL_RATE [expr 1 * ( -1 ? -1 : -1 ) ]"; 	      } ]
FACTORY_DEF {*} SamplingFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Sampler    COMMAND_PARM_EVALUATION SINGLE_PASS    SAMPLE_RATE $(REAL_RATE)    SAMPLE_ORDER $(REAL_MODE)    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_OUTPUT"    OUTPUT SAMPLED FEATURE_TYPE ___SAMPLED___    OUTPUT NOT_SAMPLED FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_NOT_SAMPLED"
# This TeeFactory is needed because Sampler will still output features if it has no OUTPUT clauses specified.
# This way we behave nicely even if there are no output connections on the transformer. See PR#28886.
FACTORY_DEF * TeeFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Sampler_Sampled    INPUT FEATURE_TYPE ___SAMPLED___    OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_SAMPLED"
# -------------------------------------------------------------------------
Tcl2 proc $(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_doFetch {} {    foreach {name val} {"sqlite_sort_keys {$($(SQLiteSorter_WORKSPACE_NAME)_Sort_Keys)}"} {         if { [string match {*<at>*} $val] == 1 } {             set val [FME_Execute EvaluateExpression {STRING} $val {$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher}];         } elseif {[string match {*FME_CONDITIONAL*} $val] == 1} {             set val [FME_Execute EvaluateExpression {STRING} $val {$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher}];         } else {             set val [FME_DecodeTextOrAttr $val];         };       FME_SetAttribute [FME_DecodeText $name] $val    } }
FACTORY_DEF * TeeFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_SAMPLED"    OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_OUTPUT"         @Tcl2($(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_doFetch)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF * PythonFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_OUTPUT"    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_NOT_SAMPLED"    SYMBOL_NAME FeatureProcessor    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE import<space>fmeobjects<lf><lf>import<space>os<lf>import<space>os.path<lf>import<space>re<lf>import<space>csv<lf>import<space>sys<lf>if<space>sys.version_info<space><gt><space><openparen>3<comma><closeparen>:<lf><space><space><space><space>buffer<space>=<space>memoryview<lf>import<space>random<lf>import<space>string<lf>import<space>traceback<lf>import<space>inspect<lf><lf>import<space>sqlite3<lf>import<space>logging<lf><lf><lf><lf>#<space>Random<space>String<space>Generators<lf><lf>def<space>random_string<openparen>size=24<comma><space>characters=string.ascii_lowercase<space>+<space>string.digits<closeparen>:<lf><space><space><space><space>return<space><apos><apos>.join<openparen>random.choice<openparen>characters<closeparen><space>for<space>x<space>in<space>range<openparen>size<closeparen><closeparen><lf><lf><lf>def<space>random_path<openparen>directory<comma><space>prefix=<quote><quote><comma><space>size=24<comma><space>characters=string.ascii_lowercase<space>+<space>string.digits<comma><space>suffix=<quote><quote><closeparen>:<lf><space><space><space><space>while<space>True:<lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>path<space>=<space>os.path.join<openparen>directory<comma><space>prefix<space>+<space>random_string<openparen>size<comma><space>characters<closeparen><space>+<space>suffix<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>fd<space>=<space>os.open<openparen>path<comma><space>os.O_RDONLY<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>os.close<openparen>fd<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>continue<lf><space><space><space><space><space><space><space><space>except<space>OSError:<lf><space><space><space><space><space><space><space><space><space><space><space><space>break<lf><space><space><space><space>return<space>path<lf><lf><lf><lf>#<space>Text<space>Interpretation<lf><lf>FME_TAG_CODE_TRANSLATIONS<space>=<space><opencurly><apos>lf<apos>:<space><space><space><space><space><space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>div.*?<apos>:<space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>br.*?<apos>:<space><space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>p.*?<apos>:<space><space><space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>cr<apos>:<space><space><space><space><space><space><space><space><space><space><space><apos><backslash>r<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>space<apos>:<space><space><space><space><space><space><space><space><apos><space><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>tab<apos>:<space><space><space><space><space><space><space><space><space><space><apos><backslash>t<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>comma<apos>:<space><space><space><space><space><space><space><space><apos><comma><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>solidus<apos>:<space><space><space><space><space><space><apos><solidus><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>apos<apos>:<space><space><space><space><space><space><space><space><space><apos><comma><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>openparen<apos>:<space><space><space><space><apos><openparen><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closeparen<apos>:<space><space><space><apos><closeparen><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>openbracket<apos>:<space><space><apos><openbracket><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closebracket<apos>:<space><apos><closebracket><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>opencurly<apos>:<space><space><space><space><apos><opencurly><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closecurly<apos>:<space><space><space><apos><closecurly><apos><closecurly><lf><lf>def<space>interpret_fme_character_tags<openparen>raw_text<closeparen>:<lf><space><space><space><space>result<space>=<space>raw_text<lf><space><space><space><space>for<space>fme_tag_code<space>in<space>FME_TAG_CODE_TRANSLATIONS.keys<openparen><closeparen>:<lf><space><space><space><space><space><space><space><space>result<space>=<space>re.sub<openparen><apos><lt><apos><space>+<space>fme_tag_code<space>+<space><apos><gt><apos><comma><space>FME_TAG_CODE_TRANSLATIONS<openbracket>fme_tag_code<closebracket><comma><space>result<closeparen><lf><space><space><space><space>return<space>result<lf><lf>def<space>sanitize_text<openparen>raw_text<closeparen>:<lf><space><space><space><space><quote><quote><quote>Replace<space>FME<space>tags<comma><space>HTML<space>tags<space>or<space>SQL<space>meta-characters<space>with<space>clean<space>and<space>safe<space>equivalents.<quote><quote><quote><lf><space><space><space><space>result<space>=<space>interpret_fme_character_tags<openparen>raw_text<closeparen><lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<quote><apos><openbracket><closeparen><backslash><quote><semicolon>!=<closebracket><quote><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space>#<space>Sanitize<space>SQL<space>metacharacters.<lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<apos><lt>.+?<gt><apos><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space><space><space><space><space>#<space>Sanitize<space>all<space>HTML<space>tags.<lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<apos>^<gt><openbracket><backslash>t<space><closebracket>*<apos><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space><space>#<space>Sanitize<space>email<space>quoting<space>prefixes.<lf><space><space><space><space>return<space>result<lf><lf>def<space>extract_dict_from_tab_delimited_data<openparen>text<closeparen>:<lf><space><space><space><space>rows<space>=<space>re.sub<openparen>r<apos><openbracket><space><backslash>t<closebracket>+<apos><comma><space><quote><backslash>t<quote><comma><space>text<closeparen>.splitlines<openparen><closeparen><space><space>#<space>Replace<space>repeated<space>delimiter<space>characters<space>by<space>a<space>single<space>tab<space>to<space>simplify<space>extraction.<lf><space><space><space><space>return<space><openbracket>row<space>for<space>row<space>in<space>csv.DictReader<openparen>rows<comma><space><openbracket><apos>name<apos><comma><space><apos>type<apos><comma><space><apos>ordinality<apos><closebracket><comma><space>None<comma><space>None<comma><space><apos>excel-tab<apos><closeparen><closebracket><lf><lf><lf><lf>#<space>Logging<space>Support<lf><lf>class<space>FMELogFormatter<openparen>logging.Formatter<closeparen>:<lf><space><space><space><space>def<space>__init__<openparen>self<comma><space>arg<closeparen>:<lf><space><space><space><space><space><space><space><space>super<openparen>FMELogFormatter<comma><space>self<closeparen>.__init__<openparen><closeparen><lf><space><space><space><space><space><space><space><space>self.arg<space>=<space>arg<lf><lf><lf>class<space>FMELogHandler<openparen>logging.Handler<closeparen>:<lf><space><space><space><space>def<space>emit<openparen>self<comma><space>record<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Emit<space>a<space>log<space>record.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>logger<space>=<space>fmeobjects.FMELogFile<openparen><closeparen><lf><space><space><space><space><space><space><space><space>logger.logMessageString<openparen>record.getMessage<openparen><closeparen><closeparen><lf><lf>def<space>getFMELogger<openparen>name<closeparen>:<lf><space><space><space><space><quote><quote><quote>Get<space>an<space>FME<space>logger.<quote><quote><quote><lf><space><space><space><space>logger<space>=<space>logging.getLogger<openparen>name<closeparen><lf><space><space><space><space>formatter<space>=<space>logging.Formatter<openparen><quote>%<openparen>asctime<closeparen>s<space>%<openparen>levelname<closeparen>s:<space>%<openparen>message<closeparen>s<quote><closeparen><lf><space><space><space><space>handler<space>=<space>FMELogHandler<openparen>level=<quote>INFO<quote><closeparen><lf><space><space><space><space>handler.setFormatter<openparen>formatter<closeparen><lf><space><space><space><space>logger.addHandler<openparen>handler<closeparen><lf><space><space><space><space>return<space>logger<lf><lf><lf><lf>#<space>Exception<solidus>Error<space>Classes<lf><lf>class<space>MGSError<openparen>Exception<closeparen>:<lf><tab><quote><quote><quote>Base<space>class<space>for<space>exceptions.<quote><quote><quote><lf><tab><lf><tab>def<space>__init__<openparen>self<comma><space>message<closeparen>:<lf><tab><tab>super<openparen>MGSError<comma><space>self<closeparen>.__init__<openparen>message<closeparen><lf><tab><lf><tab>def<space>type<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Error<space>type<space>string.<quote><quote><quote><lf><tab><tab>return<space><quote>Error<quote><lf><tab><lf><tab>def<space>instructions<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Post-message<space>instructions.<quote><quote><quote><lf><tab><tab>return<space><quote><quote><quote>Please<space>try<space>again.<quote><quote><quote><lf><lf>class<space>MGSSystemError<openparen>MGSError<closeparen>:<lf><tab><lf><tab>def<space>__init__<openparen>self<comma><space>message<closeparen>:<lf><tab><tab>super<openparen>MGSSystemError<comma><space>self<closeparen>.__init__<openparen>message<closeparen><lf><tab><lf><tab>def<space>type<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Error<space>type<space>string.<quote><quote><quote><lf><tab><tab>return<space><quote>Unexpected<space>System<space>Error<quote><lf><tab><lf><tab>def<space>instructions<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Post-message<space>instructions.<quote><quote><quote><lf><tab><tab>return<space><quote><quote><quote>Please<space>try<space>again.<quote><quote><quote><lf><lf><lf><lf>#<space>FME<space>Template<space>Class<space>Interface<lf><lf>TEMP<space>=<space><apos>FME_SHAREDRESOURCE_TEMP<apos><lf><lf>class<space>FeatureProcessor:<lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Load<space>a<space>feature<space>into<space>the<space>sort<space>table.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>feature.getAttribute<openparen><apos>sqlite_sort_record_number<apos><closeparen><space>==<space>1:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>temporary<space>SQLite<space>database<space>and<space>feature<space>table.<quote><quote><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db<space>=<space>None<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>keys<space>=<space>feature.getAttribute<openparen><apos>sqlite_sort_keys<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Configure<space>database<space>file<space>path<space>and<space>sort<space>table<space>name.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db_path<space>=<space>random_path<openparen>directory=FME_MacroValues<openbracket>TEMP<closebracket><comma><space>prefix=<apos>SQLiteSorter_<apos><comma><space>suffix=<apos>.sqlite<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.table_name<space>=<space><apos>features<apos><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>SQL<space>DDF<space>key<space>column<space>definitions<space>from<space>the<space>Sort_Keys<space>parameter.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.keys<space>=<space>extract_dict_from_tab_delimited_data<openparen>sanitize_text<openparen>re.sub<openparen>r<apos><lt>apos<gt><apos><comma><space><quote><apos><quote><comma><space>keys<closeparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>column_defs<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><openparen>key<openbracket><apos>name<apos><closebracket><space>+<space><apos><space><apos><space>+<space>key<openbracket><apos>type<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>temporary<space>database<space>and<space>sort<space>table<space>with<space>a<space>BLOB<space>to<space>contain<space>the<space>serialized<space>feature.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db<space>=<space>sqlite3.connect<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.text_factory<space>=<space>str<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor<space>=<space>self.db.execute<openparen><quote>create<space>table<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>column_defs<space>+<space><quote><comma><space>feature<space>BLOB<closeparen><semicolon><quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>for<space>key<space>in<space>self.keys:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.execute<openparen><quote>create<space>index<space><quote><space>+<space>key<openbracket><apos>name<apos><closebracket><space>+<space><quote>_index<space>on<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>key<openbracket><apos>name<apos><closebracket><space>+<space><quote><space>asc<closeparen><semicolon><quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>except<space>Exception<space>as<space>e:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>open<space>SQLite<space>database<space><quote>%s<quote><space>to<space>sort<space>records:<space>%s<backslash>n%s<apos><comma><space>self.db_path<comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>if<space>hasattr<openparen>self<comma><space><apos>db<apos><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Construct<space>insertion<space>statement<space>elements.<lf><space><space><space><space><space><space><space><space><space><space><space><space>key_names<space>=<space><apos><comma><space><apos>.join<openparen><openbracket>key<openbracket><apos>name<apos><closebracket><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>key_placeholders<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><apos>?<apos><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>all_values<space>=<space><openbracket>self.get_feature_attribute<openparen>feature<comma><space>key<openbracket><apos>name<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><space>+<space><openbracket>buffer<openparen>self.serialize_feature<openparen>feature<closeparen><closeparen><closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Insert<space>the<space>feature<space>record<space>into<space>the<space>sort<space>table.<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.execute<openparen><quote>insert<space>into<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>key_names<space>+<space><quote><comma><space>feature<closeparen><space>values<space><openparen><quote><space>+<space>key_placeholders<space>+<space><quote><comma><space>?<closeparen><semicolon><quote><comma><space>all_values<closeparen><lf><space><space><space><space><space><space><space><space>except:<lf><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>store<space>records<space>in<space>SQLite<space>for<space>sorting:<space>%s<backslash>n%s<apos><comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Read<space>all<space>stored<space>features<space>from<space>the<space>sort<space>table<space>in<space>the<space>requested<space>order.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>hasattr<openparen>self<comma><space><apos>db<apos><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.commit<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Construct<space>the<space>ORDER<space>BY<space>clause.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>sort_defs<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><openparen>key<openbracket><apos>name<apos><closebracket><space>+<space><apos><space><apos><space>+<space>key<openbracket><apos>ordinality<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Execute<space>the<space>query<space>and<space>output<space>the<space>features<space>in<space>sorted<space>order<comma><space>reconstructing<space>them<space>from<space>the<space>serialized<space>copy<space>in<space>the<space>temporary<space>table.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>for<space>feature_record<space>in<space>self.cursor.execute<openparen><quote>select<space>feature<space>from<space><quote><space>+<space>self.table_name<space>+<space><quote><space>order<space>by<space><quote><space>+<space>sort_defs<space>+<space><quote><semicolon><quote><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.output_feature_from_blob<openparen>feature_record<openbracket>0<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>except:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>sort<space>records<space>via<space>SQLite:<space>%s<backslash>n%s<apos><comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Don<apos>t<space>leave<space>temporary<space>resource<space>files<space>behind.<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><lf><space><space><space><space>def<space>output_feature_from_blob<openparen>self<comma><space>blob<closeparen>:<lf><space><space><space><space><space><space><space><space>feature<space>=<space>self.deserialize_feature<openparen>blob<closeparen><lf><space><space><space><space><space><space><space><space>self.output_feature<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>deserialize_feature<openparen>self<comma><space>blob<closeparen>:<lf><space><space><space><space><space><space><space><space>feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space>feature.deserialize<openparen>bytearray<openparen>blob<closeparen><closeparen><lf><space><space><space><space><space><space><space><space>return<space>feature<lf><lf><space><space><space><space>def<space>output_feature<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>get_feature_attribute<openparen>self<comma><space>feature<comma><space>feature_name<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space>feature.getAttribute<openparen>feature_name<closeparen><lf><lf><space><space><space><space>def<space>serialize_feature<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space>feature.serialize<openparen><closeparen><lf>    OUTPUT PYOUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller_OUTPUT"
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Sorted1557440891 Output Collector"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller_OUTPUT"   OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sorted" @RemoveAttributes(sqlite_sort_record_number,sqlite_sort_keys)
INCLUDE [puts {MACRO WB_CURRENT_CONTEXT $(WB_OLD_CONTEXT_$(SQLiteSorter_WORKSPACE_NAME))}]
#! <?xml version="1.0" encoding="UTF-8" ?>
#! <TRANSFORMER
# TRANSFORMER_BEGIN SQLiteSorter,8,Workflows,1772a0fc-7571-452d-ae10-c119d1c29745,"Linked by Default",No,NO_PARALLELISM,,No,18592,YES,No,2or3
# <p>An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.</p>
# <p>For issues or questions, please Create an issue <a href="https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues">here</a>.  For the source, including test driver components, please see the <a href="https://modgeosys.assembla.com/spaces/fme-components/subversion/source">Assembla repository</a>.  For a list of planned improvements, see <a href="https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues">here</a>.</p>
# <p>Copyright &copy; 2017-2019 by Modern geoSystems, released under <a href="https://modgeosys.assembla.com/spaces/fme-components/subversion/source/HEAD/LICENSE?_format=raw">this BSD 3-clause license</a>.</p>
# TRANSFORMER_END
#!   ATTR_TYPE_ENCODING="SDF"
#!   BLOCKED_LOOPING="No"
#!   CATEGORY="Workflows"
#!   DESCRIPTION="&lt;p&gt;An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.&lt;/p&gt;&#10;&lt;p&gt;For issues or questions, please Create an issue &lt;a href=&quot;https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues&quot;&gt;here&lt;/a&gt;.  For the source, including test driver components, please see the &lt;a href=&quot;https://modgeosys.assembla.com/spaces/fme-components/subversion/source&quot;&gt;Assembla repository&lt;/a&gt;.  For a list of planned improvements, see &lt;a href=&quot;https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;&#10;&lt;p&gt;Copyright &amp;copy; 2017-2019 by Modern geoSystems, released under &lt;a href=&quot;https://modgeosys.assembla.com/spaces/fme-components/subversion/source/HEAD/LICENSE?_format=raw&quot;&gt;this BSD 3-clause license&lt;/a&gt;.&lt;/p&gt;"
#!   DOC_EXTENTS="3903 371.003"
#!   DOC_TOP_LEFT="-600 -68"
#!   EXPLICIT_BOOKMARK_ORDER="false"
#!   FME_BUILD_NUM="18592"
#!   FME_DOCUMENT_GUID="1772a0fc-7571-452d-ae10-c119d1c29745"
#!   FME_DOCUMENT_PRIORGUID="2ae62c80-9213-4c9f-b960-7a56ff4fb073,fdc2b942-1632-4648-93d8-70c1b02ce477"
#!   FME_LINKED_TRANSFORMER_VERSION="8"
#!   FME_PROCESS_COUNT="NO_PARALLELISM"
#!   FME_PROCESS_GROUPS_ORDERED="No"
#!   FME_PROCESS_GROUP_BY=""
#!   FME_SERVER_SERVICES=""
#!   FMX_ATTRIBUTE_PROPOGATION_MODE="AUTO"
#!   FMX_INSERT_MODE="Linked by Default"
#!   HISTORY="2017-11-26,Kevin&lt;space&gt;Weller,Initial&lt;space&gt;publication&lt;semicolon&gt;&lt;space&gt;test&lt;space&gt;workspace&lt;space&gt;fails&lt;space&gt;due&lt;space&gt;to&lt;space&gt;FME&lt;space&gt;Hub&lt;space&gt;version&lt;space&gt;delay.,2017-11-30,Kevin&lt;space&gt;Weller,Enhance&lt;space&gt;stack&lt;space&gt;trace&lt;space&gt;reporting&lt;semicolon&gt;&lt;space&gt;use&lt;space&gt;truncated&lt;space&gt;test&lt;space&gt;data&lt;space&gt;and&lt;space&gt;universal&lt;space&gt;temp&lt;space&gt;directory.,2018-01-20,Kevin&lt;space&gt;Weller,Fix&lt;space&gt;absolute&lt;space&gt;parameter&lt;space&gt;name&lt;space&gt;references&lt;space&gt;from&lt;space&gt;PythonCaller&lt;space&gt;when&lt;space&gt;SQLiteServer&lt;space&gt;is&lt;space&gt;called&lt;space&gt;from&lt;space&gt;another&lt;space&gt;custom&lt;space&gt;transformer&lt;space&gt;rather&lt;space&gt;than&lt;space&gt;from&lt;space&gt;the&lt;space&gt;top-level&lt;space&gt;workspace.,2018-03-08,Kevin&lt;space&gt;Weller,Update&lt;space&gt;documentation&lt;space&gt;to&lt;space&gt;reflect&lt;space&gt;move&lt;space&gt;from&lt;space&gt;GitHub&lt;space&gt;to&lt;space&gt;Assembla&lt;space&gt;and&lt;space&gt;Atlassian.,2018-03-18,Kevin&lt;space&gt;Weller,Fix&lt;space&gt;Python&lt;space&gt;syntax&lt;space&gt;error&lt;semicolon&gt;&lt;space&gt;test&lt;space&gt;driver&lt;space&gt;failed&lt;space&gt;to&lt;space&gt;test&lt;space&gt;latest&lt;space&gt;version&lt;comma&gt;&lt;space&gt;so&lt;space&gt;it&lt;space&gt;looked&lt;space&gt;like&lt;space&gt;it&lt;space&gt;worked&lt;space&gt;10&lt;space&gt;days&lt;space&gt;ago&lt;comma&gt;&lt;space&gt;but&lt;space&gt;it&lt;space&gt;didn&lt;apos&gt;t.&lt;space&gt;&lt;amp&gt;*^*&lt;openparen&gt;^&lt;amp&gt;^&lt;openparen&gt;&lt;amp&gt;*!,2018-07-02,Kevin&lt;space&gt;Weller,Enhance&lt;space&gt;parameter&lt;space&gt;handling&lt;space&gt;to&lt;space&gt;allow&lt;space&gt;for&lt;space&gt;multiple&lt;space&gt;references&lt;space&gt;to&lt;space&gt;the&lt;space&gt;transformer&lt;space&gt;from&lt;space&gt;the&lt;space&gt;same&lt;space&gt;calling&lt;space&gt;workspace&lt;space&gt;or&lt;space&gt;transformer.,2018-07-27,Kevin&lt;space&gt;Weller,Don&lt;apos&gt;t&lt;space&gt;expose&lt;space&gt;working&lt;space&gt;attributes&lt;space&gt;on&lt;space&gt;output&lt;space&gt;port."
#!   ITERATION_COUNT_ATTR=""
#!   LAST_SAVE_BUILD="FME(R) 2018.1.2.1 (20190319 - Build 18592 - linux-x64)"
#!   LAST_SAVE_DATE="2019-05-09T13:54:15"
#!   MARKDOWN_DESCRIPTION="An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.&#10;&#10;For issues or questions, please Create an issue [here](https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues).  For the source, including test driver components, please see the [Assembla repository](https://modgeosys.assembla.com/spaces/fme-components/subversion/source).  For a list of planned improvements, see [here](https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues).&#10;&#10;Copyright &amp;copy; 2017-2019 by Modern geoSystems, released under [this BSD 3-clause license](https://modgeosys.assembla.com/spaces/fme-components/subversion/source/HEAD/LICENSE?_format=raw)."
#!   MARKDOWN_USAGE="### Ports&#10;&#10;#### Input&#10;Feed the features to be sorted here.  If the input features consist of a variety of different feature types, it would be wise to ensure the sort key fields are represented in all of them.&#10;&#10;#### Output&#10;The sorted features emerge here.&#10;&#10;### Parameters&#10;&#10;#### Sort_Keys&#10;A tab- or space-delimited table of the sort keys to be applied.  The first column contains the names of the fields to be sorted, in order of sort priority.  The second column contains the database field data type.  The third and last column specifies whether the field is to be sorted in `asc`ending or `desc`ending order, e.g.:  &#10;  &#10;   `kml_name&#9;varchar asc`&#10;&#10;   `kml_id  varchar desc`  &#10;"
#!   MAX_LOOP_ITERATIONS=""
#!   PASSWORD=""
#!   PYTHON_COMPATIBILITY="2or3"
#!   SHOW_ANNOTATIONS="true"
#!   SHOW_INFO_NODES="true"
#!   TITLE="SQLiteSorter"
#!   USAGE="&lt;h3&gt;Ports&lt;/h3&gt;&#10;&lt;h4&gt;Input&lt;/h4&gt;&#10;&lt;p&gt;Feed the features to be sorted here.  If the input features consist of a variety of different feature types, it would be wise to ensure the sort key fields are represented in all of them.&lt;/p&gt;&#10;&lt;h4&gt;Output&lt;/h4&gt;&#10;&lt;p&gt;The sorted features emerge here.&lt;/p&gt;&#10;&lt;h3&gt;Parameters&lt;/h3&gt;&#10;&lt;h4&gt;Sort_Keys&lt;/h4&gt;&#10;&lt;p&gt;A tab- or space-delimited table of the sort keys to be applied.  The first column contains the names of the fields to be sorted, in order of sort priority.  The second column contains the database field data type.  The third and last column specifies whether the field is to be sorted in &lt;code&gt;asc&lt;/code&gt;ending or &lt;code&gt;desc&lt;/code&gt;ending order, e.g.:  &lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;kml_name    varchar asc&lt;/code&gt;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;kml_id  varchar desc&lt;/code&gt;  &lt;/p&gt;"
#!   USE_MARKDOWN="YES"
#!   VIEW_POSITION="-654.007 453.005"
#!   WARN_INVALID_XFORM_PARAM="Yes"
#!   WORKSPACE_VERSION="1"
#!   XFORM_DEPRECATED="No"
#!   ZOOM_SCALE="100"
#! >
#! <DATASETS>
#! </DATASETS>
#! <DATA_TYPES>
#! </DATA_TYPES>
#! <GEOM_TYPES>
#! </GEOM_TYPES>
#! <FEATURE_TYPES>
#! </FEATURE_TYPES>
#! <FMESERVER>
#! </FMESERVER>
#! <GLOBAL_PARAMETERS>
#! <GLOBAL_PARAMETER
#!   GUI_LINE="GUI TEXT_EDIT_OR_ATTR Sort_Keys &quot; &quot; Sort Keys:"
#!   DEFAULT_VALUE=""
#!   IS_STAND_ALONE="true"
#! />
#! </GLOBAL_PARAMETERS>
#! <COMMENTS>
#! <COMMENT
#!   IDENTIFIER="7"
#!   COMMENT_VALUE="&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0//EN&quot; &quot;http://www.w3.org/TR/REC-html40/strict.dtd&quot;&gt;&#10;&lt;html&gt;&lt;head&gt;&lt;meta name=&quot;qrichtext&quot; content=&quot;1&quot; /&gt;&lt;style type=&quot;text/css&quot;&gt;&#10;p, li { white-space: pre-wrap; }&#10;&lt;/style&gt;&lt;/head&gt;&lt;body style=&quot; font-family:&apos;helvetica neue&apos;; font-size:13pt; font-weight:400; font-style:normal;&quot;&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;This is much easier in&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;Python than with FME&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;transformers.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;"
#!   POSITION="2552.9985299853006 303.0000300003"
#!   TOP_LEFT="2552.9985299853006 303.0000300003"
#!   BOTTOM_RIGHT="2551.9985299853006 304.0000300003"
#!   BOUNDING_RECT="2552.9985299853006 303.0000300003 -1 -1"
#!   ORDER="500000000000000"
#!   FOLLOW_ANCHOR="true"
#!   INFO_NODE="false"
#!   COLOUR="1,1,0.78431372549019607,0.19215686274509805"
#!   SIZE_POLICY="8"
#!   ANCHORED_NODE="4"
#! />
#! </COMMENTS>
#! <CONSTANTS>
#! </CONSTANTS>
#! <BOOKMARKS>
#! </BOOKMARKS>
#! <TRANSFORMERS>
#! <TRANSFORMER
#!   IDENTIFIER="4"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="2552.9985299853006 3.0000300003000007"
#!   BOUNDING_RECT="2552.9985299853006 3.0000300003000007 516.04700000000003 71"
#!   ORDER="500000000000000"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_keys" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fmeobjects&lt;lf&gt;&lt;lf&gt;import&lt;space&gt;os&lt;lf&gt;import&lt;space&gt;os.path&lt;lf&gt;import&lt;space&gt;re&lt;lf&gt;import&lt;space&gt;csv&lt;lf&gt;import&lt;space&gt;sys&lt;lf&gt;if&lt;space&gt;sys.version_info&lt;space&gt;&lt;gt&gt;&lt;space&gt;&lt;openparen&gt;3&lt;comma&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;buffer&lt;space&gt;=&lt;space&gt;memoryview&lt;lf&gt;import&lt;space&gt;random&lt;lf&gt;import&lt;space&gt;string&lt;lf&gt;import&lt;space&gt;traceback&lt;lf&gt;import&lt;space&gt;inspect&lt;lf&gt;&lt;lf&gt;import&lt;space&gt;sqlite3&lt;lf&gt;import&lt;space&gt;logging&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Random&lt;space&gt;String&lt;space&gt;Generators&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;random_string&lt;openparen&gt;size=24&lt;comma&gt;&lt;space&gt;characters=string.ascii_lowercase&lt;space&gt;+&lt;space&gt;string.digits&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;random.choice&lt;openparen&gt;characters&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;x&lt;space&gt;in&lt;space&gt;range&lt;openparen&gt;size&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;random_path&lt;openparen&gt;directory&lt;comma&gt;&lt;space&gt;prefix=&lt;quote&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;size=24&lt;comma&gt;&lt;space&gt;characters=string.ascii_lowercase&lt;space&gt;+&lt;space&gt;string.digits&lt;comma&gt;&lt;space&gt;suffix=&lt;quote&gt;&lt;quote&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;while&lt;space&gt;True:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;path&lt;space&gt;=&lt;space&gt;os.path.join&lt;openparen&gt;directory&lt;comma&gt;&lt;space&gt;prefix&lt;space&gt;+&lt;space&gt;random_string&lt;openparen&gt;size&lt;comma&gt;&lt;space&gt;characters&lt;closeparen&gt;&lt;space&gt;+&lt;space&gt;suffix&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;fd&lt;space&gt;=&lt;space&gt;os.open&lt;openparen&gt;path&lt;comma&gt;&lt;space&gt;os.O_RDONLY&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.close&lt;openparen&gt;fd&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;continue&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;OSError:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;break&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;path&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Text&lt;space&gt;Interpretation&lt;lf&gt;&lt;lf&gt;FME_TAG_CODE_TRANSLATIONS&lt;space&gt;=&lt;space&gt;&lt;opencurly&gt;&lt;apos&gt;lf&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;div.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;br.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;p.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;cr&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;r&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;space&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;tab&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;t&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;comma&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;solidus&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;solidus&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;apos&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;openparen&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;openparen&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closeparen&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;closeparen&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;openbracket&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;openbracket&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closebracket&lt;apos&gt;:&lt;space&gt;&lt;apos&gt;&lt;closebracket&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;opencurly&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;opencurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closecurly&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;closecurly&gt;&lt;apos&gt;&lt;closecurly&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;interpret_fme_character_tags&lt;openparen&gt;raw_text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;raw_text&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;fme_tag_code&lt;space&gt;in&lt;space&gt;FME_TAG_CODE_TRANSLATIONS.keys&lt;openparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;&lt;apos&gt;&lt;lt&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;fme_tag_code&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;FME_TAG_CODE_TRANSLATIONS&lt;openbracket&gt;fme_tag_code&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;result&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;result&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;sanitize_text&lt;openparen&gt;raw_text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Replace&lt;space&gt;FME&lt;space&gt;tags&lt;comma&gt;&lt;space&gt;HTML&lt;space&gt;tags&lt;space&gt;or&lt;space&gt;SQL&lt;space&gt;meta-characters&lt;space&gt;with&lt;space&gt;clean&lt;space&gt;and&lt;space&gt;safe&lt;space&gt;equivalents.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;interpret_fme_character_tags&lt;openparen&gt;raw_text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;quote&gt;&lt;apos&gt;&lt;openbracket&gt;&lt;closeparen&gt;&lt;backslash&gt;&lt;quote&gt;&lt;semicolon&gt;!=&lt;closebracket&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;SQL&lt;space&gt;metacharacters.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;lt&gt;.+?&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;all&lt;space&gt;HTML&lt;space&gt;tags.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;^&lt;gt&gt;&lt;openbracket&gt;&lt;backslash&gt;t&lt;space&gt;&lt;closebracket&gt;*&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;email&lt;space&gt;quoting&lt;space&gt;prefixes.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;result&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;extract_dict_from_tab_delimited_data&lt;openparen&gt;text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;rows&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;openbracket&gt;&lt;space&gt;&lt;backslash&gt;t&lt;closebracket&gt;+&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;&lt;backslash&gt;t&lt;quote&gt;&lt;comma&gt;&lt;space&gt;text&lt;closeparen&gt;.splitlines&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Replace&lt;space&gt;repeated&lt;space&gt;delimiter&lt;space&gt;characters&lt;space&gt;by&lt;space&gt;a&lt;space&gt;single&lt;space&gt;tab&lt;space&gt;to&lt;space&gt;simplify&lt;space&gt;extraction.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;&lt;openbracket&gt;row&lt;space&gt;for&lt;space&gt;row&lt;space&gt;in&lt;space&gt;csv.DictReader&lt;openparen&gt;rows&lt;comma&gt;&lt;space&gt;&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;type&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;ordinality&lt;apos&gt;&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;None&lt;comma&gt;&lt;space&gt;None&lt;comma&gt;&lt;space&gt;&lt;apos&gt;excel-tab&lt;apos&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Logging&lt;space&gt;Support&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FMELogFormatter&lt;openparen&gt;logging.Formatter&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;arg&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;super&lt;openparen&gt;FMELogFormatter&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.arg&lt;space&gt;=&lt;space&gt;arg&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FMELogHandler&lt;openparen&gt;logging.Handler&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;emit&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;record&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Emit&lt;space&gt;a&lt;space&gt;log&lt;space&gt;record.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger&lt;space&gt;=&lt;space&gt;fmeobjects.FMELogFile&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger.logMessageString&lt;openparen&gt;record.getMessage&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;getFMELogger&lt;openparen&gt;name&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Get&lt;space&gt;an&lt;space&gt;FME&lt;space&gt;logger.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger&lt;space&gt;=&lt;space&gt;logging.getLogger&lt;openparen&gt;name&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;formatter&lt;space&gt;=&lt;space&gt;logging.Formatter&lt;openparen&gt;&lt;quote&gt;%&lt;openparen&gt;asctime&lt;closeparen&gt;s&lt;space&gt;%&lt;openparen&gt;levelname&lt;closeparen&gt;s:&lt;space&gt;%&lt;openparen&gt;message&lt;closeparen&gt;s&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;handler&lt;space&gt;=&lt;space&gt;FMELogHandler&lt;openparen&gt;level=&lt;quote&gt;INFO&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;handler.setFormatter&lt;openparen&gt;formatter&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger.addHandler&lt;openparen&gt;handler&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;logger&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Exception&lt;solidus&gt;Error&lt;space&gt;Classes&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;MGSError&lt;openparen&gt;Exception&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;class&lt;space&gt;for&lt;space&gt;exceptions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;message&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;super&lt;openparen&gt;MGSError&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;message&lt;closeparen&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;type&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Error&lt;space&gt;type&lt;space&gt;string.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;Error&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;instructions&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Post-message&lt;space&gt;instructions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;MGSSystemError&lt;openparen&gt;MGSError&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;message&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;super&lt;openparen&gt;MGSSystemError&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;message&lt;closeparen&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;type&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Error&lt;space&gt;type&lt;space&gt;string.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;instructions&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Post-message&lt;space&gt;instructions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;FME&lt;space&gt;Template&lt;space&gt;Class&lt;space&gt;Interface&lt;lf&gt;&lt;lf&gt;TEMP&lt;space&gt;=&lt;space&gt;&lt;apos&gt;FME_SHAREDRESOURCE_TEMP&lt;apos&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Load&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;into&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;sqlite_sort_record_number&lt;apos&gt;&lt;closeparen&gt;&lt;space&gt;==&lt;space&gt;1:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;temporary&lt;space&gt;SQLite&lt;space&gt;database&lt;space&gt;and&lt;space&gt;feature&lt;space&gt;table.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db&lt;space&gt;=&lt;space&gt;None&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;keys&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;sqlite_sort_keys&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Configure&lt;space&gt;database&lt;space&gt;file&lt;space&gt;path&lt;space&gt;and&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;name.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db_path&lt;space&gt;=&lt;space&gt;random_path&lt;openparen&gt;directory=FME_MacroValues&lt;openbracket&gt;TEMP&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;prefix=&lt;apos&gt;SQLiteSorter_&lt;apos&gt;&lt;comma&gt;&lt;space&gt;suffix=&lt;apos&gt;.sqlite&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.table_name&lt;space&gt;=&lt;space&gt;&lt;apos&gt;features&lt;apos&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;SQL&lt;space&gt;DDF&lt;space&gt;key&lt;space&gt;column&lt;space&gt;definitions&lt;space&gt;from&lt;space&gt;the&lt;space&gt;Sort_Keys&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.keys&lt;space&gt;=&lt;space&gt;extract_dict_from_tab_delimited_data&lt;openparen&gt;sanitize_text&lt;openparen&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;lt&gt;apos&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;&lt;apos&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;keys&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;column_defs&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;openparen&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;type&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;temporary&lt;space&gt;database&lt;space&gt;and&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;with&lt;space&gt;a&lt;space&gt;BLOB&lt;space&gt;to&lt;space&gt;contain&lt;space&gt;the&lt;space&gt;serialized&lt;space&gt;feature.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db&lt;space&gt;=&lt;space&gt;sqlite3.connect&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.text_factory&lt;space&gt;=&lt;space&gt;str&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor&lt;space&gt;=&lt;space&gt;self.db.execute&lt;openparen&gt;&lt;quote&gt;create&lt;space&gt;table&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;column_defs&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;feature&lt;space&gt;BLOB&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;create&lt;space&gt;index&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;quote&gt;_index&lt;space&gt;on&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;asc&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;Exception&lt;space&gt;as&lt;space&gt;e:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;open&lt;space&gt;SQLite&lt;space&gt;database&lt;space&gt;&lt;quote&gt;%s&lt;quote&gt;&lt;space&gt;to&lt;space&gt;sort&lt;space&gt;records:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.db_path&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;hasattr&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;&lt;apos&gt;db&lt;apos&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Construct&lt;space&gt;insertion&lt;space&gt;statement&lt;space&gt;elements.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;key_names&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;key_placeholders&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;apos&gt;?&lt;apos&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;all_values&lt;space&gt;=&lt;space&gt;&lt;openbracket&gt;self.get_feature_attribute&lt;openparen&gt;feature&lt;comma&gt;&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;openbracket&gt;buffer&lt;openparen&gt;self.serialize_feature&lt;openparen&gt;feature&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Insert&lt;space&gt;the&lt;space&gt;feature&lt;space&gt;record&lt;space&gt;into&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;insert&lt;space&gt;into&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key_names&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;&lt;space&gt;values&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key_placeholders&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;?&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;all_values&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;store&lt;space&gt;records&lt;space&gt;in&lt;space&gt;SQLite&lt;space&gt;for&lt;space&gt;sorting:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Read&lt;space&gt;all&lt;space&gt;stored&lt;space&gt;features&lt;space&gt;from&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;in&lt;space&gt;the&lt;space&gt;requested&lt;space&gt;order.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;hasattr&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;&lt;apos&gt;db&lt;apos&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.commit&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Construct&lt;space&gt;the&lt;space&gt;ORDER&lt;space&gt;BY&lt;space&gt;clause.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;sort_defs&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;openparen&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;ordinality&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Execute&lt;space&gt;the&lt;space&gt;query&lt;space&gt;and&lt;space&gt;output&lt;space&gt;the&lt;space&gt;features&lt;space&gt;in&lt;space&gt;sorted&lt;space&gt;order&lt;comma&gt;&lt;space&gt;reconstructing&lt;space&gt;them&lt;space&gt;from&lt;space&gt;the&lt;space&gt;serialized&lt;space&gt;copy&lt;space&gt;in&lt;space&gt;the&lt;space&gt;temporary&lt;space&gt;table.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;feature_record&lt;space&gt;in&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;select&lt;space&gt;feature&lt;space&gt;from&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;order&lt;space&gt;by&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;sort_defs&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.output_feature_from_blob&lt;openparen&gt;feature_record&lt;openbracket&gt;0&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;sort&lt;space&gt;records&lt;space&gt;via&lt;space&gt;SQLite:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Don&lt;apos&gt;t&lt;space&gt;leave&lt;space&gt;temporary&lt;space&gt;resource&lt;space&gt;files&lt;space&gt;behind.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;output_feature_from_blob&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;blob&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature&lt;space&gt;=&lt;space&gt;self.deserialize_feature&lt;openparen&gt;blob&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.output_feature&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;deserialize_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;blob&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.deserialize&lt;openparen&gt;bytearray&lt;openparen&gt;blob&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;output_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;get_feature_attribute&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;comma&gt;&lt;space&gt;feature_name&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature.getAttribute&lt;openparen&gt;feature_name&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;serialize_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature.serialize&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="SQLiteSortPythonCaller"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="8"
#!   TYPE="Counter"
#!   VERSION="2"
#!   POSITION="150 0"
#!   BOUNDING_RECT="150 0 -1 -1"
#!   ORDER="500000000000001"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="fme_rejection_code" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="CNT_ATTR" PARM_VALUE="sqlite_sort_record_number"/>
#!     <XFORM_PARM PARM_NAME="DOMAIN" PARM_VALUE="sqlite_sort_counter"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SCOPE" PARM_VALUE="Local"/>
#!     <XFORM_PARM PARM_NAME="START" PARM_VALUE="1"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Counter"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="11"
#!   TYPE="ParameterFetcher"
#!   VERSION="4"
#!   POSITION="1803.0000300002998 303.00303003030029"
#!   BOUNDING_RECT="1803.0000300002998 303.00303003030029 -1 -1"
#!   ORDER="500000000000002"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_keys" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ATTR_LIST" PARM_VALUE="sqlite_sort_keys $(Sort_Keys)"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ParameterFetcher"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="14"
#!   TYPE="Sampler"
#!   VERSION="4"
#!   POSITION="906.009060090601 -3.0000300002999438"
#!   BOUNDING_RECT="906.009060090601 -3.0000300002999438 -1 -1"
#!   ORDER="500000000000003"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="SAMPLED"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="NOT_SAMPLED"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="RATE" PARM_VALUE="1"/>
#!     <XFORM_PARM PARM_NAME="SAMPLE_MODE" PARM_VALUE="No"/>
#!     <XFORM_PARM PARM_NAME="SAMPLE_TYPE_LONG" PARM_VALUE="First N Features"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Sampler"/>
#! </TRANSFORMER>
#! </TRANSFORMERS>
#! <SUBDOCUMENT_IOS>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="2"
#!   NAME="Input"
#!   POSITION="-600 0"
#!   BOUNDING_RECT="-600 0 -1 -1"
#!   COLLAPSED="true"
#!   PUBLISHED="true"
#!   IS_SOURCE="true"
#!   ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="3"
#!   NAME="Sorted"
#!   POSITION="3302.9985299853006 3.0000300003000007"
#!   BOUNDING_RECT="3302.9985299853006 3.0000300003000007 -1 -1"
#!   COLLAPSED="true"
#!   IS_SOURCE="false"
#!   ATTR_MODE="1"
#! >
#! </SUBDOCUMENT_IO>
#! </SUBDOCUMENT_IOS>
#! <FEAT_LINKS>
#! <FEAT_LINK
#!   IDENTIFIER="21"
#!   SOURCE_NODE="2"
#!   TARGET_NODE="8"
#!   SOURCE_PORT_DESC="0"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="6"
#!   SOURCE_NODE="4"
#!   TARGET_NODE="3"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="0"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="15"
#!   SOURCE_NODE="8"
#!   TARGET_NODE="14"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="13"
#!   SOURCE_NODE="11"
#!   TARGET_NODE="4"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="16"
#!   SOURCE_NODE="14"
#!   TARGET_NODE="11"
#!   SOURCE_PORT_DESC="fo 0 SAMPLED"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="17"
#!   SOURCE_NODE="14"
#!   TARGET_NODE="4"
#!   SOURCE_PORT_DESC="fo 1 NOT_SAMPLED"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! </FEAT_LINKS>
#! <BREAKPOINTS>
#! </BREAKPOINTS>
#! <ATTR_LINKS>
#! </ATTR_LINKS>
#! <SUBDOCUMENTS>
#! </SUBDOCUMENTS>
#! <LOOKUP_TABLES>
#! </LOOKUP_TABLES>
#! </TRANSFORMER>

FME_PYTHON_VERSION 2or3
DEFAULT_MACRO $(SQLiteSorter_WORKSPACE_NAME)_Sort_Keys 
#! START_HEADER
#! END_HEADER

DEFAULT_MACRO WB_CURRENT_CONTEXT
DEFAULT_MACRO SQLiteSorter_WORKSPACE_NAME ""
INCLUDE [puts {MACRO WB_OLD_CONTEXT_$(SQLiteSorter_WORKSPACE_NAME) $(WB_CURRENT_CONTEXT)};          puts {MACRO WB_CURRENT_CONTEXT $(SQLiteSorter_WORKSPACE_NAME)}]
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Input1557431655 Input Splitter"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"   OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"
# -------------------------------------------------------------------------
# Create the DomainName that this transformer will use.
# Because @Count itself will evalute the expression to calculate the
# domain, we don't need to do anything in Tcl per feature going by
INCLUDE [    set domainPrefix {};    if { {Local} == {Local} }    {       set domainPrefix [FME_EncodeText {$(SQLiteSorter_WORKSPACE_NAME)_Counter_}];    };    puts "MACRO $(SQLiteSorter_WORKSPACE_NAME)_Counter_FULL_DOMAIN ${domainPrefix}sqlite_sort_counter"; ]
FACTORY_DEF * ExecuteFunctionFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Counter_Rejector    COMMAND_PARM_EVALUATION SINGLE_PASS    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"    FUNCTION_DEFINITION @Count(REJECTABLE_WITH_FLAG,fme_encoded,$($(SQLiteSorter_WORKSPACE_NAME)_Counter_FULL_DOMAIN),"1")    RESULT_ATTRIBUTE "sqlite_sort_record_number"    OUTPUT COMPLETE FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_OUTPUT"    OUTPUT REJECTED FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_<REJECTED>"
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Counter <REJECTED> Transformer Output Nuker"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_<REJECTED>"
# -------------------------------------------------------------------------
# If we're doing LAST N features, then the multiplier comes in as 0.
# If we're doing First N, multiplier is -1.
# For RANDOM, we need to treat LAST N as if it was first N (i.e. have a -1)
# That is what the ? : does in the rate multiplier.
INCLUDE [ if { {-1} == {0} && {ORIGINAL} == {ORIGINAL} } {              puts "MACRO REAL_MODE LAST"; 	         puts "MACRO REAL_RATE 1"; 	      } else {              puts "MACRO REAL_MODE ORIGINAL";              puts "MACRO REAL_RATE [expr 1 * ( -1 ? -1 : -1 ) ]"; 	      } ]
FACTORY_DEF {*} SamplingFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Sampler    COMMAND_PARM_EVALUATION SINGLE_PASS    SAMPLE_RATE $(REAL_RATE)    SAMPLE_ORDER $(REAL_MODE)    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_OUTPUT"    OUTPUT SAMPLED FEATURE_TYPE ___SAMPLED___    OUTPUT NOT_SAMPLED FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_NOT_SAMPLED"
# This TeeFactory is needed because Sampler will still output features if it has no OUTPUT clauses specified.
# This way we behave nicely even if there are no output connections on the transformer. See PR#28886.
FACTORY_DEF * TeeFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Sampler_Sampled    INPUT FEATURE_TYPE ___SAMPLED___    OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_SAMPLED"
# -------------------------------------------------------------------------
Tcl2 proc $(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_doFetch {} {    foreach {name val} {"sqlite_sort_keys {$($(SQLiteSorter_WORKSPACE_NAME)_Sort_Keys)}"} {         if { [string match {*<at>*} $val] == 1 } {             set val [FME_Execute EvaluateExpression {STRING} $val {$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher}];         } elseif {[string match {*FME_CONDITIONAL*} $val] == 1} {             set val [FME_Execute EvaluateExpression {STRING} $val {$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher}];         } else {             set val [FME_DecodeTextOrAttr $val];         };       FME_SetAttribute [FME_DecodeText $name] $val    } }
FACTORY_DEF * TeeFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_SAMPLED"    OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_OUTPUT"         @Tcl2($(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_doFetch)
# -------------------------------------------------------------------------
FME_PYTHON_PATH "$(FME_MF_DIR)"
FACTORY_DEF * PythonFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_OUTPUT"    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_NOT_SAMPLED"    SYMBOL_NAME FeatureProcessor    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE import<space>fmeobjects<lf><lf>import<space>os<lf>import<space>os.path<lf>import<space>re<lf>import<space>csv<lf>import<space>sys<lf>if<space>sys.version_info<space><gt><space><openparen>3<comma><closeparen>:<lf><space><space><space><space>buffer<space>=<space>memoryview<lf>import<space>random<lf>import<space>string<lf>import<space>traceback<lf>import<space>inspect<lf><lf>import<space>sqlite3<lf>import<space>logging<lf><lf><lf><lf>#<space>Random<space>String<space>Generators<lf><lf>def<space>random_string<openparen>size=24<comma><space>characters=string.ascii_lowercase<space>+<space>string.digits<closeparen>:<lf><space><space><space><space>return<space><apos><apos>.join<openparen>random.choice<openparen>characters<closeparen><space>for<space>x<space>in<space>range<openparen>size<closeparen><closeparen><lf><lf><lf>def<space>random_path<openparen>directory<comma><space>prefix=<quote><quote><comma><space>size=24<comma><space>characters=string.ascii_lowercase<space>+<space>string.digits<comma><space>suffix=<quote><quote><closeparen>:<lf><space><space><space><space>while<space>True:<lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>path<space>=<space>os.path.join<openparen>directory<comma><space>prefix<space>+<space>random_string<openparen>size<comma><space>characters<closeparen><space>+<space>suffix<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>fd<space>=<space>os.open<openparen>path<comma><space>os.O_RDONLY<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>os.close<openparen>fd<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>continue<lf><space><space><space><space><space><space><space><space>except<space>OSError:<lf><space><space><space><space><space><space><space><space><space><space><space><space>break<lf><space><space><space><space>return<space>path<lf><lf><lf><lf>#<space>Text<space>Interpretation<lf><lf>FME_TAG_CODE_TRANSLATIONS<space>=<space><opencurly><apos>lf<apos>:<space><space><space><space><space><space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>div.*?<apos>:<space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>br.*?<apos>:<space><space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>p.*?<apos>:<space><space><space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>cr<apos>:<space><space><space><space><space><space><space><space><space><space><space><apos><backslash>r<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>space<apos>:<space><space><space><space><space><space><space><space><apos><space><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>tab<apos>:<space><space><space><space><space><space><space><space><space><space><apos><backslash>t<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>comma<apos>:<space><space><space><space><space><space><space><space><apos><comma><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>solidus<apos>:<space><space><space><space><space><space><apos><solidus><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>apos<apos>:<space><space><space><space><space><space><space><space><space><apos><comma><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>openparen<apos>:<space><space><space><space><apos><openparen><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closeparen<apos>:<space><space><space><apos><closeparen><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>openbracket<apos>:<space><space><apos><openbracket><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closebracket<apos>:<space><apos><closebracket><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>opencurly<apos>:<space><space><space><space><apos><opencurly><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closecurly<apos>:<space><space><space><apos><closecurly><apos><closecurly><lf><lf>def<space>interpret_fme_character_tags<openparen>raw_text<closeparen>:<lf><space><space><space><space>result<space>=<space>raw_text<lf><space><space><space><space>for<space>fme_tag_code<space>in<space>FME_TAG_CODE_TRANSLATIONS.keys<openparen><closeparen>:<lf><space><space><space><space><space><space><space><space>result<space>=<space>re.sub<openparen><apos><lt><apos><space>+<space>fme_tag_code<space>+<space><apos><gt><apos><comma><space>FME_TAG_CODE_TRANSLATIONS<openbracket>fme_tag_code<closebracket><comma><space>result<closeparen><lf><space><space><space><space>return<space>result<lf><lf>def<space>sanitize_text<openparen>raw_text<closeparen>:<lf><space><space><space><space><quote><quote><quote>Replace<space>FME<space>tags<comma><space>HTML<space>tags<space>or<space>SQL<space>meta-characters<space>with<space>clean<space>and<space>safe<space>equivalents.<quote><quote><quote><lf><space><space><space><space>result<space>=<space>interpret_fme_character_tags<openparen>raw_text<closeparen><lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<quote><apos><openbracket><closeparen><backslash><quote><semicolon>!=<closebracket><quote><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space>#<space>Sanitize<space>SQL<space>metacharacters.<lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<apos><lt>.+?<gt><apos><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space><space><space><space><space>#<space>Sanitize<space>all<space>HTML<space>tags.<lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<apos>^<gt><openbracket><backslash>t<space><closebracket>*<apos><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space><space>#<space>Sanitize<space>email<space>quoting<space>prefixes.<lf><space><space><space><space>return<space>result<lf><lf>def<space>extract_dict_from_tab_delimited_data<openparen>text<closeparen>:<lf><space><space><space><space>rows<space>=<space>re.sub<openparen>r<apos><openbracket><space><backslash>t<closebracket>+<apos><comma><space><quote><backslash>t<quote><comma><space>text<closeparen>.splitlines<openparen><closeparen><space><space>#<space>Replace<space>repeated<space>delimiter<space>characters<space>by<space>a<space>single<space>tab<space>to<space>simplify<space>extraction.<lf><space><space><space><space>return<space><openbracket>row<space>for<space>row<space>in<space>csv.DictReader<openparen>rows<comma><space><openbracket><apos>name<apos><comma><space><apos>type<apos><comma><space><apos>ordinality<apos><closebracket><comma><space>None<comma><space>None<comma><space><apos>excel-tab<apos><closeparen><closebracket><lf><lf><lf><lf>#<space>Logging<space>Support<lf><lf>class<space>FMELogFormatter<openparen>logging.Formatter<closeparen>:<lf><space><space><space><space>def<space>__init__<openparen>self<comma><space>arg<closeparen>:<lf><space><space><space><space><space><space><space><space>super<openparen>FMELogFormatter<comma><space>self<closeparen>.__init__<openparen><closeparen><lf><space><space><space><space><space><space><space><space>self.arg<space>=<space>arg<lf><lf><lf>class<space>FMELogHandler<openparen>logging.Handler<closeparen>:<lf><space><space><space><space>def<space>emit<openparen>self<comma><space>record<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Emit<space>a<space>log<space>record.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>logger<space>=<space>fmeobjects.FMELogFile<openparen><closeparen><lf><space><space><space><space><space><space><space><space>logger.logMessageString<openparen>record.getMessage<openparen><closeparen><closeparen><lf><lf>def<space>getFMELogger<openparen>name<closeparen>:<lf><space><space><space><space><quote><quote><quote>Get<space>an<space>FME<space>logger.<quote><quote><quote><lf><space><space><space><space>logger<space>=<space>logging.getLogger<openparen>name<closeparen><lf><space><space><space><space>formatter<space>=<space>logging.Formatter<openparen><quote>%<openparen>asctime<closeparen>s<space>%<openparen>levelname<closeparen>s:<space>%<openparen>message<closeparen>s<quote><closeparen><lf><space><space><space><space>handler<space>=<space>FMELogHandler<openparen>level=<quote>INFO<quote><closeparen><lf><space><space><space><space>handler.setFormatter<openparen>formatter<closeparen><lf><space><space><space><space>logger.addHandler<openparen>handler<closeparen><lf><space><space><space><space>return<space>logger<lf><lf><lf><lf>#<space>Exception<solidus>Error<space>Classes<lf><lf>class<space>MGSError<openparen>Exception<closeparen>:<lf><tab><quote><quote><quote>Base<space>class<space>for<space>exceptions.<quote><quote><quote><lf><tab><lf><tab>def<space>__init__<openparen>self<comma><space>message<closeparen>:<lf><tab><tab>super<openparen>MGSError<comma><space>self<closeparen>.__init__<openparen>message<closeparen><lf><tab><lf><tab>def<space>type<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Error<space>type<space>string.<quote><quote><quote><lf><tab><tab>return<space><quote>Error<quote><lf><tab><lf><tab>def<space>instructions<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Post-message<space>instructions.<quote><quote><quote><lf><tab><tab>return<space><quote><quote><quote>Please<space>try<space>again.<quote><quote><quote><lf><lf>class<space>MGSSystemError<openparen>MGSError<closeparen>:<lf><tab><lf><tab>def<space>__init__<openparen>self<comma><space>message<closeparen>:<lf><tab><tab>super<openparen>MGSSystemError<comma><space>self<closeparen>.__init__<openparen>message<closeparen><lf><tab><lf><tab>def<space>type<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Error<space>type<space>string.<quote><quote><quote><lf><tab><tab>return<space><quote>Unexpected<space>System<space>Error<quote><lf><tab><lf><tab>def<space>instructions<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Post-message<space>instructions.<quote><quote><quote><lf><tab><tab>return<space><quote><quote><quote>Please<space>try<space>again.<quote><quote><quote><lf><lf><lf><lf>#<space>FME<space>Template<space>Class<space>Interface<lf><lf>TEMP<space>=<space><apos>FME_SHAREDRESOURCE_TEMP<apos><lf><lf>class<space>FeatureProcessor:<lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Load<space>a<space>feature<space>into<space>the<space>sort<space>table.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>feature.getAttribute<openparen><apos>sqlite_sort_record_number<apos><closeparen><space>==<space>1:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>temporary<space>SQLite<space>database<space>and<space>feature<space>table.<quote><quote><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db<space>=<space>None<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>keys<space>=<space>feature.getAttribute<openparen><apos>sqlite_sort_keys<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Configure<space>database<space>file<space>path<space>and<space>sort<space>table<space>name.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db_path<space>=<space>random_path<openparen>directory=FME_MacroValues<openbracket>TEMP<closebracket><comma><space>prefix=<apos>SQLiteSorter_<apos><comma><space>suffix=<apos>.sqlite<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.table_name<space>=<space><apos>features<apos><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>SQL<space>DDF<space>key<space>column<space>definitions<space>from<space>the<space>Sort_Keys<space>parameter.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.keys<space>=<space>extract_dict_from_tab_delimited_data<openparen>sanitize_text<openparen>re.sub<openparen>r<apos><lt>apos<gt><apos><comma><space><quote><apos><quote><comma><space>keys<closeparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>column_defs<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><openparen>key<openbracket><apos>name<apos><closebracket><space>+<space><apos><space><apos><space>+<space>key<openbracket><apos>type<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>temporary<space>database<space>and<space>sort<space>table<space>with<space>a<space>BLOB<space>to<space>contain<space>the<space>serialized<space>feature.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db<space>=<space>sqlite3.connect<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.text_factory<space>=<space>str<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor<space>=<space>self.db.execute<openparen><quote>create<space>table<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>column_defs<space>+<space><quote><comma><space>feature<space>BLOB<closeparen><semicolon><quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>for<space>key<space>in<space>self.keys:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.execute<openparen><quote>create<space>index<space><quote><space>+<space>key<openbracket><apos>name<apos><closebracket><space>+<space><quote>_index<space>on<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>key<openbracket><apos>name<apos><closebracket><space>+<space><quote><space>asc<closeparen><semicolon><quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>except<space>Exception<space>as<space>e:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>open<space>SQLite<space>database<space><quote>%s<quote><space>to<space>sort<space>records:<space>%s<backslash>n%s<apos><comma><space>self.db_path<comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>if<space>hasattr<openparen>self<comma><space><apos>db<apos><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Construct<space>insertion<space>statement<space>elements.<lf><space><space><space><space><space><space><space><space><space><space><space><space>key_names<space>=<space><apos><comma><space><apos>.join<openparen><openbracket>key<openbracket><apos>name<apos><closebracket><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>key_placeholders<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><apos>?<apos><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>all_values<space>=<space><openbracket>self.get_feature_attribute<openparen>feature<comma><space>key<openbracket><apos>name<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><space>+<space><openbracket>buffer<openparen>self.serialize_feature<openparen>feature<closeparen><closeparen><closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Insert<space>the<space>feature<space>record<space>into<space>the<space>sort<space>table.<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.execute<openparen><quote>insert<space>into<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>key_names<space>+<space><quote><comma><space>feature<closeparen><space>values<space><openparen><quote><space>+<space>key_placeholders<space>+<space><quote><comma><space>?<closeparen><semicolon><quote><comma><space>all_values<closeparen><lf><space><space><space><space><space><space><space><space>except:<lf><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>store<space>records<space>in<space>SQLite<space>for<space>sorting:<space>%s<backslash>n%s<apos><comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Read<space>all<space>stored<space>features<space>from<space>the<space>sort<space>table<space>in<space>the<space>requested<space>order.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>hasattr<openparen>self<comma><space><apos>db<apos><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.commit<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Construct<space>the<space>ORDER<space>BY<space>clause.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>sort_defs<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><openparen>key<openbracket><apos>name<apos><closebracket><space>+<space><apos><space><apos><space>+<space>key<openbracket><apos>ordinality<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Execute<space>the<space>query<space>and<space>output<space>the<space>features<space>in<space>sorted<space>order<comma><space>reconstructing<space>them<space>from<space>the<space>serialized<space>copy<space>in<space>the<space>temporary<space>table.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>for<space>feature_record<space>in<space>self.cursor.execute<openparen><quote>select<space>feature<space>from<space><quote><space>+<space>self.table_name<space>+<space><quote><space>order<space>by<space><quote><space>+<space>sort_defs<space>+<space><quote><semicolon><quote><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.output_feature_from_blob<openparen>feature_record<openbracket>0<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>except:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>sort<space>records<space>via<space>SQLite:<space>%s<backslash>n%s<apos><comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Don<apos>t<space>leave<space>temporary<space>resource<space>files<space>behind.<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><lf><space><space><space><space>def<space>output_feature_from_blob<openparen>self<comma><space>blob<closeparen>:<lf><space><space><space><space><space><space><space><space>feature<space>=<space>self.deserialize_feature<openparen>blob<closeparen><lf><space><space><space><space><space><space><space><space>self.output_feature<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>deserialize_feature<openparen>self<comma><space>blob<closeparen>:<lf><space><space><space><space><space><space><space><space>feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space>feature.deserialize<openparen>bytearray<openparen>blob<closeparen><closeparen><lf><space><space><space><space><space><space><space><space>return<space>feature<lf><lf><space><space><space><space>def<space>output_feature<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>get_feature_attribute<openparen>self<comma><space>feature<comma><space>feature_name<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space>feature.getAttribute<openparen>feature_name<closeparen><lf><lf><space><space><space><space>def<space>serialize_feature<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space>feature.serialize<openparen><closeparen><lf>    OUTPUT PYOUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller_OUTPUT"
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Sorted1557431655 Output Collector"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller_OUTPUT"   OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sorted" @RemoveAttributes(sqlite_sort_record_number,sqlite_sort_keys)
INCLUDE [puts {MACRO WB_CURRENT_CONTEXT $(WB_OLD_CONTEXT_$(SQLiteSorter_WORKSPACE_NAME))}]
#! <?xml version="1.0" encoding="UTF-8" ?>
#! <TRANSFORMER
# TRANSFORMER_BEGIN SQLiteSorter,7,Workflows,8e9aa901-02b7-4ea7-bcde-dd2de8d86825,"Linked by Default",No,NO_PARALLELISM,,No,18310,YES,No,2or3
# <p>An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.</p>
# <p>For issues or questions, please Create an issue <a href="https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues">here</a>.  For the source, including test driver components, please see the <a href="https://modgeosys.assembla.com/spaces/fme-components/subversion/source">Assembla repository</a>.  For a list of planned improvements, see <a href="https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues">here</a>.</p>
# <p>Copyright &copy; 2017-2018 by Modern geoSystems, released under <a href="https://modgeosys.assembla.com/spaces/fme-components/subversion/source/HEAD/LICENSE?_format=raw">this BSD 3-clause license</a>.</p>
# TRANSFORMER_END
#!   ATTR_TYPE_ENCODING="SDF"
#!   BLOCKED_LOOPING="No"
#!   CATEGORY="Workflows"
#!   DESCRIPTION="&lt;p&gt;An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.&lt;/p&gt;&#10;&lt;p&gt;For issues or questions, please Create an issue &lt;a href=&quot;https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues&quot;&gt;here&lt;/a&gt;.  For the source, including test driver components, please see the &lt;a href=&quot;https://modgeosys.assembla.com/spaces/fme-components/subversion/source&quot;&gt;Assembla repository&lt;/a&gt;.  For a list of planned improvements, see &lt;a href=&quot;https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;&#10;&lt;p&gt;Copyright &amp;copy; 2017-2018 by Modern geoSystems, released under &lt;a href=&quot;https://modgeosys.assembla.com/spaces/fme-components/subversion/source/HEAD/LICENSE?_format=raw&quot;&gt;this BSD 3-clause license&lt;/a&gt;.&lt;/p&gt;"
#!   DOC_EXTENTS="3903 371.003"
#!   DOC_TOP_LEFT="-600 -68"
#!   EXPLICIT_BOOKMARK_ORDER="false"
#!   FME_BUILD_NUM="18310"
#!   FME_DOCUMENT_GUID="8e9aa901-02b7-4ea7-bcde-dd2de8d86825"
#!   FME_DOCUMENT_PRIORGUID="a7b7be2d-643e-4594-bb2e-1239d376ee38,3a6532c7-9cc0-486f-a3dc-4aee91f6b249,41c35503-2365-4f5d-9079-8a6d194a93f3"
#!   FME_LINKED_TRANSFORMER_VERSION="7"
#!   FME_PROCESS_COUNT="NO_PARALLELISM"
#!   FME_PROCESS_GROUPS_ORDERED="No"
#!   FME_PROCESS_GROUP_BY=""
#!   FME_SERVER_SERVICES=""
#!   FMX_ATTRIBUTE_PROPOGATION_MODE="AUTO"
#!   FMX_INSERT_MODE="Linked by Default"
#!   HISTORY="2017-11-26,Kevin&lt;space&gt;Weller,Initial&lt;space&gt;publication&lt;semicolon&gt;&lt;space&gt;test&lt;space&gt;workspace&lt;space&gt;fails&lt;space&gt;due&lt;space&gt;to&lt;space&gt;FME&lt;space&gt;Hub&lt;space&gt;version&lt;space&gt;delay.,2017-11-30,Kevin&lt;space&gt;Weller,Enhance&lt;space&gt;stack&lt;space&gt;trace&lt;space&gt;reporting&lt;semicolon&gt;&lt;space&gt;use&lt;space&gt;truncated&lt;space&gt;test&lt;space&gt;data&lt;space&gt;and&lt;space&gt;universal&lt;space&gt;temp&lt;space&gt;directory.,2018-01-20,Kevin&lt;space&gt;Weller,Fix&lt;space&gt;absolute&lt;space&gt;parameter&lt;space&gt;name&lt;space&gt;references&lt;space&gt;from&lt;space&gt;PythonCaller&lt;space&gt;when&lt;space&gt;SQLiteServer&lt;space&gt;is&lt;space&gt;called&lt;space&gt;from&lt;space&gt;another&lt;space&gt;custom&lt;space&gt;transformer&lt;space&gt;rather&lt;space&gt;than&lt;space&gt;from&lt;space&gt;the&lt;space&gt;top-level&lt;space&gt;workspace.,2018-03-08,Kevin&lt;space&gt;Weller,Update&lt;space&gt;documentation&lt;space&gt;to&lt;space&gt;reflect&lt;space&gt;move&lt;space&gt;from&lt;space&gt;GitHub&lt;space&gt;to&lt;space&gt;Assembla&lt;space&gt;and&lt;space&gt;Atlassian.,2018-03-18,Kevin&lt;space&gt;Weller,Fix&lt;space&gt;Python&lt;space&gt;syntax&lt;space&gt;error&lt;semicolon&gt;&lt;space&gt;test&lt;space&gt;driver&lt;space&gt;failed&lt;space&gt;to&lt;space&gt;test&lt;space&gt;latest&lt;space&gt;version&lt;comma&gt;&lt;space&gt;so&lt;space&gt;it&lt;space&gt;looked&lt;space&gt;like&lt;space&gt;it&lt;space&gt;worked&lt;space&gt;10&lt;space&gt;days&lt;space&gt;ago&lt;comma&gt;&lt;space&gt;but&lt;space&gt;it&lt;space&gt;didn&lt;apos&gt;t.&lt;space&gt;&lt;amp&gt;*^*&lt;openparen&gt;^&lt;amp&gt;^&lt;openparen&gt;&lt;amp&gt;*!,2018-07-02,Kevin&lt;space&gt;Weller,Enhance&lt;space&gt;parameter&lt;space&gt;handling&lt;space&gt;to&lt;space&gt;allow&lt;space&gt;for&lt;space&gt;multiple&lt;space&gt;references&lt;space&gt;to&lt;space&gt;the&lt;space&gt;transformer&lt;space&gt;from&lt;space&gt;the&lt;space&gt;same&lt;space&gt;calling&lt;space&gt;workspace&lt;space&gt;or&lt;space&gt;transformer."
#!   ITERATION_COUNT_ATTR=""
#!   LAST_SAVE_BUILD="FME(R) 2018.0.1.0 (20180518 - Build 18310 - macosx)"
#!   LAST_SAVE_DATE="2018-07-23T12:16:32"
#!   MARKDOWN_DESCRIPTION="An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.&#10;&#10;For issues or questions, please Create an issue [here](https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues).  For the source, including test driver components, please see the [Assembla repository](https://modgeosys.assembla.com/spaces/fme-components/subversion/source).  For a list of planned improvements, see [here](https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues).&#10;&#10;Copyright &amp;copy; 2017-2018 by Modern geoSystems, released under [this BSD 3-clause license](https://modgeosys.assembla.com/spaces/fme-components/subversion/source/HEAD/LICENSE?_format=raw)."
#!   MARKDOWN_USAGE="### Ports&#10;&#10;#### Input&#10;Feed the features to be sorted here.  If the input features consist of a variety of different feature types, it would be wise to ensure the sort key fields are represented in all of them.&#10;&#10;#### Output&#10;The sorted features emerge here.&#10;&#10;### Parameters&#10;&#10;#### Sort_Keys&#10;A tab- or space-delimited table of the sort keys to be applied.  The first column contains the names of the fields to be sorted, in order of sort priority.  The second column contains the database field data type.  The third and last column specifies whether the field is to be sorted in `asc`ending or `desc`ending order, e.g.:  &#10;  &#10;   `kml_name&#9;varchar asc`&#10;&#10;   `kml_id  varchar desc`  &#10;"
#!   MAX_LOOP_ITERATIONS=""
#!   PASSWORD=""
#!   PYTHON_COMPATIBILITY="2or3"
#!   SHOW_ANNOTATIONS="true"
#!   SHOW_INFO_NODES="true"
#!   TITLE="SQLiteSorter"
#!   USAGE="&lt;h3&gt;Ports&lt;/h3&gt;&#10;&lt;h4&gt;Input&lt;/h4&gt;&#10;&lt;p&gt;Feed the features to be sorted here.  If the input features consist of a variety of different feature types, it would be wise to ensure the sort key fields are represented in all of them.&lt;/p&gt;&#10;&lt;h4&gt;Output&lt;/h4&gt;&#10;&lt;p&gt;The sorted features emerge here.&lt;/p&gt;&#10;&lt;h3&gt;Parameters&lt;/h3&gt;&#10;&lt;h4&gt;Sort_Keys&lt;/h4&gt;&#10;&lt;p&gt;A tab- or space-delimited table of the sort keys to be applied.  The first column contains the names of the fields to be sorted, in order of sort priority.  The second column contains the database field data type.  The third and last column specifies whether the field is to be sorted in &lt;code&gt;asc&lt;/code&gt;ending or &lt;code&gt;desc&lt;/code&gt;ending order, e.g.:  &lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;kml_name    varchar asc&lt;/code&gt;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;kml_id  varchar desc&lt;/code&gt;  &lt;/p&gt;"
#!   USE_MARKDOWN="YES"
#!   VIEW_POSITION="-660.007 456.005"
#!   WARN_INVALID_XFORM_PARAM="Yes"
#!   WORKSPACE_VERSION="1"
#!   XFORM_DEPRECATED="No"
#!   ZOOM_SCALE="100"
#! >
#! <DATASETS>
#! </DATASETS>
#! <DATA_TYPES>
#! </DATA_TYPES>
#! <GEOM_TYPES>
#! </GEOM_TYPES>
#! <FEATURE_TYPES>
#! </FEATURE_TYPES>
#! <FMESERVER>
#! </FMESERVER>
#! <GLOBAL_PARAMETERS>
#! <GLOBAL_PARAMETER
#!   GUI_LINE="GUI TEXT_EDIT_OR_ATTR Sort_Keys &quot; &quot; Sort Keys:"
#!   DEFAULT_VALUE=""
#!   IS_STAND_ALONE="true"
#! />
#! </GLOBAL_PARAMETERS>
#! <COMMENTS>
#! <COMMENT
#!   IDENTIFIER="7"
#!   COMMENT_VALUE="&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0//EN&quot; &quot;http://www.w3.org/TR/REC-html40/strict.dtd&quot;&gt;&#10;&lt;html&gt;&lt;head&gt;&lt;meta name=&quot;qrichtext&quot; content=&quot;1&quot; /&gt;&lt;style type=&quot;text/css&quot;&gt;&#10;p, li { white-space: pre-wrap; }&#10;&lt;/style&gt;&lt;/head&gt;&lt;body style=&quot; font-family:&apos;helvetica neue&apos;; font-size:13pt; font-weight:400; font-style:normal;&quot;&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;This is much easier in&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;Python than with FME&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;transformers.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;"
#!   POSITION="2552.9985299853006 303.0000300003"
#!   TOP_LEFT="2552.9985299853006 303.0000300003"
#!   BOTTOM_RIGHT="2551.9985299853006 304.0000300003"
#!   BOUNDING_RECT="2552.9985299853006 303.0000300003 -1 -1"
#!   ORDER="500000000000000"
#!   FOLLOW_ANCHOR="true"
#!   INFO_NODE="false"
#!   COLOUR="1,1,0.78431372549019607,0.19215686274509805"
#!   SIZE_POLICY="8"
#!   ANCHORED_NODE="4"
#! />
#! </COMMENTS>
#! <CONSTANTS>
#! </CONSTANTS>
#! <BOOKMARKS>
#! </BOOKMARKS>
#! <TRANSFORMERS>
#! <TRANSFORMER
#!   IDENTIFIER="4"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="2552.9985299853006 3.0000300003000007"
#!   BOUNDING_RECT="2552.9985299853006 3.0000300003000007 516.04700000000003 71"
#!   ORDER="500000000000000"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_keys" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fmeobjects&lt;lf&gt;&lt;lf&gt;import&lt;space&gt;os&lt;lf&gt;import&lt;space&gt;os.path&lt;lf&gt;import&lt;space&gt;re&lt;lf&gt;import&lt;space&gt;csv&lt;lf&gt;import&lt;space&gt;sys&lt;lf&gt;if&lt;space&gt;sys.version_info&lt;space&gt;&lt;gt&gt;&lt;space&gt;&lt;openparen&gt;3&lt;comma&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;buffer&lt;space&gt;=&lt;space&gt;memoryview&lt;lf&gt;import&lt;space&gt;random&lt;lf&gt;import&lt;space&gt;string&lt;lf&gt;import&lt;space&gt;traceback&lt;lf&gt;import&lt;space&gt;inspect&lt;lf&gt;&lt;lf&gt;import&lt;space&gt;sqlite3&lt;lf&gt;import&lt;space&gt;logging&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Random&lt;space&gt;String&lt;space&gt;Generators&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;random_string&lt;openparen&gt;size=24&lt;comma&gt;&lt;space&gt;characters=string.ascii_lowercase&lt;space&gt;+&lt;space&gt;string.digits&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;random.choice&lt;openparen&gt;characters&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;x&lt;space&gt;in&lt;space&gt;range&lt;openparen&gt;size&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;random_path&lt;openparen&gt;directory&lt;comma&gt;&lt;space&gt;prefix=&lt;quote&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;size=24&lt;comma&gt;&lt;space&gt;characters=string.ascii_lowercase&lt;space&gt;+&lt;space&gt;string.digits&lt;comma&gt;&lt;space&gt;suffix=&lt;quote&gt;&lt;quote&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;while&lt;space&gt;True:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;path&lt;space&gt;=&lt;space&gt;os.path.join&lt;openparen&gt;directory&lt;comma&gt;&lt;space&gt;prefix&lt;space&gt;+&lt;space&gt;random_string&lt;openparen&gt;size&lt;comma&gt;&lt;space&gt;characters&lt;closeparen&gt;&lt;space&gt;+&lt;space&gt;suffix&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;fd&lt;space&gt;=&lt;space&gt;os.open&lt;openparen&gt;path&lt;comma&gt;&lt;space&gt;os.O_RDONLY&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.close&lt;openparen&gt;fd&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;continue&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;OSError:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;break&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;path&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Text&lt;space&gt;Interpretation&lt;lf&gt;&lt;lf&gt;FME_TAG_CODE_TRANSLATIONS&lt;space&gt;=&lt;space&gt;&lt;opencurly&gt;&lt;apos&gt;lf&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;div.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;br.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;p.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;cr&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;r&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;space&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;tab&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;t&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;comma&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;solidus&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;solidus&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;apos&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;openparen&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;openparen&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closeparen&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;closeparen&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;openbracket&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;openbracket&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closebracket&lt;apos&gt;:&lt;space&gt;&lt;apos&gt;&lt;closebracket&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;opencurly&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;opencurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closecurly&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;closecurly&gt;&lt;apos&gt;&lt;closecurly&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;interpret_fme_character_tags&lt;openparen&gt;raw_text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;raw_text&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;fme_tag_code&lt;space&gt;in&lt;space&gt;FME_TAG_CODE_TRANSLATIONS.keys&lt;openparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;&lt;apos&gt;&lt;lt&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;fme_tag_code&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;FME_TAG_CODE_TRANSLATIONS&lt;openbracket&gt;fme_tag_code&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;result&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;result&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;sanitize_text&lt;openparen&gt;raw_text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Replace&lt;space&gt;FME&lt;space&gt;tags&lt;comma&gt;&lt;space&gt;HTML&lt;space&gt;tags&lt;space&gt;or&lt;space&gt;SQL&lt;space&gt;meta-characters&lt;space&gt;with&lt;space&gt;clean&lt;space&gt;and&lt;space&gt;safe&lt;space&gt;equivalents.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;interpret_fme_character_tags&lt;openparen&gt;raw_text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;quote&gt;&lt;apos&gt;&lt;openbracket&gt;&lt;closeparen&gt;&lt;backslash&gt;&lt;quote&gt;&lt;semicolon&gt;!=&lt;closebracket&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;SQL&lt;space&gt;metacharacters.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;lt&gt;.+?&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;all&lt;space&gt;HTML&lt;space&gt;tags.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;^&lt;gt&gt;&lt;openbracket&gt;&lt;backslash&gt;t&lt;space&gt;&lt;closebracket&gt;*&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;email&lt;space&gt;quoting&lt;space&gt;prefixes.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;result&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;extract_dict_from_tab_delimited_data&lt;openparen&gt;text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;rows&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;openbracket&gt;&lt;space&gt;&lt;backslash&gt;t&lt;closebracket&gt;+&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;&lt;backslash&gt;t&lt;quote&gt;&lt;comma&gt;&lt;space&gt;text&lt;closeparen&gt;.splitlines&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Replace&lt;space&gt;repeated&lt;space&gt;delimiter&lt;space&gt;characters&lt;space&gt;by&lt;space&gt;a&lt;space&gt;single&lt;space&gt;tab&lt;space&gt;to&lt;space&gt;simplify&lt;space&gt;extraction.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;&lt;openbracket&gt;row&lt;space&gt;for&lt;space&gt;row&lt;space&gt;in&lt;space&gt;csv.DictReader&lt;openparen&gt;rows&lt;comma&gt;&lt;space&gt;&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;type&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;ordinality&lt;apos&gt;&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;None&lt;comma&gt;&lt;space&gt;None&lt;comma&gt;&lt;space&gt;&lt;apos&gt;excel-tab&lt;apos&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Logging&lt;space&gt;Support&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FMELogFormatter&lt;openparen&gt;logging.Formatter&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;arg&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;super&lt;openparen&gt;FMELogFormatter&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.arg&lt;space&gt;=&lt;space&gt;arg&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FMELogHandler&lt;openparen&gt;logging.Handler&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;emit&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;record&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Emit&lt;space&gt;a&lt;space&gt;log&lt;space&gt;record.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger&lt;space&gt;=&lt;space&gt;fmeobjects.FMELogFile&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger.logMessageString&lt;openparen&gt;record.getMessage&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;getFMELogger&lt;openparen&gt;name&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Get&lt;space&gt;an&lt;space&gt;FME&lt;space&gt;logger.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger&lt;space&gt;=&lt;space&gt;logging.getLogger&lt;openparen&gt;name&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;formatter&lt;space&gt;=&lt;space&gt;logging.Formatter&lt;openparen&gt;&lt;quote&gt;%&lt;openparen&gt;asctime&lt;closeparen&gt;s&lt;space&gt;%&lt;openparen&gt;levelname&lt;closeparen&gt;s:&lt;space&gt;%&lt;openparen&gt;message&lt;closeparen&gt;s&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;handler&lt;space&gt;=&lt;space&gt;FMELogHandler&lt;openparen&gt;level=&lt;quote&gt;INFO&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;handler.setFormatter&lt;openparen&gt;formatter&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger.addHandler&lt;openparen&gt;handler&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;logger&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Exception&lt;solidus&gt;Error&lt;space&gt;Classes&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;MGSError&lt;openparen&gt;Exception&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;class&lt;space&gt;for&lt;space&gt;exceptions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;message&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;super&lt;openparen&gt;MGSError&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;message&lt;closeparen&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;type&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Error&lt;space&gt;type&lt;space&gt;string.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;Error&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;instructions&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Post-message&lt;space&gt;instructions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;MGSSystemError&lt;openparen&gt;MGSError&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;message&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;super&lt;openparen&gt;MGSSystemError&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;message&lt;closeparen&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;type&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Error&lt;space&gt;type&lt;space&gt;string.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;instructions&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Post-message&lt;space&gt;instructions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;FME&lt;space&gt;Template&lt;space&gt;Class&lt;space&gt;Interface&lt;lf&gt;&lt;lf&gt;TEMP&lt;space&gt;=&lt;space&gt;&lt;apos&gt;FME_SHAREDRESOURCE_TEMP&lt;apos&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Load&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;into&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;sqlite_sort_record_number&lt;apos&gt;&lt;closeparen&gt;&lt;space&gt;==&lt;space&gt;1:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;temporary&lt;space&gt;SQLite&lt;space&gt;database&lt;space&gt;and&lt;space&gt;feature&lt;space&gt;table.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db&lt;space&gt;=&lt;space&gt;None&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;keys&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;sqlite_sort_keys&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Configure&lt;space&gt;database&lt;space&gt;file&lt;space&gt;path&lt;space&gt;and&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;name.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db_path&lt;space&gt;=&lt;space&gt;random_path&lt;openparen&gt;directory=FME_MacroValues&lt;openbracket&gt;TEMP&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;prefix=&lt;apos&gt;SQLiteSorter_&lt;apos&gt;&lt;comma&gt;&lt;space&gt;suffix=&lt;apos&gt;.sqlite&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.table_name&lt;space&gt;=&lt;space&gt;&lt;apos&gt;features&lt;apos&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;SQL&lt;space&gt;DDF&lt;space&gt;key&lt;space&gt;column&lt;space&gt;definitions&lt;space&gt;from&lt;space&gt;the&lt;space&gt;Sort_Keys&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.keys&lt;space&gt;=&lt;space&gt;extract_dict_from_tab_delimited_data&lt;openparen&gt;sanitize_text&lt;openparen&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;lt&gt;apos&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;&lt;apos&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;keys&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;column_defs&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;openparen&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;type&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;temporary&lt;space&gt;database&lt;space&gt;and&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;with&lt;space&gt;a&lt;space&gt;BLOB&lt;space&gt;to&lt;space&gt;contain&lt;space&gt;the&lt;space&gt;serialized&lt;space&gt;feature.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db&lt;space&gt;=&lt;space&gt;sqlite3.connect&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.text_factory&lt;space&gt;=&lt;space&gt;str&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor&lt;space&gt;=&lt;space&gt;self.db.execute&lt;openparen&gt;&lt;quote&gt;create&lt;space&gt;table&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;column_defs&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;feature&lt;space&gt;BLOB&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;create&lt;space&gt;index&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;quote&gt;_index&lt;space&gt;on&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;asc&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;Exception&lt;space&gt;as&lt;space&gt;e:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;open&lt;space&gt;SQLite&lt;space&gt;database&lt;space&gt;&lt;quote&gt;%s&lt;quote&gt;&lt;space&gt;to&lt;space&gt;sort&lt;space&gt;records:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.db_path&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;hasattr&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;&lt;apos&gt;db&lt;apos&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Construct&lt;space&gt;insertion&lt;space&gt;statement&lt;space&gt;elements.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;key_names&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;key_placeholders&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;apos&gt;?&lt;apos&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;all_values&lt;space&gt;=&lt;space&gt;&lt;openbracket&gt;self.get_feature_attribute&lt;openparen&gt;feature&lt;comma&gt;&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;openbracket&gt;buffer&lt;openparen&gt;self.serialize_feature&lt;openparen&gt;feature&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Insert&lt;space&gt;the&lt;space&gt;feature&lt;space&gt;record&lt;space&gt;into&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;insert&lt;space&gt;into&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key_names&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;&lt;space&gt;values&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key_placeholders&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;?&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;all_values&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;store&lt;space&gt;records&lt;space&gt;in&lt;space&gt;SQLite&lt;space&gt;for&lt;space&gt;sorting:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Read&lt;space&gt;all&lt;space&gt;stored&lt;space&gt;features&lt;space&gt;from&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;in&lt;space&gt;the&lt;space&gt;requested&lt;space&gt;order.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;hasattr&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;&lt;apos&gt;db&lt;apos&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.commit&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Construct&lt;space&gt;the&lt;space&gt;ORDER&lt;space&gt;BY&lt;space&gt;clause.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;sort_defs&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;openparen&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;ordinality&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Execute&lt;space&gt;the&lt;space&gt;query&lt;space&gt;and&lt;space&gt;output&lt;space&gt;the&lt;space&gt;features&lt;space&gt;in&lt;space&gt;sorted&lt;space&gt;order&lt;comma&gt;&lt;space&gt;reconstructing&lt;space&gt;them&lt;space&gt;from&lt;space&gt;the&lt;space&gt;serialized&lt;space&gt;copy&lt;space&gt;in&lt;space&gt;the&lt;space&gt;temporary&lt;space&gt;table.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;feature_record&lt;space&gt;in&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;select&lt;space&gt;feature&lt;space&gt;from&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;order&lt;space&gt;by&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;sort_defs&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.output_feature_from_blob&lt;openparen&gt;feature_record&lt;openbracket&gt;0&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;sort&lt;space&gt;records&lt;space&gt;via&lt;space&gt;SQLite:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Don&lt;apos&gt;t&lt;space&gt;leave&lt;space&gt;temporary&lt;space&gt;resource&lt;space&gt;files&lt;space&gt;behind.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;output_feature_from_blob&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;blob&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature&lt;space&gt;=&lt;space&gt;self.deserialize_feature&lt;openparen&gt;blob&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.output_feature&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;deserialize_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;blob&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.deserialize&lt;openparen&gt;bytearray&lt;openparen&gt;blob&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;output_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;get_feature_attribute&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;comma&gt;&lt;space&gt;feature_name&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature.getAttribute&lt;openparen&gt;feature_name&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;serialize_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature.serialize&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="SQLiteSortPythonCaller"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="8"
#!   TYPE="Counter"
#!   VERSION="2"
#!   POSITION="150 0"
#!   BOUNDING_RECT="150 0 -1 -1"
#!   ORDER="500000000000001"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="fme_rejection_code" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="CNT_ATTR" PARM_VALUE="sqlite_sort_record_number"/>
#!     <XFORM_PARM PARM_NAME="DOMAIN" PARM_VALUE="sqlite_sort_counter"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SCOPE" PARM_VALUE="Local"/>
#!     <XFORM_PARM PARM_NAME="START" PARM_VALUE="1"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Counter"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="11"
#!   TYPE="ParameterFetcher"
#!   VERSION="4"
#!   POSITION="1803.0000300002998 303.00303003030029"
#!   BOUNDING_RECT="1803.0000300002998 303.00303003030029 -1 -1"
#!   ORDER="500000000000002"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_keys" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ATTR_LIST" PARM_VALUE="sqlite_sort_keys $(Sort_Keys)"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ParameterFetcher"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="14"
#!   TYPE="Sampler"
#!   VERSION="4"
#!   POSITION="906.009060090601 -3.0000300002999438"
#!   BOUNDING_RECT="906.009060090601 -3.0000300002999438 -1 -1"
#!   ORDER="500000000000003"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="SAMPLED"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="NOT_SAMPLED"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="RATE" PARM_VALUE="1"/>
#!     <XFORM_PARM PARM_NAME="SAMPLE_MODE" PARM_VALUE="No"/>
#!     <XFORM_PARM PARM_NAME="SAMPLE_TYPE_LONG" PARM_VALUE="First N Features"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Sampler"/>
#! </TRANSFORMER>
#! </TRANSFORMERS>
#! <SUBDOCUMENT_IOS>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="2"
#!   NAME="Input"
#!   POSITION="-600 0"
#!   BOUNDING_RECT="-600 0 -1 -1"
#!   COLLAPSED="true"
#!   PUBLISHED="true"
#!   IS_SOURCE="true"
#!   ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="3"
#!   NAME="Sorted"
#!   POSITION="3302.9985299853006 3.0000300003000007"
#!   BOUNDING_RECT="3302.9985299853006 3.0000300003000007 -1 -1"
#!   COLLAPSED="true"
#!   IS_SOURCE="false"
#!   ATTR_MODE="1"
#! >
#! </SUBDOCUMENT_IO>
#! </SUBDOCUMENT_IOS>
#! <FEAT_LINKS>
#! <FEAT_LINK
#!   IDENTIFIER="21"
#!   SOURCE_NODE="2"
#!   TARGET_NODE="8"
#!   SOURCE_PORT_DESC="0"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="6"
#!   SOURCE_NODE="4"
#!   TARGET_NODE="3"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="0"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="15"
#!   SOURCE_NODE="8"
#!   TARGET_NODE="14"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="13"
#!   SOURCE_NODE="11"
#!   TARGET_NODE="4"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="16"
#!   SOURCE_NODE="14"
#!   TARGET_NODE="11"
#!   SOURCE_PORT_DESC="fo 0 SAMPLED"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="17"
#!   SOURCE_NODE="14"
#!   TARGET_NODE="4"
#!   SOURCE_PORT_DESC="fo 1 NOT_SAMPLED"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! </FEAT_LINKS>
#! <BREAKPOINTS>
#! </BREAKPOINTS>
#! <ATTR_LINKS>
#! </ATTR_LINKS>
#! <SUBDOCUMENTS>
#! </SUBDOCUMENTS>
#! <LOOKUP_TABLES>
#! </LOOKUP_TABLES>
#! </TRANSFORMER>
FME_PYTHON_VERSION 2or3
DEFAULT_MACRO $(SQLiteSorter_WORKSPACE_NAME)_Sort_Keys 
#! START_HEADER
#! END_HEADER

LOG_TIMINGS YES
LOG_FILTER_MASK -1
DEFAULT_MACRO WB_CURRENT_CONTEXT
DEFAULT_MACRO SQLiteSorter_WORKSPACE_NAME ""
INCLUDE [puts {MACRO WB_OLD_CONTEXT_$(SQLiteSorter_WORKSPACE_NAME) $(WB_CURRENT_CONTEXT)};          puts {MACRO WB_CURRENT_CONTEXT $(SQLiteSorter_WORKSPACE_NAME)}]
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Input1532369792 Input Splitter"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"   OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"
# -------------------------------------------------------------------------

# Create the DomainName that this transformer will use.
# Because @Count itself will evalute the expression to calculate the
# domain, we don't need to do anything in Tcl per feature going by

INCLUDE [    set domainPrefix {};    if { {Local} == {Local} }    {       set domainPrefix [FME_EncodeText {$(SQLiteSorter_WORKSPACE_NAME)_Counter_}];    };    puts "MACRO $(SQLiteSorter_WORKSPACE_NAME)_Counter_FULL_DOMAIN ${domainPrefix}sqlite_sort_counter"; ]
FACTORY_DEF * ExecuteFunctionFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Counter_Rejector    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"    FUNCTION_DEFINITION @Count(REJECTABLE_WITH_FLAG,fme_encoded,$($(SQLiteSorter_WORKSPACE_NAME)_Counter_FULL_DOMAIN),"1")    RESULT_ATTRIBUTE "sqlite_sort_record_number"    OUTPUT COMPLETE FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_OUTPUT"    OUTPUT REJECTED FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_<REJECTED>"

FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Counter <REJECTED> Transformer Output Nuker"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_<REJECTED>"
# -------------------------------------------------------------------------

# If we're doing LAST N features, then the multiplier comes in as 0.
# If we're doing First N, multiplier is -1.
# For RANDOM, we need to treat LAST N as if it was first N (i.e. have a -1)
# That is what the ? : does in the rate multiplier.

INCLUDE [ if { {-1} == {0} && {ORIGINAL} == {ORIGINAL} } {              puts "MACRO REAL_MODE LAST"; 	         puts "MACRO REAL_RATE 1"; 	      } else {              puts "MACRO REAL_MODE ORIGINAL";              puts "MACRO REAL_RATE [expr 1 * ( -1 ? -1 : -1 ) ]"; 	      } ]
FACTORY_DEF {*} SamplingFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Sampler    COMMAND_PARM_EVALUATION SINGLE_PASS    SAMPLE_RATE $(REAL_RATE)    SAMPLE_ORDER $(REAL_MODE)    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_OUTPUT"    OUTPUT SAMPLED FEATURE_TYPE ___SAMPLED___    OUTPUT NOT_SAMPLED FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_NOT_SAMPLED"
# This TeeFactory is needed because Sampler will still output features if it has no OUTPUT clauses specified.
# This way we behave nicely even if there are no output connections on the transformer. See PR#28886.

FACTORY_DEF * TeeFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Sampler_Sampled    INPUT FEATURE_TYPE ___SAMPLED___    OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_SAMPLED"


# -------------------------------------------------------------------------

Tcl2 proc $(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_doFetch {} {    foreach {name val} {"sqlite_sort_keys {$($(SQLiteSorter_WORKSPACE_NAME)_Sort_Keys)}"} {         if { [string match {*<at>*} $val] == 1 } {             set val [FME_Execute EvaluateExpression {STRING} $val {$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher}];         } elseif {[string match {*FME_CONDITIONAL*} $val] == 1} {             set val [FME_Execute EvaluateExpression {STRING} $val {$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher}];         } else {             set val [FME_DecodeTextOrAttr $val];         };       FME_SetAttribute [FME_DecodeText $name] $val    } }
FACTORY_DEF * TeeFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_SAMPLED"    OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_OUTPUT"         @Tcl2($(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_doFetch)

# -------------------------------------------------------------------------


FME_PYTHON_PATH "$(FME_MF_DIR)"

FACTORY_DEF * PythonFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_OUTPUT"    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_NOT_SAMPLED"    SYMBOL_NAME FeatureProcessor    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE import<space>fmeobjects<lf><lf>import<space>os<lf>import<space>os.path<lf>import<space>re<lf>import<space>csv<lf>import<space>sys<lf>if<space>sys.version_info<space><gt><space><openparen>3<comma><closeparen>:<lf><space><space><space><space>buffer<space>=<space>memoryview<lf>import<space>random<lf>import<space>string<lf>import<space>traceback<lf>import<space>inspect<lf><lf>import<space>sqlite3<lf>import<space>logging<lf><lf><lf><lf>#<space>Random<space>String<space>Generators<lf><lf>def<space>random_string<openparen>size=24<comma><space>characters=string.ascii_lowercase<space>+<space>string.digits<closeparen>:<lf><space><space><space><space>return<space><apos><apos>.join<openparen>random.choice<openparen>characters<closeparen><space>for<space>x<space>in<space>range<openparen>size<closeparen><closeparen><lf><lf><lf>def<space>random_path<openparen>directory<comma><space>prefix=<quote><quote><comma><space>size=24<comma><space>characters=string.ascii_lowercase<space>+<space>string.digits<comma><space>suffix=<quote><quote><closeparen>:<lf><space><space><space><space>while<space>True:<lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>path<space>=<space>os.path.join<openparen>directory<comma><space>prefix<space>+<space>random_string<openparen>size<comma><space>characters<closeparen><space>+<space>suffix<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>fd<space>=<space>os.open<openparen>path<comma><space>os.O_RDONLY<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>os.close<openparen>fd<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>continue<lf><space><space><space><space><space><space><space><space>except<space>OSError:<lf><space><space><space><space><space><space><space><space><space><space><space><space>break<lf><space><space><space><space>return<space>path<lf><lf><lf><lf>#<space>Text<space>Interpretation<lf><lf>FME_TAG_CODE_TRANSLATIONS<space>=<space><opencurly><apos>lf<apos>:<space><space><space><space><space><space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>div.*?<apos>:<space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>br.*?<apos>:<space><space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>p.*?<apos>:<space><space><space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>cr<apos>:<space><space><space><space><space><space><space><space><space><space><space><apos><backslash>r<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>space<apos>:<space><space><space><space><space><space><space><space><apos><space><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>tab<apos>:<space><space><space><space><space><space><space><space><space><space><apos><backslash>t<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>comma<apos>:<space><space><space><space><space><space><space><space><apos><comma><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>solidus<apos>:<space><space><space><space><space><space><apos><solidus><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>apos<apos>:<space><space><space><space><space><space><space><space><space><apos><comma><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>openparen<apos>:<space><space><space><space><apos><openparen><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closeparen<apos>:<space><space><space><apos><closeparen><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>openbracket<apos>:<space><space><apos><openbracket><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closebracket<apos>:<space><apos><closebracket><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>opencurly<apos>:<space><space><space><space><apos><opencurly><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closecurly<apos>:<space><space><space><apos><closecurly><apos><closecurly><lf><lf>def<space>interpret_fme_character_tags<openparen>raw_text<closeparen>:<lf><space><space><space><space>result<space>=<space>raw_text<lf><space><space><space><space>for<space>fme_tag_code<space>in<space>FME_TAG_CODE_TRANSLATIONS.keys<openparen><closeparen>:<lf><space><space><space><space><space><space><space><space>result<space>=<space>re.sub<openparen><apos><lt><apos><space>+<space>fme_tag_code<space>+<space><apos><gt><apos><comma><space>FME_TAG_CODE_TRANSLATIONS<openbracket>fme_tag_code<closebracket><comma><space>result<closeparen><lf><space><space><space><space>return<space>result<lf><lf>def<space>sanitize_text<openparen>raw_text<closeparen>:<lf><space><space><space><space><quote><quote><quote>Replace<space>FME<space>tags<comma><space>HTML<space>tags<space>or<space>SQL<space>meta-characters<space>with<space>clean<space>and<space>safe<space>equivalents.<quote><quote><quote><lf><space><space><space><space>result<space>=<space>interpret_fme_character_tags<openparen>raw_text<closeparen><lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<quote><apos><openbracket><closeparen><backslash><quote><semicolon>!=<closebracket><quote><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space>#<space>Sanitize<space>SQL<space>metacharacters.<lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<apos><lt>.+?<gt><apos><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space><space><space><space><space>#<space>Sanitize<space>all<space>HTML<space>tags.<lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<apos>^<gt><openbracket><backslash>t<space><closebracket>*<apos><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space><space>#<space>Sanitize<space>email<space>quoting<space>prefixes.<lf><space><space><space><space>return<space>result<lf><lf>def<space>extract_dict_from_tab_delimited_data<openparen>text<closeparen>:<lf><space><space><space><space>rows<space>=<space>re.sub<openparen>r<apos><openbracket><space><backslash>t<closebracket>+<apos><comma><space><quote><backslash>t<quote><comma><space>text<closeparen>.splitlines<openparen><closeparen><space><space>#<space>Replace<space>repeated<space>delimiter<space>characters<space>by<space>a<space>single<space>tab<space>to<space>simplify<space>extraction.<lf><space><space><space><space>return<space><openbracket>row<space>for<space>row<space>in<space>csv.DictReader<openparen>rows<comma><space><openbracket><apos>name<apos><comma><space><apos>type<apos><comma><space><apos>ordinality<apos><closebracket><comma><space>None<comma><space>None<comma><space><apos>excel-tab<apos><closeparen><closebracket><lf><lf><lf><lf>#<space>Logging<space>Support<lf><lf>class<space>FMELogFormatter<openparen>logging.Formatter<closeparen>:<lf><space><space><space><space>def<space>__init__<openparen>self<comma><space>arg<closeparen>:<lf><space><space><space><space><space><space><space><space>super<openparen>FMELogFormatter<comma><space>self<closeparen>.__init__<openparen><closeparen><lf><space><space><space><space><space><space><space><space>self.arg<space>=<space>arg<lf><lf><lf>class<space>FMELogHandler<openparen>logging.Handler<closeparen>:<lf><space><space><space><space>def<space>emit<openparen>self<comma><space>record<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Emit<space>a<space>log<space>record.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>logger<space>=<space>fmeobjects.FMELogFile<openparen><closeparen><lf><space><space><space><space><space><space><space><space>logger.logMessageString<openparen>record.getMessage<openparen><closeparen><closeparen><lf><lf>def<space>getFMELogger<openparen>name<closeparen>:<lf><space><space><space><space><quote><quote><quote>Get<space>an<space>FME<space>logger.<quote><quote><quote><lf><space><space><space><space>logger<space>=<space>logging.getLogger<openparen>name<closeparen><lf><space><space><space><space>formatter<space>=<space>logging.Formatter<openparen><quote>%<openparen>asctime<closeparen>s<space>%<openparen>levelname<closeparen>s:<space>%<openparen>message<closeparen>s<quote><closeparen><lf><space><space><space><space>handler<space>=<space>FMELogHandler<openparen>level=<quote>INFO<quote><closeparen><lf><space><space><space><space>handler.setFormatter<openparen>formatter<closeparen><lf><space><space><space><space>logger.addHandler<openparen>handler<closeparen><lf><space><space><space><space>return<space>logger<lf><lf><lf><lf>#<space>Exception<solidus>Error<space>Classes<lf><lf>class<space>MGSError<openparen>Exception<closeparen>:<lf><tab><quote><quote><quote>Base<space>class<space>for<space>exceptions.<quote><quote><quote><lf><tab><lf><tab>def<space>__init__<openparen>self<comma><space>message<closeparen>:<lf><tab><tab>super<openparen>MGSError<comma><space>self<closeparen>.__init__<openparen>message<closeparen><lf><tab><lf><tab>def<space>type<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Error<space>type<space>string.<quote><quote><quote><lf><tab><tab>return<space><quote>Error<quote><lf><tab><lf><tab>def<space>instructions<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Post-message<space>instructions.<quote><quote><quote><lf><tab><tab>return<space><quote><quote><quote>Please<space>try<space>again.<quote><quote><quote><lf><lf>class<space>MGSSystemError<openparen>MGSError<closeparen>:<lf><tab><lf><tab>def<space>__init__<openparen>self<comma><space>message<closeparen>:<lf><tab><tab>super<openparen>MGSSystemError<comma><space>self<closeparen>.__init__<openparen>message<closeparen><lf><tab><lf><tab>def<space>type<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Error<space>type<space>string.<quote><quote><quote><lf><tab><tab>return<space><quote>Unexpected<space>System<space>Error<quote><lf><tab><lf><tab>def<space>instructions<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Post-message<space>instructions.<quote><quote><quote><lf><tab><tab>return<space><quote><quote><quote>Please<space>try<space>again.<quote><quote><quote><lf><lf><lf><lf>#<space>FME<space>Template<space>Class<space>Interface<lf><lf>TEMP<space>=<space><apos>FME_SHAREDRESOURCE_TEMP<apos><lf><lf>class<space>FeatureProcessor:<lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Load<space>a<space>feature<space>into<space>the<space>sort<space>table.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>feature.getAttribute<openparen><apos>sqlite_sort_record_number<apos><closeparen><space>==<space>1:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>temporary<space>SQLite<space>database<space>and<space>feature<space>table.<quote><quote><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db<space>=<space>None<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>keys<space>=<space>feature.getAttribute<openparen><apos>sqlite_sort_keys<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Configure<space>database<space>file<space>path<space>and<space>sort<space>table<space>name.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db_path<space>=<space>random_path<openparen>directory=FME_MacroValues<openbracket>TEMP<closebracket><comma><space>prefix=<apos>SQLiteSorter_<apos><comma><space>suffix=<apos>.sqlite<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.table_name<space>=<space><apos>features<apos><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>SQL<space>DDF<space>key<space>column<space>definitions<space>from<space>the<space>Sort_Keys<space>parameter.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.keys<space>=<space>extract_dict_from_tab_delimited_data<openparen>sanitize_text<openparen>re.sub<openparen>r<apos><lt>apos<gt><apos><comma><space><quote><apos><quote><comma><space>keys<closeparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>column_defs<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><openparen>key<openbracket><apos>name<apos><closebracket><space>+<space><apos><space><apos><space>+<space>key<openbracket><apos>type<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>temporary<space>database<space>and<space>sort<space>table<space>with<space>a<space>BLOB<space>to<space>contain<space>the<space>serialized<space>feature.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db<space>=<space>sqlite3.connect<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.text_factory<space>=<space>str<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor<space>=<space>self.db.execute<openparen><quote>create<space>table<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>column_defs<space>+<space><quote><comma><space>feature<space>BLOB<closeparen><semicolon><quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>for<space>key<space>in<space>self.keys:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.execute<openparen><quote>create<space>index<space><quote><space>+<space>key<openbracket><apos>name<apos><closebracket><space>+<space><quote>_index<space>on<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>key<openbracket><apos>name<apos><closebracket><space>+<space><quote><space>asc<closeparen><semicolon><quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>except<space>Exception<space>as<space>e:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>open<space>SQLite<space>database<space><quote>%s<quote><space>to<space>sort<space>records:<space>%s<backslash>n%s<apos><comma><space>self.db_path<comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>if<space>hasattr<openparen>self<comma><space><apos>db<apos><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Construct<space>insertion<space>statement<space>elements.<lf><space><space><space><space><space><space><space><space><space><space><space><space>key_names<space>=<space><apos><comma><space><apos>.join<openparen><openbracket>key<openbracket><apos>name<apos><closebracket><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>key_placeholders<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><apos>?<apos><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>all_values<space>=<space><openbracket>self.get_feature_attribute<openparen>feature<comma><space>key<openbracket><apos>name<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><space>+<space><openbracket>buffer<openparen>self.serialize_feature<openparen>feature<closeparen><closeparen><closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Insert<space>the<space>feature<space>record<space>into<space>the<space>sort<space>table.<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.execute<openparen><quote>insert<space>into<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>key_names<space>+<space><quote><comma><space>feature<closeparen><space>values<space><openparen><quote><space>+<space>key_placeholders<space>+<space><quote><comma><space>?<closeparen><semicolon><quote><comma><space>all_values<closeparen><lf><space><space><space><space><space><space><space><space>except:<lf><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>store<space>records<space>in<space>SQLite<space>for<space>sorting:<space>%s<backslash>n%s<apos><comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Read<space>all<space>stored<space>features<space>from<space>the<space>sort<space>table<space>in<space>the<space>requested<space>order.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>hasattr<openparen>self<comma><space><apos>db<apos><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.commit<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Construct<space>the<space>ORDER<space>BY<space>clause.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>sort_defs<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><openparen>key<openbracket><apos>name<apos><closebracket><space>+<space><apos><space><apos><space>+<space>key<openbracket><apos>ordinality<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Execute<space>the<space>query<space>and<space>output<space>the<space>features<space>in<space>sorted<space>order<comma><space>reconstructing<space>them<space>from<space>the<space>serialized<space>copy<space>in<space>the<space>temporary<space>table.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>for<space>feature_record<space>in<space>self.cursor.execute<openparen><quote>select<space>feature<space>from<space><quote><space>+<space>self.table_name<space>+<space><quote><space>order<space>by<space><quote><space>+<space>sort_defs<space>+<space><quote><semicolon><quote><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.output_feature_from_blob<openparen>feature_record<openbracket>0<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>except:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>sort<space>records<space>via<space>SQLite:<space>%s<backslash>n%s<apos><comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Don<apos>t<space>leave<space>temporary<space>resource<space>files<space>behind.<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><lf><space><space><space><space>def<space>output_feature_from_blob<openparen>self<comma><space>blob<closeparen>:<lf><space><space><space><space><space><space><space><space>feature<space>=<space>self.deserialize_feature<openparen>blob<closeparen><lf><space><space><space><space><space><space><space><space>self.output_feature<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>deserialize_feature<openparen>self<comma><space>blob<closeparen>:<lf><space><space><space><space><space><space><space><space>feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space>feature.deserialize<openparen>bytearray<openparen>blob<closeparen><closeparen><lf><space><space><space><space><space><space><space><space>return<space>feature<lf><lf><space><space><space><space>def<space>output_feature<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>get_feature_attribute<openparen>self<comma><space>feature<comma><space>feature_name<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space>feature.getAttribute<openparen>feature_name<closeparen><lf><lf><space><space><space><space>def<space>serialize_feature<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space>feature.serialize<openparen><closeparen><lf>    OUTPUT PYOUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller_OUTPUT"

FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Sorted1532369792 Output Collector"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller_OUTPUT"   OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sorted" @RemoveAttributes(sqlite_sort_record_number,sqlite_sort_keys)
INCLUDE [puts {MACRO WB_CURRENT_CONTEXT $(WB_OLD_CONTEXT_$(SQLiteSorter_WORKSPACE_NAME))}]
#! <?xml version="1.0" encoding="UTF-8" ?>
#! <TRANSFORMER
# TRANSFORMER_BEGIN SQLiteSorter,6,Workflows,f06f1401-4ead-4942-a50f-2893829efd89,"Linked by Default",No,NO_PARALLELISM,,No,18310,YES,No,2or3
# <p>An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.</p>
# <p>For issues or questions, please Create an issue <a href="https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues">here</a>.  For the source, including test driver components, please see the <a href="https://modgeosys.assembla.com/spaces/fme-components/subversion/source">Assembla repository</a>.  For a list of planned improvements, see <a href="https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues">here</a>.</p>
# <p>Copyright &copy; 2017-2018 by Modern geoSystems, released under <a href="https://modgeosys.assembla.com/spaces/fme-components/subversion/source/HEAD/LICENSE?_format=raw">this BSD 3-clause license</a>.</p>
# TRANSFORMER_END
#!   ATTR_TYPE_ENCODING="SDF"
#!   BLOCKED_LOOPING="No"
#!   CATEGORY="Workflows"
#!   DESCRIPTION="&lt;p&gt;An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.&lt;/p&gt;&#10;&lt;p&gt;For issues or questions, please Create an issue &lt;a href=&quot;https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues&quot;&gt;here&lt;/a&gt;.  For the source, including test driver components, please see the &lt;a href=&quot;https://modgeosys.assembla.com/spaces/fme-components/subversion/source&quot;&gt;Assembla repository&lt;/a&gt;.  For a list of planned improvements, see &lt;a href=&quot;https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;&#10;&lt;p&gt;Copyright &amp;copy; 2017-2018 by Modern geoSystems, released under &lt;a href=&quot;https://modgeosys.assembla.com/spaces/fme-components/subversion/source/HEAD/LICENSE?_format=raw&quot;&gt;this BSD 3-clause license&lt;/a&gt;.&lt;/p&gt;"
#!   DOC_EXTENTS="3903 371.003"
#!   DOC_TOP_LEFT="-600 -68"
#!   EXPLICIT_BOOKMARK_ORDER="false"
#!   FME_BUILD_NUM="18310"
#!   FME_DOCUMENT_GUID="f06f1401-4ead-4942-a50f-2893829efd89"
#!   FME_DOCUMENT_PRIORGUID="587e9f16-43db-4b41-82e5-c29a7e113206,c5fe596c-37c9-4f6b-b1df-637e32e54ebf,5c793aa5-b45a-47f4-a23c-be0159fd0f3b,711281bc-12b7-4eb4-b43b-4672e10511f1,96af4bbe-2242-44e4-827d-38c0f018cc0a,a6a8c89e-c97b-4ac3-953d-fc2f3c941281"
#!   FME_LINKED_TRANSFORMER_VERSION="6"
#!   FME_PROCESS_COUNT="NO_PARALLELISM"
#!   FME_PROCESS_GROUPS_ORDERED="No"
#!   FME_PROCESS_GROUP_BY=""
#!   FME_SERVER_SERVICES=""
#!   FMX_ATTRIBUTE_PROPOGATION_MODE="AUTO"
#!   FMX_INSERT_MODE="Linked by Default"
#!   HISTORY="2017-11-26,Kevin&lt;space&gt;Weller,Initial&lt;space&gt;publication&lt;semicolon&gt;&lt;space&gt;test&lt;space&gt;workspace&lt;space&gt;fails&lt;space&gt;due&lt;space&gt;to&lt;space&gt;FME&lt;space&gt;Hub&lt;space&gt;version&lt;space&gt;delay.,2017-11-30,Kevin&lt;space&gt;Weller,Enhance&lt;space&gt;stack&lt;space&gt;trace&lt;space&gt;reporting&lt;semicolon&gt;&lt;space&gt;use&lt;space&gt;truncated&lt;space&gt;test&lt;space&gt;data&lt;space&gt;and&lt;space&gt;universal&lt;space&gt;temp&lt;space&gt;directory.,2018-01-20,Kevin&lt;space&gt;Weller,Fix&lt;space&gt;absolute&lt;space&gt;parameter&lt;space&gt;name&lt;space&gt;references&lt;space&gt;from&lt;space&gt;PythonCaller&lt;space&gt;when&lt;space&gt;SQLiteServer&lt;space&gt;is&lt;space&gt;called&lt;space&gt;from&lt;space&gt;another&lt;space&gt;custom&lt;space&gt;transformer&lt;space&gt;rather&lt;space&gt;than&lt;space&gt;from&lt;space&gt;the&lt;space&gt;top-level&lt;space&gt;workspace.,2018-03-08,Kevin&lt;space&gt;Weller,Update&lt;space&gt;documentation&lt;space&gt;to&lt;space&gt;reflect&lt;space&gt;move&lt;space&gt;from&lt;space&gt;GitHub&lt;space&gt;to&lt;space&gt;Assembla&lt;space&gt;and&lt;space&gt;Atlassian.,2018-03-18,Kevin&lt;space&gt;Weller,Fix&lt;space&gt;Python&lt;space&gt;syntax&lt;space&gt;error&lt;semicolon&gt;&lt;space&gt;test&lt;space&gt;driver&lt;space&gt;failed&lt;space&gt;to&lt;space&gt;test&lt;space&gt;latest&lt;space&gt;version&lt;comma&gt;&lt;space&gt;so&lt;space&gt;it&lt;space&gt;looked&lt;space&gt;like&lt;space&gt;it&lt;space&gt;worked&lt;space&gt;10&lt;space&gt;days&lt;space&gt;ago&lt;comma&gt;&lt;space&gt;but&lt;space&gt;it&lt;space&gt;didn&lt;apos&gt;t.&lt;space&gt;&lt;amp&gt;*^*&lt;openparen&gt;^&lt;amp&gt;^&lt;openparen&gt;&lt;amp&gt;*!,2018-07-02,Kevin&lt;space&gt;Weller,Enhance&lt;space&gt;parameter&lt;space&gt;handling&lt;space&gt;to&lt;space&gt;allow&lt;space&gt;for&lt;space&gt;multiple&lt;space&gt;references&lt;space&gt;to&lt;space&gt;the&lt;space&gt;transformer&lt;space&gt;from&lt;space&gt;the&lt;space&gt;same&lt;space&gt;calling&lt;space&gt;workspace&lt;space&gt;or&lt;space&gt;transformer."
#!   ITERATION_COUNT_ATTR=""
#!   LAST_SAVE_BUILD="FME(R) 2018.0.1.0 (20180518 - Build 18310 - macosx)"
#!   LAST_SAVE_DATE="2018-07-12T12:46:04"
#!   MARKDOWN_DESCRIPTION="An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.&#10;&#10;For issues or questions, please Create an issue [here](https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues).  For the source, including test driver components, please see the [Assembla repository](https://modgeosys.assembla.com/spaces/fme-components/subversion/source).  For a list of planned improvements, see [here](https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues).&#10;&#10;Copyright &amp;copy; 2017-2018 by Modern geoSystems, released under [this BSD 3-clause license](https://modgeosys.assembla.com/spaces/fme-components/subversion/source/HEAD/LICENSE?_format=raw)."
#!   MARKDOWN_USAGE="### Ports&#10;&#10;#### Input&#10;Feed the features to be sorted here.  If the input features consist of a variety of different feature types, it would be wise to ensure the sort key fields are represented in all of them.&#10;&#10;#### Output&#10;The sorted features emerge here.&#10;&#10;### Parameters&#10;&#10;#### Sort_Keys&#10;A tab- or space-delimited table of the sort keys to be applied.  The first column contains the names of the fields to be sorted, in order of sort priority.  The second column contains the database field data type.  The third and last column specifies whether the field is to be sorted in `asc`ending or `desc`ending order, e.g.:  &#10;  &#10;   `kml_name&#9;varchar asc`  &#10;    `kml_id  varchar desc`  &#10;"
#!   MAX_LOOP_ITERATIONS=""
#!   PASSWORD=""
#!   PYTHON_COMPATIBILITY="2or3"
#!   SHOW_ANNOTATIONS="true"
#!   SHOW_INFO_NODES="true"
#!   TITLE="SQLiteSorter"
#!   USAGE="&lt;h3&gt;Ports&lt;/h3&gt;&#10;&lt;h4&gt;Input&lt;/h4&gt;&#10;&lt;p&gt;Feed the features to be sorted here.  If the input features consist of a variety of different feature types, it would be wise to ensure the sort key fields are represented in all of them.&lt;/p&gt;&#10;&lt;h4&gt;Output&lt;/h4&gt;&#10;&lt;p&gt;The sorted features emerge here.&lt;/p&gt;&#10;&lt;h3&gt;Parameters&lt;/h3&gt;&#10;&lt;h4&gt;Sort_Keys&lt;/h4&gt;&#10;&lt;p&gt;A tab- or space-delimited table of the sort keys to be applied.  The first column contains the names of the fields to be sorted, in order of sort priority.  The second column contains the database field data type.  The third and last column specifies whether the field is to be sorted in &lt;code&gt;asc&lt;/code&gt;ending or &lt;code&gt;desc&lt;/code&gt;ending order, e.g.:  &lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;kml_name    varchar asc&lt;/code&gt;&lt;br /&gt;&#10;&lt;code&gt;kml_id  varchar desc&lt;/code&gt;  &lt;/p&gt;"
#!   USE_MARKDOWN="YES"
#!   VIEW_POSITION="-672.007 456.005"
#!   WARN_INVALID_XFORM_PARAM="Yes"
#!   WORKSPACE_VERSION="1"
#!   XFORM_DEPRECATED="No"
#!   ZOOM_SCALE="100"
#! >
#! <DATASETS>
#! </DATASETS>
#! <DATA_TYPES>
#! </DATA_TYPES>
#! <GEOM_TYPES>
#! </GEOM_TYPES>
#! <FEATURE_TYPES>
#! </FEATURE_TYPES>
#! <FMESERVER>
#! </FMESERVER>
#! <GLOBAL_PARAMETERS>
#! <GLOBAL_PARAMETER
#!   GUI_LINE="GUI TEXT_EDIT_OR_ATTR Sort_Keys &quot; &quot; Sort Keys:"
#!   DEFAULT_VALUE=""
#!   IS_STAND_ALONE="true"
#! />
#! </GLOBAL_PARAMETERS>
#! <COMMENTS>
#! <COMMENT
#!   IDENTIFIER="7"
#!   COMMENT_VALUE="&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0//EN&quot; &quot;http://www.w3.org/TR/REC-html40/strict.dtd&quot;&gt;&#10;&lt;html&gt;&lt;head&gt;&lt;meta name=&quot;qrichtext&quot; content=&quot;1&quot; /&gt;&lt;style type=&quot;text/css&quot;&gt;&#10;p, li { white-space: pre-wrap; }&#10;&lt;/style&gt;&lt;/head&gt;&lt;body style=&quot; font-family:&apos;helvetica neue&apos;; font-size:13pt; font-weight:400; font-style:normal;&quot;&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;This is much easier in&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;Python than with FME&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;transformers.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;"
#!   POSITION="2552.9985299853006 303.0000300003"
#!   TOP_LEFT="2552.9985299853006 303.0000300003"
#!   BOTTOM_RIGHT="2551.9985299853006 304.0000300003"
#!   BOUNDING_RECT="2552.9985299853006 303.0000300003 -1 -1"
#!   ORDER="500000000000000"
#!   FOLLOW_ANCHOR="true"
#!   INFO_NODE="false"
#!   COLOUR="1,1,0.78431372549019607,0.19215686274509805"
#!   SIZE_POLICY="8"
#!   ANCHORED_NODE="4"
#! />
#! </COMMENTS>
#! <CONSTANTS>
#! </CONSTANTS>
#! <BOOKMARKS>
#! </BOOKMARKS>
#! <TRANSFORMERS>
#! <TRANSFORMER
#!   IDENTIFIER="4"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="2552.9985299853006 3.0000300003000007"
#!   BOUNDING_RECT="2552.9985299853006 3.0000300003000007 516.04700000000003 71"
#!   ORDER="500000000000000"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_keys" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fmeobjects&lt;lf&gt;&lt;lf&gt;import&lt;space&gt;os&lt;lf&gt;import&lt;space&gt;os.path&lt;lf&gt;import&lt;space&gt;re&lt;lf&gt;import&lt;space&gt;csv&lt;lf&gt;import&lt;space&gt;sys&lt;lf&gt;if&lt;space&gt;sys.version_info&lt;space&gt;&lt;gt&gt;&lt;space&gt;&lt;openparen&gt;3&lt;comma&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;buffer&lt;space&gt;=&lt;space&gt;memoryview&lt;lf&gt;import&lt;space&gt;random&lt;lf&gt;import&lt;space&gt;string&lt;lf&gt;import&lt;space&gt;traceback&lt;lf&gt;import&lt;space&gt;inspect&lt;lf&gt;&lt;lf&gt;import&lt;space&gt;sqlite3&lt;lf&gt;import&lt;space&gt;logging&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Random&lt;space&gt;String&lt;space&gt;Generators&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;random_string&lt;openparen&gt;size=24&lt;comma&gt;&lt;space&gt;characters=string.ascii_lowercase&lt;space&gt;+&lt;space&gt;string.digits&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;random.choice&lt;openparen&gt;characters&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;x&lt;space&gt;in&lt;space&gt;range&lt;openparen&gt;size&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;random_path&lt;openparen&gt;directory&lt;comma&gt;&lt;space&gt;prefix=&lt;quote&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;size=24&lt;comma&gt;&lt;space&gt;characters=string.ascii_lowercase&lt;space&gt;+&lt;space&gt;string.digits&lt;comma&gt;&lt;space&gt;suffix=&lt;quote&gt;&lt;quote&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;while&lt;space&gt;True:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;path&lt;space&gt;=&lt;space&gt;os.path.join&lt;openparen&gt;directory&lt;comma&gt;&lt;space&gt;prefix&lt;space&gt;+&lt;space&gt;random_string&lt;openparen&gt;size&lt;comma&gt;&lt;space&gt;characters&lt;closeparen&gt;&lt;space&gt;+&lt;space&gt;suffix&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;fd&lt;space&gt;=&lt;space&gt;os.open&lt;openparen&gt;path&lt;comma&gt;&lt;space&gt;os.O_RDONLY&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.close&lt;openparen&gt;fd&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;continue&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;OSError:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;break&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;path&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Text&lt;space&gt;Interpretation&lt;lf&gt;&lt;lf&gt;FME_TAG_CODE_TRANSLATIONS&lt;space&gt;=&lt;space&gt;&lt;opencurly&gt;&lt;apos&gt;lf&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;div.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;br.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;p.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;cr&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;r&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;space&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;tab&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;t&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;comma&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;solidus&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;solidus&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;apos&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;openparen&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;openparen&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closeparen&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;closeparen&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;openbracket&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;openbracket&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closebracket&lt;apos&gt;:&lt;space&gt;&lt;apos&gt;&lt;closebracket&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;opencurly&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;opencurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closecurly&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;closecurly&gt;&lt;apos&gt;&lt;closecurly&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;interpret_fme_character_tags&lt;openparen&gt;raw_text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;raw_text&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;fme_tag_code&lt;space&gt;in&lt;space&gt;FME_TAG_CODE_TRANSLATIONS.keys&lt;openparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;&lt;apos&gt;&lt;lt&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;fme_tag_code&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;FME_TAG_CODE_TRANSLATIONS&lt;openbracket&gt;fme_tag_code&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;result&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;result&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;sanitize_text&lt;openparen&gt;raw_text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Replace&lt;space&gt;FME&lt;space&gt;tags&lt;comma&gt;&lt;space&gt;HTML&lt;space&gt;tags&lt;space&gt;or&lt;space&gt;SQL&lt;space&gt;meta-characters&lt;space&gt;with&lt;space&gt;clean&lt;space&gt;and&lt;space&gt;safe&lt;space&gt;equivalents.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;interpret_fme_character_tags&lt;openparen&gt;raw_text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;quote&gt;&lt;apos&gt;&lt;openbracket&gt;&lt;closeparen&gt;&lt;backslash&gt;&lt;quote&gt;&lt;semicolon&gt;!=&lt;closebracket&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;SQL&lt;space&gt;metacharacters.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;lt&gt;.+?&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;all&lt;space&gt;HTML&lt;space&gt;tags.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;^&lt;gt&gt;&lt;openbracket&gt;&lt;backslash&gt;t&lt;space&gt;&lt;closebracket&gt;*&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;email&lt;space&gt;quoting&lt;space&gt;prefixes.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;result&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;extract_dict_from_tab_delimited_data&lt;openparen&gt;text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;rows&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;openbracket&gt;&lt;space&gt;&lt;backslash&gt;t&lt;closebracket&gt;+&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;&lt;backslash&gt;t&lt;quote&gt;&lt;comma&gt;&lt;space&gt;text&lt;closeparen&gt;.splitlines&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Replace&lt;space&gt;repeated&lt;space&gt;delimiter&lt;space&gt;characters&lt;space&gt;by&lt;space&gt;a&lt;space&gt;single&lt;space&gt;tab&lt;space&gt;to&lt;space&gt;simplify&lt;space&gt;extraction.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;&lt;openbracket&gt;row&lt;space&gt;for&lt;space&gt;row&lt;space&gt;in&lt;space&gt;csv.DictReader&lt;openparen&gt;rows&lt;comma&gt;&lt;space&gt;&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;type&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;ordinality&lt;apos&gt;&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;None&lt;comma&gt;&lt;space&gt;None&lt;comma&gt;&lt;space&gt;&lt;apos&gt;excel-tab&lt;apos&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Logging&lt;space&gt;Support&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FMELogFormatter&lt;openparen&gt;logging.Formatter&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;arg&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;super&lt;openparen&gt;FMELogFormatter&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.arg&lt;space&gt;=&lt;space&gt;arg&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FMELogHandler&lt;openparen&gt;logging.Handler&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;emit&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;record&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Emit&lt;space&gt;a&lt;space&gt;log&lt;space&gt;record.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger&lt;space&gt;=&lt;space&gt;fmeobjects.FMELogFile&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger.logMessageString&lt;openparen&gt;record.getMessage&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;getFMELogger&lt;openparen&gt;name&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Get&lt;space&gt;an&lt;space&gt;FME&lt;space&gt;logger.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger&lt;space&gt;=&lt;space&gt;logging.getLogger&lt;openparen&gt;name&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;formatter&lt;space&gt;=&lt;space&gt;logging.Formatter&lt;openparen&gt;&lt;quote&gt;%&lt;openparen&gt;asctime&lt;closeparen&gt;s&lt;space&gt;%&lt;openparen&gt;levelname&lt;closeparen&gt;s:&lt;space&gt;%&lt;openparen&gt;message&lt;closeparen&gt;s&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;handler&lt;space&gt;=&lt;space&gt;FMELogHandler&lt;openparen&gt;level=&lt;quote&gt;INFO&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;handler.setFormatter&lt;openparen&gt;formatter&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger.addHandler&lt;openparen&gt;handler&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;logger&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Exception&lt;solidus&gt;Error&lt;space&gt;Classes&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;MGSError&lt;openparen&gt;Exception&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;class&lt;space&gt;for&lt;space&gt;exceptions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;message&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;super&lt;openparen&gt;MGSError&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;message&lt;closeparen&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;type&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Error&lt;space&gt;type&lt;space&gt;string.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;Error&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;instructions&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Post-message&lt;space&gt;instructions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;MGSSystemError&lt;openparen&gt;MGSError&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;message&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;super&lt;openparen&gt;MGSSystemError&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;message&lt;closeparen&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;type&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Error&lt;space&gt;type&lt;space&gt;string.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;instructions&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Post-message&lt;space&gt;instructions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;FME&lt;space&gt;Template&lt;space&gt;Class&lt;space&gt;Interface&lt;lf&gt;&lt;lf&gt;TEMP&lt;space&gt;=&lt;space&gt;&lt;apos&gt;FME_SHAREDRESOURCE_TEMP&lt;apos&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Load&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;into&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;sqlite_sort_record_number&lt;apos&gt;&lt;closeparen&gt;&lt;space&gt;==&lt;space&gt;1:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;temporary&lt;space&gt;SQLite&lt;space&gt;database&lt;space&gt;and&lt;space&gt;feature&lt;space&gt;table.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db&lt;space&gt;=&lt;space&gt;None&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;keys&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;sqlite_sort_keys&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Configure&lt;space&gt;database&lt;space&gt;file&lt;space&gt;path&lt;space&gt;and&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;name.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db_path&lt;space&gt;=&lt;space&gt;random_path&lt;openparen&gt;directory=FME_MacroValues&lt;openbracket&gt;TEMP&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;prefix=&lt;apos&gt;SQLiteSorter_&lt;apos&gt;&lt;comma&gt;&lt;space&gt;suffix=&lt;apos&gt;.sqlite&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.table_name&lt;space&gt;=&lt;space&gt;&lt;apos&gt;features&lt;apos&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;SQL&lt;space&gt;DDF&lt;space&gt;key&lt;space&gt;column&lt;space&gt;definitions&lt;space&gt;from&lt;space&gt;the&lt;space&gt;Sort_Keys&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.keys&lt;space&gt;=&lt;space&gt;extract_dict_from_tab_delimited_data&lt;openparen&gt;sanitize_text&lt;openparen&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;lt&gt;apos&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;&lt;apos&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;keys&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;column_defs&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;openparen&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;type&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;temporary&lt;space&gt;database&lt;space&gt;and&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;with&lt;space&gt;a&lt;space&gt;BLOB&lt;space&gt;to&lt;space&gt;contain&lt;space&gt;the&lt;space&gt;serialized&lt;space&gt;feature.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db&lt;space&gt;=&lt;space&gt;sqlite3.connect&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.text_factory&lt;space&gt;=&lt;space&gt;str&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor&lt;space&gt;=&lt;space&gt;self.db.execute&lt;openparen&gt;&lt;quote&gt;create&lt;space&gt;table&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;column_defs&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;feature&lt;space&gt;BLOB&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;create&lt;space&gt;index&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;quote&gt;_index&lt;space&gt;on&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;asc&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;Exception&lt;space&gt;as&lt;space&gt;e:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;open&lt;space&gt;SQLite&lt;space&gt;database&lt;space&gt;&lt;quote&gt;%s&lt;quote&gt;&lt;space&gt;to&lt;space&gt;sort&lt;space&gt;records:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.db_path&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;hasattr&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;&lt;apos&gt;db&lt;apos&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Construct&lt;space&gt;insertion&lt;space&gt;statement&lt;space&gt;elements.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;key_names&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;key_placeholders&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;apos&gt;?&lt;apos&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;all_values&lt;space&gt;=&lt;space&gt;&lt;openbracket&gt;self.get_feature_attribute&lt;openparen&gt;feature&lt;comma&gt;&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;openbracket&gt;buffer&lt;openparen&gt;self.serialize_feature&lt;openparen&gt;feature&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Insert&lt;space&gt;the&lt;space&gt;feature&lt;space&gt;record&lt;space&gt;into&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;insert&lt;space&gt;into&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key_names&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;&lt;space&gt;values&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key_placeholders&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;?&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;all_values&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;store&lt;space&gt;records&lt;space&gt;in&lt;space&gt;SQLite&lt;space&gt;for&lt;space&gt;sorting:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Read&lt;space&gt;all&lt;space&gt;stored&lt;space&gt;features&lt;space&gt;from&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;in&lt;space&gt;the&lt;space&gt;requested&lt;space&gt;order.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;hasattr&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;&lt;apos&gt;db&lt;apos&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.commit&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Construct&lt;space&gt;the&lt;space&gt;ORDER&lt;space&gt;BY&lt;space&gt;clause.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;sort_defs&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;openparen&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;ordinality&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Execute&lt;space&gt;the&lt;space&gt;query&lt;space&gt;and&lt;space&gt;output&lt;space&gt;the&lt;space&gt;features&lt;space&gt;in&lt;space&gt;sorted&lt;space&gt;order&lt;comma&gt;&lt;space&gt;reconstructing&lt;space&gt;them&lt;space&gt;from&lt;space&gt;the&lt;space&gt;serialized&lt;space&gt;copy&lt;space&gt;in&lt;space&gt;the&lt;space&gt;temporary&lt;space&gt;table.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;feature_record&lt;space&gt;in&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;select&lt;space&gt;feature&lt;space&gt;from&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;order&lt;space&gt;by&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;sort_defs&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.output_feature_from_blob&lt;openparen&gt;feature_record&lt;openbracket&gt;0&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;sort&lt;space&gt;records&lt;space&gt;via&lt;space&gt;SQLite:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Don&lt;apos&gt;t&lt;space&gt;leave&lt;space&gt;temporary&lt;space&gt;resource&lt;space&gt;files&lt;space&gt;behind.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;output_feature_from_blob&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;blob&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature&lt;space&gt;=&lt;space&gt;self.deserialize_feature&lt;openparen&gt;blob&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.output_feature&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;deserialize_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;blob&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.deserialize&lt;openparen&gt;bytearray&lt;openparen&gt;blob&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;output_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;get_feature_attribute&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;comma&gt;&lt;space&gt;feature_name&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature.getAttribute&lt;openparen&gt;feature_name&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;serialize_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature.serialize&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="SQLiteSortPythonCaller"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="8"
#!   TYPE="Counter"
#!   VERSION="2"
#!   POSITION="150 0"
#!   BOUNDING_RECT="150 0 -1 -1"
#!   ORDER="500000000000001"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="fme_rejection_code" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="CNT_ATTR" PARM_VALUE="sqlite_sort_record_number"/>
#!     <XFORM_PARM PARM_NAME="DOMAIN" PARM_VALUE="sqlite_sort_counter"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SCOPE" PARM_VALUE="Local"/>
#!     <XFORM_PARM PARM_NAME="START" PARM_VALUE="1"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Counter"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="11"
#!   TYPE="ParameterFetcher"
#!   VERSION="4"
#!   POSITION="1803.0000300002998 303.00303003030029"
#!   BOUNDING_RECT="1803.0000300002998 303.00303003030029 -1 -1"
#!   ORDER="500000000000002"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_keys" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ATTR_LIST" PARM_VALUE="sqlite_sort_keys $(Sort_Keys)"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ParameterFetcher"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="14"
#!   TYPE="Sampler"
#!   VERSION="4"
#!   POSITION="906.009060090601 -3.0000300002999438"
#!   BOUNDING_RECT="906.009060090601 -3.0000300002999438 -1 -1"
#!   ORDER="500000000000003"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="SAMPLED"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="NOT_SAMPLED"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="RATE" PARM_VALUE="1"/>
#!     <XFORM_PARM PARM_NAME="SAMPLE_MODE" PARM_VALUE="No"/>
#!     <XFORM_PARM PARM_NAME="SAMPLE_TYPE_LONG" PARM_VALUE="First N Features"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Sampler"/>
#! </TRANSFORMER>
#! </TRANSFORMERS>
#! <SUBDOCUMENT_IOS>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="2"
#!   NAME="Input"
#!   POSITION="-600 0"
#!   BOUNDING_RECT="-600 0 -1 -1"
#!   COLLAPSED="true"
#!   PUBLISHED="true"
#!   IS_SOURCE="true"
#!   ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="3"
#!   NAME="Sorted"
#!   POSITION="3302.9985299853006 3.0000300003000007"
#!   BOUNDING_RECT="3302.9985299853006 3.0000300003000007 -1 -1"
#!   COLLAPSED="true"
#!   IS_SOURCE="false"
#!   ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! </SUBDOCUMENT_IOS>
#! <FEAT_LINKS>
#! <FEAT_LINK
#!   IDENTIFIER="21"
#!   SOURCE_NODE="2"
#!   TARGET_NODE="8"
#!   SOURCE_PORT_DESC="0"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="6"
#!   SOURCE_NODE="4"
#!   TARGET_NODE="3"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="0"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="15"
#!   SOURCE_NODE="8"
#!   TARGET_NODE="14"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="13"
#!   SOURCE_NODE="11"
#!   TARGET_NODE="4"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="16"
#!   SOURCE_NODE="14"
#!   TARGET_NODE="11"
#!   SOURCE_PORT_DESC="fo 0 SAMPLED"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="17"
#!   SOURCE_NODE="14"
#!   TARGET_NODE="4"
#!   SOURCE_PORT_DESC="fo 1 NOT_SAMPLED"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! </FEAT_LINKS>
#! <BREAKPOINTS>
#! </BREAKPOINTS>
#! <ATTR_LINKS>
#! </ATTR_LINKS>
#! <SUBDOCUMENTS>
#! </SUBDOCUMENTS>
#! <LOOKUP_TABLES>
#! </LOOKUP_TABLES>
#! </TRANSFORMER>
FME_PYTHON_VERSION 2or3
DEFAULT_MACRO $(SQLiteSorter_WORKSPACE_NAME)_Sort_Keys 
#! START_HEADER
#! END_HEADER

LOG_TIMINGS YES
LOG_FILTER_MASK -1
DEFAULT_MACRO WB_CURRENT_CONTEXT
DEFAULT_MACRO SQLiteSorter_WORKSPACE_NAME ""
INCLUDE [puts {MACRO WB_OLD_CONTEXT_$(SQLiteSorter_WORKSPACE_NAME) $(WB_CURRENT_CONTEXT)};          puts {MACRO WB_CURRENT_CONTEXT $(SQLiteSorter_WORKSPACE_NAME)}]
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Input1531421164 Input Splitter"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"   OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"
# -------------------------------------------------------------------------

# Create the DomainName that this transformer will use.
# Because @Count itself will evalute the expression to calculate the
# domain, we don't need to do anything in Tcl per feature going by

INCLUDE [    set domainPrefix {};    if { {Local} == {Local} }    {       set domainPrefix [FME_EncodeText {$(SQLiteSorter_WORKSPACE_NAME)_Counter_}];    };    puts "MACRO $(SQLiteSorter_WORKSPACE_NAME)_Counter_FULL_DOMAIN ${domainPrefix}sqlite_sort_counter"; ]
FACTORY_DEF * ExecuteFunctionFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Counter_Rejector    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"    FUNCTION_DEFINITION @Count(REJECTABLE_WITH_FLAG,fme_encoded,$($(SQLiteSorter_WORKSPACE_NAME)_Counter_FULL_DOMAIN),"1")    RESULT_ATTRIBUTE "sqlite_sort_record_number"    OUTPUT COMPLETE FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_OUTPUT"    OUTPUT REJECTED FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_<REJECTED>"

FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Counter <REJECTED> Transformer Output Nuker"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_<REJECTED>"
# -------------------------------------------------------------------------

# If we're doing LAST N features, then the multiplier comes in as 0.
# If we're doing First N, multiplier is -1.
# For RANDOM, we need to treat LAST N as if it was first N (i.e. have a -1)
# That is what the ? : does in the rate multiplier.

INCLUDE [ if { {-1} == {0} && {ORIGINAL} == {ORIGINAL} } {              puts "MACRO REAL_MODE LAST"; 	         puts "MACRO REAL_RATE 1"; 	      } else {              puts "MACRO REAL_MODE ORIGINAL";              puts "MACRO REAL_RATE [expr 1 * ( -1 ? -1 : -1 ) ]"; 	      } ]
FACTORY_DEF {*} SamplingFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Sampler    COMMAND_PARM_EVALUATION SINGLE_PASS    SAMPLE_RATE $(REAL_RATE)    SAMPLE_ORDER $(REAL_MODE)    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_OUTPUT"    OUTPUT SAMPLED FEATURE_TYPE ___SAMPLED___    OUTPUT NOT_SAMPLED FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_NOT_SAMPLED"
# This TeeFactory is needed because Sampler will still output features if it has no OUTPUT clauses specified.
# This way we behave nicely even if there are no output connections on the transformer. See PR#28886.

FACTORY_DEF * TeeFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Sampler_Sampled    INPUT FEATURE_TYPE ___SAMPLED___    OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_SAMPLED"


# -------------------------------------------------------------------------

Tcl2 proc $(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_doFetch {} {    foreach {name val} {"sqlite_sort_keys {$($(SQLiteSorter_WORKSPACE_NAME)_Sort_Keys)}"} {         if { [string match {*<at>*} $val] == 1 } {             set val [FME_Execute EvaluateExpression {STRING} $val {$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher}];         } elseif {[string match {*FME_CONDITIONAL*} $val] == 1} {             set val [FME_Execute EvaluateExpression {STRING} $val {$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher}];         } else {             set val [FME_DecodeTextOrAttr $val];         };       FME_SetAttribute [FME_DecodeText $name] $val    } }
FACTORY_DEF * TeeFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_SAMPLED"    OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_OUTPUT"         @Tcl2($(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_doFetch)

# -------------------------------------------------------------------------


FME_PYTHON_PATH "$(FME_MF_DIR)"

FACTORY_DEF * PythonFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_OUTPUT"    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_NOT_SAMPLED"    SYMBOL_NAME FeatureProcessor    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE import<space>fmeobjects<lf><lf>import<space>os<lf>import<space>os.path<lf>import<space>re<lf>import<space>csv<lf>import<space>sys<lf>if<space>sys.version_info<space><gt><space><openparen>3<comma><closeparen>:<lf><space><space><space><space>buffer<space>=<space>memoryview<lf>import<space>random<lf>import<space>string<lf>import<space>traceback<lf>import<space>inspect<lf><lf>import<space>sqlite3<lf>import<space>logging<lf><lf><lf><lf>#<space>Random<space>String<space>Generators<lf><lf>def<space>random_string<openparen>size=24<comma><space>characters=string.ascii_lowercase<space>+<space>string.digits<closeparen>:<lf><space><space><space><space>return<space><apos><apos>.join<openparen>random.choice<openparen>characters<closeparen><space>for<space>x<space>in<space>range<openparen>size<closeparen><closeparen><lf><lf><lf>def<space>random_path<openparen>directory<comma><space>prefix=<quote><quote><comma><space>size=24<comma><space>characters=string.ascii_lowercase<space>+<space>string.digits<comma><space>suffix=<quote><quote><closeparen>:<lf><space><space><space><space>while<space>True:<lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>path<space>=<space>os.path.join<openparen>directory<comma><space>prefix<space>+<space>random_string<openparen>size<comma><space>characters<closeparen><space>+<space>suffix<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>fd<space>=<space>os.open<openparen>path<comma><space>os.O_RDONLY<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>os.close<openparen>fd<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>continue<lf><space><space><space><space><space><space><space><space>except<space>OSError:<lf><space><space><space><space><space><space><space><space><space><space><space><space>break<lf><space><space><space><space>return<space>path<lf><lf><lf><lf>#<space>Text<space>Interpretation<lf><lf>FME_TAG_CODE_TRANSLATIONS<space>=<space><opencurly><apos>lf<apos>:<space><space><space><space><space><space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>div.*?<apos>:<space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>br.*?<apos>:<space><space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>p.*?<apos>:<space><space><space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>cr<apos>:<space><space><space><space><space><space><space><space><space><space><space><apos><backslash>r<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>space<apos>:<space><space><space><space><space><space><space><space><apos><space><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>tab<apos>:<space><space><space><space><space><space><space><space><space><space><apos><backslash>t<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>comma<apos>:<space><space><space><space><space><space><space><space><apos><comma><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>solidus<apos>:<space><space><space><space><space><space><apos><solidus><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>apos<apos>:<space><space><space><space><space><space><space><space><space><apos><comma><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>openparen<apos>:<space><space><space><space><apos><openparen><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closeparen<apos>:<space><space><space><apos><closeparen><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>openbracket<apos>:<space><space><apos><openbracket><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closebracket<apos>:<space><apos><closebracket><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>opencurly<apos>:<space><space><space><space><apos><opencurly><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closecurly<apos>:<space><space><space><apos><closecurly><apos><closecurly><lf><lf>def<space>interpret_fme_character_tags<openparen>raw_text<closeparen>:<lf><space><space><space><space>result<space>=<space>raw_text<lf><space><space><space><space>for<space>fme_tag_code<space>in<space>FME_TAG_CODE_TRANSLATIONS.keys<openparen><closeparen>:<lf><space><space><space><space><space><space><space><space>result<space>=<space>re.sub<openparen><apos><lt><apos><space>+<space>fme_tag_code<space>+<space><apos><gt><apos><comma><space>FME_TAG_CODE_TRANSLATIONS<openbracket>fme_tag_code<closebracket><comma><space>result<closeparen><lf><space><space><space><space>return<space>result<lf><lf>def<space>sanitize_text<openparen>raw_text<closeparen>:<lf><space><space><space><space><quote><quote><quote>Replace<space>FME<space>tags<comma><space>HTML<space>tags<space>or<space>SQL<space>meta-characters<space>with<space>clean<space>and<space>safe<space>equivalents.<quote><quote><quote><lf><space><space><space><space>result<space>=<space>interpret_fme_character_tags<openparen>raw_text<closeparen><lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<quote><apos><openbracket><closeparen><backslash><quote><semicolon>!=<closebracket><quote><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space>#<space>Sanitize<space>SQL<space>metacharacters.<lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<apos><lt>.+?<gt><apos><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space><space><space><space><space>#<space>Sanitize<space>all<space>HTML<space>tags.<lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<apos>^<gt><openbracket><backslash>t<space><closebracket>*<apos><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space><space>#<space>Sanitize<space>email<space>quoting<space>prefixes.<lf><space><space><space><space>return<space>result<lf><lf>def<space>extract_dict_from_tab_delimited_data<openparen>text<closeparen>:<lf><space><space><space><space>rows<space>=<space>re.sub<openparen>r<apos><openbracket><space><backslash>t<closebracket>+<apos><comma><space><quote><backslash>t<quote><comma><space>text<closeparen>.splitlines<openparen><closeparen><space><space>#<space>Replace<space>repeated<space>delimiter<space>characters<space>by<space>a<space>single<space>tab<space>to<space>simplify<space>extraction.<lf><space><space><space><space>return<space><openbracket>row<space>for<space>row<space>in<space>csv.DictReader<openparen>rows<comma><space><openbracket><apos>name<apos><comma><space><apos>type<apos><comma><space><apos>ordinality<apos><closebracket><comma><space>None<comma><space>None<comma><space><apos>excel-tab<apos><closeparen><closebracket><lf><lf><lf><lf>#<space>Logging<space>Support<lf><lf>class<space>FMELogFormatter<openparen>logging.Formatter<closeparen>:<lf><space><space><space><space>def<space>__init__<openparen>self<comma><space>arg<closeparen>:<lf><space><space><space><space><space><space><space><space>super<openparen>FMELogFormatter<comma><space>self<closeparen>.__init__<openparen><closeparen><lf><space><space><space><space><space><space><space><space>self.arg<space>=<space>arg<lf><lf><lf>class<space>FMELogHandler<openparen>logging.Handler<closeparen>:<lf><space><space><space><space>def<space>emit<openparen>self<comma><space>record<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Emit<space>a<space>log<space>record.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>logger<space>=<space>fmeobjects.FMELogFile<openparen><closeparen><lf><space><space><space><space><space><space><space><space>logger.logMessageString<openparen>record.getMessage<openparen><closeparen><closeparen><lf><lf>def<space>getFMELogger<openparen>name<closeparen>:<lf><space><space><space><space><quote><quote><quote>Get<space>an<space>FME<space>logger.<quote><quote><quote><lf><space><space><space><space>logger<space>=<space>logging.getLogger<openparen>name<closeparen><lf><space><space><space><space>formatter<space>=<space>logging.Formatter<openparen><quote>%<openparen>asctime<closeparen>s<space>%<openparen>levelname<closeparen>s:<space>%<openparen>message<closeparen>s<quote><closeparen><lf><space><space><space><space>handler<space>=<space>FMELogHandler<openparen>level=<quote>INFO<quote><closeparen><lf><space><space><space><space>handler.setFormatter<openparen>formatter<closeparen><lf><space><space><space><space>logger.addHandler<openparen>handler<closeparen><lf><space><space><space><space>return<space>logger<lf><lf><lf><lf>#<space>Exception<solidus>Error<space>Classes<lf><lf>class<space>MGSError<openparen>Exception<closeparen>:<lf><tab><quote><quote><quote>Base<space>class<space>for<space>exceptions.<quote><quote><quote><lf><tab><lf><tab>def<space>__init__<openparen>self<comma><space>message<closeparen>:<lf><tab><tab>super<openparen>MGSError<comma><space>self<closeparen>.__init__<openparen>message<closeparen><lf><tab><lf><tab>def<space>type<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Error<space>type<space>string.<quote><quote><quote><lf><tab><tab>return<space><quote>Error<quote><lf><tab><lf><tab>def<space>instructions<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Post-message<space>instructions.<quote><quote><quote><lf><tab><tab>return<space><quote><quote><quote>Please<space>try<space>again.<quote><quote><quote><lf><lf>class<space>MGSSystemError<openparen>MGSError<closeparen>:<lf><tab><lf><tab>def<space>__init__<openparen>self<comma><space>message<closeparen>:<lf><tab><tab>super<openparen>MGSSystemError<comma><space>self<closeparen>.__init__<openparen>message<closeparen><lf><tab><lf><tab>def<space>type<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Error<space>type<space>string.<quote><quote><quote><lf><tab><tab>return<space><quote>Unexpected<space>System<space>Error<quote><lf><tab><lf><tab>def<space>instructions<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Post-message<space>instructions.<quote><quote><quote><lf><tab><tab>return<space><quote><quote><quote>Please<space>try<space>again.<quote><quote><quote><lf><lf><lf><lf>#<space>FME<space>Template<space>Class<space>Interface<lf><lf>TEMP<space>=<space><apos>FME_SHAREDRESOURCE_TEMP<apos><lf><lf>class<space>FeatureProcessor:<lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Load<space>a<space>feature<space>into<space>the<space>sort<space>table.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>feature.getAttribute<openparen><apos>sqlite_sort_record_number<apos><closeparen><space>==<space>1:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>temporary<space>SQLite<space>database<space>and<space>feature<space>table.<quote><quote><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db<space>=<space>None<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>keys<space>=<space>feature.getAttribute<openparen><apos>sqlite_sort_keys<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Configure<space>database<space>file<space>path<space>and<space>sort<space>table<space>name.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db_path<space>=<space>random_path<openparen>directory=FME_MacroValues<openbracket>TEMP<closebracket><comma><space>prefix=<apos>SQLiteSorter_<apos><comma><space>suffix=<apos>.sqlite<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.table_name<space>=<space><apos>features<apos><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>SQL<space>DDF<space>key<space>column<space>definitions<space>from<space>the<space>Sort_Keys<space>parameter.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.keys<space>=<space>extract_dict_from_tab_delimited_data<openparen>sanitize_text<openparen>re.sub<openparen>r<apos><lt>apos<gt><apos><comma><space><quote><apos><quote><comma><space>keys<closeparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>column_defs<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><openparen>key<openbracket><apos>name<apos><closebracket><space>+<space><apos><space><apos><space>+<space>key<openbracket><apos>type<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>temporary<space>database<space>and<space>sort<space>table<space>with<space>a<space>BLOB<space>to<space>contain<space>the<space>serialized<space>feature.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db<space>=<space>sqlite3.connect<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.text_factory<space>=<space>str<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor<space>=<space>self.db.execute<openparen><quote>create<space>table<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>column_defs<space>+<space><quote><comma><space>feature<space>BLOB<closeparen><semicolon><quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>for<space>key<space>in<space>self.keys:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.execute<openparen><quote>create<space>index<space><quote><space>+<space>key<openbracket><apos>name<apos><closebracket><space>+<space><quote>_index<space>on<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>key<openbracket><apos>name<apos><closebracket><space>+<space><quote><space>asc<closeparen><semicolon><quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>except<space>Exception<space>as<space>e:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>open<space>SQLite<space>database<space><quote>%s<quote><space>to<space>sort<space>records:<space>%s<backslash>n%s<apos><comma><space>self.db_path<comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>if<space>hasattr<openparen>self<comma><space><apos>db<apos><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Construct<space>insertion<space>statement<space>elements.<lf><space><space><space><space><space><space><space><space><space><space><space><space>key_names<space>=<space><apos><comma><space><apos>.join<openparen><openbracket>key<openbracket><apos>name<apos><closebracket><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>key_placeholders<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><apos>?<apos><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>all_values<space>=<space><openbracket>self.get_feature_attribute<openparen>feature<comma><space>key<openbracket><apos>name<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><space>+<space><openbracket>buffer<openparen>self.serialize_feature<openparen>feature<closeparen><closeparen><closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Insert<space>the<space>feature<space>record<space>into<space>the<space>sort<space>table.<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.execute<openparen><quote>insert<space>into<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>key_names<space>+<space><quote><comma><space>feature<closeparen><space>values<space><openparen><quote><space>+<space>key_placeholders<space>+<space><quote><comma><space>?<closeparen><semicolon><quote><comma><space>all_values<closeparen><lf><space><space><space><space><space><space><space><space>except:<lf><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>store<space>records<space>in<space>SQLite<space>for<space>sorting:<space>%s<backslash>n%s<apos><comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Read<space>all<space>stored<space>features<space>from<space>the<space>sort<space>table<space>in<space>the<space>requested<space>order.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>hasattr<openparen>self<comma><space><apos>db<apos><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.commit<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Construct<space>the<space>ORDER<space>BY<space>clause.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>sort_defs<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><openparen>key<openbracket><apos>name<apos><closebracket><space>+<space><apos><space><apos><space>+<space>key<openbracket><apos>ordinality<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Execute<space>the<space>query<space>and<space>output<space>the<space>features<space>in<space>sorted<space>order<comma><space>reconstructing<space>them<space>from<space>the<space>serialized<space>copy<space>in<space>the<space>temporary<space>table.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>for<space>feature_record<space>in<space>self.cursor.execute<openparen><quote>select<space>feature<space>from<space><quote><space>+<space>self.table_name<space>+<space><quote><space>order<space>by<space><quote><space>+<space>sort_defs<space>+<space><quote><semicolon><quote><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.output_feature_from_blob<openparen>feature_record<openbracket>0<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>except:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>sort<space>records<space>via<space>SQLite:<space>%s<backslash>n%s<apos><comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Don<apos>t<space>leave<space>temporary<space>resource<space>files<space>behind.<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><lf><space><space><space><space>def<space>output_feature_from_blob<openparen>self<comma><space>blob<closeparen>:<lf><space><space><space><space><space><space><space><space>feature<space>=<space>self.deserialize_feature<openparen>blob<closeparen><lf><space><space><space><space><space><space><space><space>self.output_feature<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>deserialize_feature<openparen>self<comma><space>blob<closeparen>:<lf><space><space><space><space><space><space><space><space>feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space>feature.deserialize<openparen>bytearray<openparen>blob<closeparen><closeparen><lf><space><space><space><space><space><space><space><space>return<space>feature<lf><lf><space><space><space><space>def<space>output_feature<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>get_feature_attribute<openparen>self<comma><space>feature<comma><space>feature_name<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space>feature.getAttribute<openparen>feature_name<closeparen><lf><lf><space><space><space><space>def<space>serialize_feature<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space>feature.serialize<openparen><closeparen><lf>    OUTPUT PYOUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller_OUTPUT"

FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Sorted1531421164 Output Collector"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller_OUTPUT"   OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sorted"
INCLUDE [puts {MACRO WB_CURRENT_CONTEXT $(WB_OLD_CONTEXT_$(SQLiteSorter_WORKSPACE_NAME))}]
#! <?xml version="1.0" encoding="UTF-8" ?>
#! <TRANSFORMER
# TRANSFORMER_BEGIN SQLiteSorter,5,Workflows,d1826dc4-c0ea-4136-87f1-e5095a302561,"Linked by Default",No,NO_PARALLELISM,,No,18310,YES,No,2or3
# <p>An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.</p>
# <p>For issues or questions, please Create an issue <a href="https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues">here</a>.  For the source, including test driver components, please see the <a href="https://modgeosys.assembla.com/spaces/fme-components/subversion/source">Assembla repository</a>.  For a list of planned improvements, see <a href="https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues">here</a>.</p>
# <p>Copyright &copy; 2017-2018 by Modern geoSystems, released under <a href="https://modgeosys.assembla.com/spaces/fme-components/subversion/source/HEAD/LICENSE?_format=raw">this BSD 3-clause license</a>.</p>
# TRANSFORMER_END
#!   ATTR_TYPE_ENCODING="SDF"
#!   BLOCKED_LOOPING="No"
#!   CATEGORY="Workflows"
#!   DESCRIPTION="&lt;p&gt;An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.&lt;/p&gt;&#10;&lt;p&gt;For issues or questions, please Create an issue &lt;a href=&quot;https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues&quot;&gt;here&lt;/a&gt;.  For the source, including test driver components, please see the &lt;a href=&quot;https://modgeosys.assembla.com/spaces/fme-components/subversion/source&quot;&gt;Assembla repository&lt;/a&gt;.  For a list of planned improvements, see &lt;a href=&quot;https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;&#10;&lt;p&gt;Copyright &amp;copy; 2017-2018 by Modern geoSystems, released under &lt;a href=&quot;https://modgeosys.assembla.com/spaces/fme-components/subversion/source/HEAD/LICENSE?_format=raw&quot;&gt;this BSD 3-clause license&lt;/a&gt;.&lt;/p&gt;"
#!   DOC_EXTENTS="3903 371.003"
#!   DOC_TOP_LEFT="-600 -68"
#!   EXPLICIT_BOOKMARK_ORDER="false"
#!   FME_BUILD_NUM="18310"
#!   FME_DOCUMENT_GUID="d1826dc4-c0ea-4136-87f1-e5095a302561"
#!   FME_DOCUMENT_PRIORGUID=""
#!   FME_LINKED_TRANSFORMER_VERSION="5"
#!   FME_PROCESS_COUNT="NO_PARALLELISM"
#!   FME_PROCESS_GROUPS_ORDERED="No"
#!   FME_PROCESS_GROUP_BY=""
#!   FME_SERVER_SERVICES=""
#!   FMX_ATTRIBUTE_PROPOGATION_MODE="AUTO"
#!   FMX_INSERT_MODE="Linked by Default"
#!   HISTORY="2017-11-26,Kevin&lt;space&gt;Weller,Initial&lt;space&gt;publication&lt;semicolon&gt;&lt;space&gt;test&lt;space&gt;workspace&lt;space&gt;fails&lt;space&gt;due&lt;space&gt;to&lt;space&gt;FME&lt;space&gt;Hub&lt;space&gt;version&lt;space&gt;delay.,2017-11-30,Kevin&lt;space&gt;Weller,Enhance&lt;space&gt;stack&lt;space&gt;trace&lt;space&gt;reporting&lt;semicolon&gt;&lt;space&gt;use&lt;space&gt;truncated&lt;space&gt;test&lt;space&gt;data&lt;space&gt;and&lt;space&gt;universal&lt;space&gt;temp&lt;space&gt;directory.,2018-01-20,Kevin&lt;space&gt;Weller,Fix&lt;space&gt;absolute&lt;space&gt;parameter&lt;space&gt;name&lt;space&gt;references&lt;space&gt;from&lt;space&gt;PythonCaller&lt;space&gt;when&lt;space&gt;SQLiteServer&lt;space&gt;is&lt;space&gt;called&lt;space&gt;from&lt;space&gt;another&lt;space&gt;custom&lt;space&gt;transformer&lt;space&gt;rather&lt;space&gt;than&lt;space&gt;from&lt;space&gt;the&lt;space&gt;top-level&lt;space&gt;workspace.,2018-03-08,Kevin&lt;space&gt;Weller,Update&lt;space&gt;documentation&lt;space&gt;to&lt;space&gt;reflect&lt;space&gt;move&lt;space&gt;from&lt;space&gt;GitHub&lt;space&gt;to&lt;space&gt;Assembla&lt;space&gt;and&lt;space&gt;Atlassian.,2018-03-18,Kevin&lt;space&gt;Weller,Fix&lt;space&gt;Python&lt;space&gt;syntax&lt;space&gt;error&lt;semicolon&gt;&lt;space&gt;test&lt;space&gt;driver&lt;space&gt;failed&lt;space&gt;to&lt;space&gt;test&lt;space&gt;latest&lt;space&gt;version&lt;comma&gt;&lt;space&gt;so&lt;space&gt;it&lt;space&gt;looked&lt;space&gt;like&lt;space&gt;it&lt;space&gt;worked&lt;space&gt;10&lt;space&gt;days&lt;space&gt;ago&lt;comma&gt;&lt;space&gt;but&lt;space&gt;it&lt;space&gt;didn&lt;apos&gt;t.&lt;space&gt;&lt;amp&gt;*^*&lt;openparen&gt;^&lt;amp&gt;^&lt;openparen&gt;&lt;amp&gt;*!"
#!   ITERATION_COUNT_ATTR=""
#!   LAST_SAVE_BUILD="FME(R) 2018.0.1.0 (20180518 - Build 18310 - macosx)"
#!   LAST_SAVE_DATE="2018-07-02T17:59:48"
#!   MARKDOWN_DESCRIPTION="An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.&#10;&#10;For issues or questions, please Create an issue [here](https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues).  For the source, including test driver components, please see the [Assembla repository](https://modgeosys.assembla.com/spaces/fme-components/subversion/source).  For a list of planned improvements, see [here](https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues).&#10;&#10;Copyright &amp;copy; 2017-2018 by Modern geoSystems, released under [this BSD 3-clause license](https://modgeosys.assembla.com/spaces/fme-components/subversion/source/HEAD/LICENSE?_format=raw)."
#!   MARKDOWN_USAGE="### Ports&#10;&#10;#### Input&#10;Feed the features to be sorted here.  If the input features consist of a variety of different feature types, it would be wise to ensure the sort key fields are represented in all of them.&#10;&#10;#### Output&#10;The sorted features emerge here.&#10;&#10;### Parameters&#10;&#10;#### Sort_Keys&#10;A tab- or space-delimited table of the sort keys to be applied.  The first column contains the names of the fields to be sorted, in order of sort priority.  The second column contains the database field data type.  The third and last column specifies whether the field is to be sorted in `asc`ending or `desc`ending order, e.g.:  &#10;  &#10;   `kml_name&#9;varchar asc`  &#10;    `kml_id  varchar desc`  &#10;"
#!   MAX_LOOP_ITERATIONS=""
#!   PASSWORD=""
#!   PYTHON_COMPATIBILITY="2or3"
#!   SHOW_ANNOTATIONS="true"
#!   SHOW_INFO_NODES="true"
#!   TITLE="SQLiteSorter"
#!   USAGE="&lt;h3&gt;Ports&lt;/h3&gt;&#10;&lt;h4&gt;Input&lt;/h4&gt;&#10;&lt;p&gt;Feed the features to be sorted here.  If the input features consist of a variety of different feature types, it would be wise to ensure the sort key fields are represented in all of them.&lt;/p&gt;&#10;&lt;h4&gt;Output&lt;/h4&gt;&#10;&lt;p&gt;The sorted features emerge here.&lt;/p&gt;&#10;&lt;h3&gt;Parameters&lt;/h3&gt;&#10;&lt;h4&gt;Sort_Keys&lt;/h4&gt;&#10;&lt;p&gt;A tab- or space-delimited table of the sort keys to be applied.  The first column contains the names of the fields to be sorted, in order of sort priority.  The second column contains the database field data type.  The third and last column specifies whether the field is to be sorted in &lt;code&gt;asc&lt;/code&gt;ending or &lt;code&gt;desc&lt;/code&gt;ending order, e.g.:  &lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;kml_name    varchar asc&lt;/code&gt;&lt;br /&gt;&#10;&lt;code&gt;kml_id  varchar desc&lt;/code&gt;  &lt;/p&gt;"
#!   USE_MARKDOWN="YES"
#!   VIEW_POSITION="-684.007 456.005"
#!   WARN_INVALID_XFORM_PARAM="Yes"
#!   WORKSPACE_VERSION="1"
#!   XFORM_DEPRECATED="No"
#!   ZOOM_SCALE="100"
#! >
#! <DATASETS>
#! </DATASETS>
#! <DATA_TYPES>
#! </DATA_TYPES>
#! <GEOM_TYPES>
#! </GEOM_TYPES>
#! <FEATURE_TYPES>
#! </FEATURE_TYPES>
#! <FMESERVER>
#! </FMESERVER>
#! <GLOBAL_PARAMETERS>
#! <GLOBAL_PARAMETER
#!   GUI_LINE="GUI TEXT_EDIT_OR_ATTR Sort_Keys &quot; &quot; Sort Keys:"
#!   DEFAULT_VALUE=""
#!   IS_STAND_ALONE="true"
#! />
#! </GLOBAL_PARAMETERS>
#! <COMMENTS>
#! <COMMENT
#!   IDENTIFIER="7"
#!   COMMENT_VALUE="&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0//EN&quot; &quot;http://www.w3.org/TR/REC-html40/strict.dtd&quot;&gt;&#10;&lt;html&gt;&lt;head&gt;&lt;meta name=&quot;qrichtext&quot; content=&quot;1&quot; /&gt;&lt;style type=&quot;text/css&quot;&gt;&#10;p, li { white-space: pre-wrap; }&#10;&lt;/style&gt;&lt;/head&gt;&lt;body style=&quot; font-family:&apos;helvetica neue&apos;; font-size:13pt; font-weight:400; font-style:normal;&quot;&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;This is much easier in&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;Python than with FME&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;transformers.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;"
#!   POSITION="2552.9985299853006 303.0000300003"
#!   TOP_LEFT="2552.9985299853006 303.0000300003"
#!   BOTTOM_RIGHT="2551.9985299853006 304.0000300003"
#!   BOUNDING_RECT="2552.9985299853006 303.0000300003 -1 -1"
#!   ORDER="500000000000000"
#!   FOLLOW_ANCHOR="true"
#!   INFO_NODE="false"
#!   COLOUR="1,1,0.78431372549019607,0.19215686274509805"
#!   SIZE_POLICY="8"
#!   ANCHORED_NODE="4"
#! />
#! </COMMENTS>
#! <CONSTANTS>
#! </CONSTANTS>
#! <BOOKMARKS>
#! </BOOKMARKS>
#! <TRANSFORMERS>
#! <TRANSFORMER
#!   IDENTIFIER="4"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="2552.9985299853006 3.0000300003000007"
#!   BOUNDING_RECT="2552.9985299853006 3.0000300003000007 516.04700000000003 71"
#!   ORDER="500000000000000"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_keys" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fmeobjects&lt;lf&gt;&lt;lf&gt;import&lt;space&gt;os&lt;lf&gt;import&lt;space&gt;os.path&lt;lf&gt;import&lt;space&gt;re&lt;lf&gt;import&lt;space&gt;csv&lt;lf&gt;import&lt;space&gt;sys&lt;lf&gt;if&lt;space&gt;sys.version_info&lt;space&gt;&lt;gt&gt;&lt;space&gt;&lt;openparen&gt;3&lt;comma&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;buffer&lt;space&gt;=&lt;space&gt;memoryview&lt;lf&gt;import&lt;space&gt;random&lt;lf&gt;import&lt;space&gt;string&lt;lf&gt;import&lt;space&gt;traceback&lt;lf&gt;import&lt;space&gt;inspect&lt;lf&gt;&lt;lf&gt;import&lt;space&gt;sqlite3&lt;lf&gt;import&lt;space&gt;logging&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Random&lt;space&gt;String&lt;space&gt;Generators&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;random_string&lt;openparen&gt;size=24&lt;comma&gt;&lt;space&gt;characters=string.ascii_lowercase&lt;space&gt;+&lt;space&gt;string.digits&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;random.choice&lt;openparen&gt;characters&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;x&lt;space&gt;in&lt;space&gt;range&lt;openparen&gt;size&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;random_path&lt;openparen&gt;directory&lt;comma&gt;&lt;space&gt;prefix=&lt;quote&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;size=24&lt;comma&gt;&lt;space&gt;characters=string.ascii_lowercase&lt;space&gt;+&lt;space&gt;string.digits&lt;comma&gt;&lt;space&gt;suffix=&lt;quote&gt;&lt;quote&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;while&lt;space&gt;True:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;path&lt;space&gt;=&lt;space&gt;os.path.join&lt;openparen&gt;directory&lt;comma&gt;&lt;space&gt;prefix&lt;space&gt;+&lt;space&gt;random_string&lt;openparen&gt;size&lt;comma&gt;&lt;space&gt;characters&lt;closeparen&gt;&lt;space&gt;+&lt;space&gt;suffix&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;fd&lt;space&gt;=&lt;space&gt;os.open&lt;openparen&gt;path&lt;comma&gt;&lt;space&gt;os.O_RDONLY&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.close&lt;openparen&gt;fd&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;continue&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;OSError:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;break&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;path&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Text&lt;space&gt;Interpretation&lt;lf&gt;&lt;lf&gt;FME_TAG_CODE_TRANSLATIONS&lt;space&gt;=&lt;space&gt;&lt;opencurly&gt;&lt;apos&gt;lf&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;div.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;br.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;p.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;cr&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;r&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;space&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;tab&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;t&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;comma&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;solidus&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;solidus&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;apos&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;openparen&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;openparen&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closeparen&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;closeparen&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;openbracket&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;openbracket&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closebracket&lt;apos&gt;:&lt;space&gt;&lt;apos&gt;&lt;closebracket&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;opencurly&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;opencurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closecurly&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;closecurly&gt;&lt;apos&gt;&lt;closecurly&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;interpret_fme_character_tags&lt;openparen&gt;raw_text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;raw_text&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;fme_tag_code&lt;space&gt;in&lt;space&gt;FME_TAG_CODE_TRANSLATIONS.keys&lt;openparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;&lt;apos&gt;&lt;lt&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;fme_tag_code&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;FME_TAG_CODE_TRANSLATIONS&lt;openbracket&gt;fme_tag_code&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;result&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;result&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;sanitize_text&lt;openparen&gt;raw_text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Replace&lt;space&gt;FME&lt;space&gt;tags&lt;comma&gt;&lt;space&gt;HTML&lt;space&gt;tags&lt;space&gt;or&lt;space&gt;SQL&lt;space&gt;meta-characters&lt;space&gt;with&lt;space&gt;clean&lt;space&gt;and&lt;space&gt;safe&lt;space&gt;equivalents.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;interpret_fme_character_tags&lt;openparen&gt;raw_text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;quote&gt;&lt;apos&gt;&lt;openbracket&gt;&lt;closeparen&gt;&lt;backslash&gt;&lt;quote&gt;&lt;semicolon&gt;!=&lt;closebracket&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;SQL&lt;space&gt;metacharacters.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;lt&gt;.+?&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;all&lt;space&gt;HTML&lt;space&gt;tags.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;^&lt;gt&gt;&lt;openbracket&gt;&lt;backslash&gt;t&lt;space&gt;&lt;closebracket&gt;*&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;email&lt;space&gt;quoting&lt;space&gt;prefixes.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;result&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;extract_dict_from_tab_delimited_data&lt;openparen&gt;text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;rows&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;openbracket&gt;&lt;space&gt;&lt;backslash&gt;t&lt;closebracket&gt;+&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;&lt;backslash&gt;t&lt;quote&gt;&lt;comma&gt;&lt;space&gt;text&lt;closeparen&gt;.splitlines&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Replace&lt;space&gt;repeated&lt;space&gt;delimiter&lt;space&gt;characters&lt;space&gt;by&lt;space&gt;a&lt;space&gt;single&lt;space&gt;tab&lt;space&gt;to&lt;space&gt;simplify&lt;space&gt;extraction.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;&lt;openbracket&gt;row&lt;space&gt;for&lt;space&gt;row&lt;space&gt;in&lt;space&gt;csv.DictReader&lt;openparen&gt;rows&lt;comma&gt;&lt;space&gt;&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;type&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;ordinality&lt;apos&gt;&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;None&lt;comma&gt;&lt;space&gt;None&lt;comma&gt;&lt;space&gt;&lt;apos&gt;excel-tab&lt;apos&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Logging&lt;space&gt;Support&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FMELogFormatter&lt;openparen&gt;logging.Formatter&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;arg&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;super&lt;openparen&gt;FMELogFormatter&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.arg&lt;space&gt;=&lt;space&gt;arg&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FMELogHandler&lt;openparen&gt;logging.Handler&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;emit&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;record&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Emit&lt;space&gt;a&lt;space&gt;log&lt;space&gt;record.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger&lt;space&gt;=&lt;space&gt;fmeobjects.FMELogFile&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger.logMessageString&lt;openparen&gt;record.getMessage&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;getFMELogger&lt;openparen&gt;name&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Get&lt;space&gt;an&lt;space&gt;FME&lt;space&gt;logger.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger&lt;space&gt;=&lt;space&gt;logging.getLogger&lt;openparen&gt;name&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;formatter&lt;space&gt;=&lt;space&gt;logging.Formatter&lt;openparen&gt;&lt;quote&gt;%&lt;openparen&gt;asctime&lt;closeparen&gt;s&lt;space&gt;%&lt;openparen&gt;levelname&lt;closeparen&gt;s:&lt;space&gt;%&lt;openparen&gt;message&lt;closeparen&gt;s&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;handler&lt;space&gt;=&lt;space&gt;FMELogHandler&lt;openparen&gt;level=&lt;quote&gt;INFO&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;handler.setFormatter&lt;openparen&gt;formatter&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger.addHandler&lt;openparen&gt;handler&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;logger&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Exception&lt;solidus&gt;Error&lt;space&gt;Classes&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;MGSError&lt;openparen&gt;Exception&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;class&lt;space&gt;for&lt;space&gt;exceptions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;message&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;super&lt;openparen&gt;MGSError&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;message&lt;closeparen&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;type&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Error&lt;space&gt;type&lt;space&gt;string.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;Error&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;instructions&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Post-message&lt;space&gt;instructions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;MGSSystemError&lt;openparen&gt;MGSError&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;message&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;super&lt;openparen&gt;MGSSystemError&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;message&lt;closeparen&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;type&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Error&lt;space&gt;type&lt;space&gt;string.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;instructions&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Post-message&lt;space&gt;instructions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;FME&lt;space&gt;Template&lt;space&gt;Class&lt;space&gt;Interface&lt;lf&gt;&lt;lf&gt;TEMP&lt;space&gt;=&lt;space&gt;&lt;apos&gt;FME_SHAREDRESOURCE_TEMP&lt;apos&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Load&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;into&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;sqlite_sort_record_number&lt;apos&gt;&lt;closeparen&gt;&lt;space&gt;==&lt;space&gt;1:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;temporary&lt;space&gt;SQLite&lt;space&gt;database&lt;space&gt;and&lt;space&gt;feature&lt;space&gt;table.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db&lt;space&gt;=&lt;space&gt;None&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;keys&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;sqlite_sort_keys&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Configure&lt;space&gt;database&lt;space&gt;file&lt;space&gt;path&lt;space&gt;and&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;name.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db_path&lt;space&gt;=&lt;space&gt;random_path&lt;openparen&gt;directory=FME_MacroValues&lt;openbracket&gt;TEMP&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;prefix=&lt;apos&gt;SQLiteSorter_&lt;apos&gt;&lt;comma&gt;&lt;space&gt;suffix=&lt;apos&gt;.sqlite&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.table_name&lt;space&gt;=&lt;space&gt;&lt;apos&gt;features&lt;apos&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;SQL&lt;space&gt;DDF&lt;space&gt;key&lt;space&gt;column&lt;space&gt;definitions&lt;space&gt;from&lt;space&gt;the&lt;space&gt;Sort_Keys&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.keys&lt;space&gt;=&lt;space&gt;extract_dict_from_tab_delimited_data&lt;openparen&gt;sanitize_text&lt;openparen&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;lt&gt;apos&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;&lt;apos&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;keys&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;column_defs&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;openparen&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;type&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;temporary&lt;space&gt;database&lt;space&gt;and&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;with&lt;space&gt;a&lt;space&gt;BLOB&lt;space&gt;to&lt;space&gt;contain&lt;space&gt;the&lt;space&gt;serialized&lt;space&gt;feature.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db&lt;space&gt;=&lt;space&gt;sqlite3.connect&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.text_factory&lt;space&gt;=&lt;space&gt;str&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor&lt;space&gt;=&lt;space&gt;self.db.execute&lt;openparen&gt;&lt;quote&gt;create&lt;space&gt;table&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;column_defs&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;feature&lt;space&gt;BLOB&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;create&lt;space&gt;index&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;quote&gt;_index&lt;space&gt;on&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;asc&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;Exception&lt;space&gt;as&lt;space&gt;e:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;open&lt;space&gt;SQLite&lt;space&gt;database&lt;space&gt;&lt;quote&gt;%s&lt;quote&gt;&lt;space&gt;to&lt;space&gt;sort&lt;space&gt;records:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.db_path&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;hasattr&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;&lt;apos&gt;db&lt;apos&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Construct&lt;space&gt;insertion&lt;space&gt;statement&lt;space&gt;elements.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;key_names&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;key_placeholders&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;apos&gt;?&lt;apos&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;all_values&lt;space&gt;=&lt;space&gt;&lt;openbracket&gt;self.get_feature_attribute&lt;openparen&gt;feature&lt;comma&gt;&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;openbracket&gt;buffer&lt;openparen&gt;self.serialize_feature&lt;openparen&gt;feature&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Insert&lt;space&gt;the&lt;space&gt;feature&lt;space&gt;record&lt;space&gt;into&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;insert&lt;space&gt;into&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key_names&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;&lt;space&gt;values&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key_placeholders&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;?&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;all_values&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;store&lt;space&gt;records&lt;space&gt;in&lt;space&gt;SQLite&lt;space&gt;for&lt;space&gt;sorting:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Read&lt;space&gt;all&lt;space&gt;stored&lt;space&gt;features&lt;space&gt;from&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;in&lt;space&gt;the&lt;space&gt;requested&lt;space&gt;order.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;hasattr&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;&lt;apos&gt;db&lt;apos&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.commit&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Construct&lt;space&gt;the&lt;space&gt;ORDER&lt;space&gt;BY&lt;space&gt;clause.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;sort_defs&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;openparen&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;ordinality&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger&lt;space&gt;=&lt;space&gt;fmeobjects.FMELogFile&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger.logMessageString&lt;openparen&gt;&lt;apos&gt;sort_defs:&lt;space&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;repr&lt;openparen&gt;sort_defs&lt;closeparen&gt;&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;backslash&gt;n&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Execute&lt;space&gt;the&lt;space&gt;query&lt;space&gt;and&lt;space&gt;output&lt;space&gt;the&lt;space&gt;features&lt;space&gt;in&lt;space&gt;sorted&lt;space&gt;order&lt;comma&gt;&lt;space&gt;reconstructing&lt;space&gt;them&lt;space&gt;from&lt;space&gt;the&lt;space&gt;serialized&lt;space&gt;copy&lt;space&gt;in&lt;space&gt;the&lt;space&gt;temporary&lt;space&gt;table.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;feature_record&lt;space&gt;in&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;select&lt;space&gt;feature&lt;space&gt;from&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;order&lt;space&gt;by&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;sort_defs&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.output_feature_from_blob&lt;openparen&gt;feature_record&lt;openbracket&gt;0&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;sort&lt;space&gt;records&lt;space&gt;via&lt;space&gt;SQLite:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;finally:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Don&lt;apos&gt;t&lt;space&gt;leave&lt;space&gt;temporary&lt;space&gt;resource&lt;space&gt;files&lt;space&gt;behind.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;output_feature_from_blob&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;blob&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature&lt;space&gt;=&lt;space&gt;self.deserialize_feature&lt;openparen&gt;blob&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.output_feature&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;deserialize_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;blob&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.deserialize&lt;openparen&gt;bytearray&lt;openparen&gt;blob&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;output_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;get_feature_attribute&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;comma&gt;&lt;space&gt;feature_name&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature.getAttribute&lt;openparen&gt;feature_name&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;serialize_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature.serialize&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="SQLiteSortPythonCaller"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="8"
#!   TYPE="Counter"
#!   VERSION="2"
#!   POSITION="150 0"
#!   BOUNDING_RECT="150 0 -1 -1"
#!   ORDER="500000000000001"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="fme_rejection_code" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="CNT_ATTR" PARM_VALUE="sqlite_sort_record_number"/>
#!     <XFORM_PARM PARM_NAME="DOMAIN" PARM_VALUE="sqlite_sort_counter"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SCOPE" PARM_VALUE="Local"/>
#!     <XFORM_PARM PARM_NAME="START" PARM_VALUE="1"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Counter"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="11"
#!   TYPE="ParameterFetcher"
#!   VERSION="4"
#!   POSITION="1803.0000300002998 303.00303003030029"
#!   BOUNDING_RECT="1803.0000300002998 303.00303003030029 -1 -1"
#!   ORDER="500000000000002"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_keys" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ATTR_LIST" PARM_VALUE="sqlite_sort_keys $(Sort_Keys)"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ParameterFetcher"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="14"
#!   TYPE="Sampler"
#!   VERSION="4"
#!   POSITION="906.009060090601 -3.0000300002999438"
#!   BOUNDING_RECT="906.009060090601 -3.0000300002999438 -1 -1"
#!   ORDER="500000000000003"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="SAMPLED"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="NOT_SAMPLED"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="RATE" PARM_VALUE="1"/>
#!     <XFORM_PARM PARM_NAME="SAMPLE_MODE" PARM_VALUE="No"/>
#!     <XFORM_PARM PARM_NAME="SAMPLE_TYPE_LONG" PARM_VALUE="First N Features"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Sampler"/>
#! </TRANSFORMER>
#! </TRANSFORMERS>
#! <SUBDOCUMENT_IOS>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="2"
#!   NAME="Input"
#!   POSITION="-600 0"
#!   BOUNDING_RECT="-600 0 -1 -1"
#!   COLLAPSED="true"
#!   PUBLISHED="true"
#!   IS_SOURCE="true"
#!   ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="3"
#!   NAME="Sorted"
#!   POSITION="3302.9985299853006 3.0000300003000007"
#!   BOUNDING_RECT="3302.9985299853006 3.0000300003000007 -1 -1"
#!   COLLAPSED="true"
#!   IS_SOURCE="false"
#!   ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! </SUBDOCUMENT_IOS>
#! <FEAT_LINKS>
#! <FEAT_LINK
#!   IDENTIFIER="21"
#!   SOURCE_NODE="2"
#!   TARGET_NODE="8"
#!   SOURCE_PORT_DESC="0"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="6"
#!   SOURCE_NODE="4"
#!   TARGET_NODE="3"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="0"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="15"
#!   SOURCE_NODE="8"
#!   TARGET_NODE="14"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="13"
#!   SOURCE_NODE="11"
#!   TARGET_NODE="4"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="16"
#!   SOURCE_NODE="14"
#!   TARGET_NODE="11"
#!   SOURCE_PORT_DESC="fo 0 SAMPLED"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="17"
#!   SOURCE_NODE="14"
#!   TARGET_NODE="4"
#!   SOURCE_PORT_DESC="fo 1 NOT_SAMPLED"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! </FEAT_LINKS>
#! <BREAKPOINTS>
#! </BREAKPOINTS>
#! <ATTR_LINKS>
#! </ATTR_LINKS>
#! <SUBDOCUMENTS>
#! </SUBDOCUMENTS>
#! <LOOKUP_TABLES>
#! </LOOKUP_TABLES>
#! </TRANSFORMER>
FME_PYTHON_VERSION 2or3
DEFAULT_MACRO $(SQLiteSorter_WORKSPACE_NAME)_Sort_Keys 
#! START_HEADER
#! END_HEADER

LOG_TIMINGS YES
LOG_FILTER_MASK -1
DEFAULT_MACRO WB_CURRENT_CONTEXT
DEFAULT_MACRO SQLiteSorter_WORKSPACE_NAME ""
INCLUDE [puts {MACRO WB_OLD_CONTEXT_$(SQLiteSorter_WORKSPACE_NAME) $(WB_CURRENT_CONTEXT)};          puts {MACRO WB_CURRENT_CONTEXT $(SQLiteSorter_WORKSPACE_NAME)}]
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Input1530575988 Input Splitter"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"   OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"
# -------------------------------------------------------------------------

# Create the DomainName that this transformer will use.
# Because @Count itself will evalute the expression to calculate the
# domain, we don't need to do anything in Tcl per feature going by

INCLUDE [    set domainPrefix {};    if { {Local} == {Local} }    {       set domainPrefix [FME_EncodeText {$(SQLiteSorter_WORKSPACE_NAME)_Counter_}];    };    puts "MACRO $(SQLiteSorter_WORKSPACE_NAME)_Counter_FULL_DOMAIN ${domainPrefix}sqlite_sort_counter"; ]
FACTORY_DEF * ExecuteFunctionFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Counter_Rejector    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"    FUNCTION_DEFINITION @Count(REJECTABLE_WITH_FLAG,fme_encoded,$($(SQLiteSorter_WORKSPACE_NAME)_Counter_FULL_DOMAIN),"1")    RESULT_ATTRIBUTE "sqlite_sort_record_number"    OUTPUT COMPLETE FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_OUTPUT"    OUTPUT REJECTED FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_<REJECTED>"

FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Counter <REJECTED> Transformer Output Nuker"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_<REJECTED>"
# -------------------------------------------------------------------------

# If we're doing LAST N features, then the multiplier comes in as 0.
# If we're doing First N, multiplier is -1.
# For RANDOM, we need to treat LAST N as if it was first N (i.e. have a -1)
# That is what the ? : does in the rate multiplier.

INCLUDE [ if { {-1} == {0} && {ORIGINAL} == {ORIGINAL} } {              puts "MACRO REAL_MODE LAST"; 	         puts "MACRO REAL_RATE 1"; 	      } else {              puts "MACRO REAL_MODE ORIGINAL";              puts "MACRO REAL_RATE [expr 1 * ( -1 ? -1 : -1 ) ]"; 	      } ]
FACTORY_DEF {*} SamplingFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Sampler    COMMAND_PARM_EVALUATION SINGLE_PASS    SAMPLE_RATE $(REAL_RATE)    SAMPLE_ORDER $(REAL_MODE)    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_OUTPUT"    OUTPUT SAMPLED FEATURE_TYPE ___SAMPLED___    OUTPUT NOT_SAMPLED FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_NOT_SAMPLED"
# This TeeFactory is needed because Sampler will still output features if it has no OUTPUT clauses specified.
# This way we behave nicely even if there are no output connections on the transformer. See PR#28886.

FACTORY_DEF * TeeFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Sampler_Sampled    INPUT FEATURE_TYPE ___SAMPLED___    OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_SAMPLED"


# -------------------------------------------------------------------------

Tcl2 proc $(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_doFetch {} {    foreach {name val} {"sqlite_sort_keys {$($(SQLiteSorter_WORKSPACE_NAME)_Sort_Keys)}"} {         if { [string match {*<at>*} $val] == 1 } {             set val [FME_Execute EvaluateExpression {STRING} $val {$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher}];         } elseif {[string match {*FME_CONDITIONAL*} $val] == 1} {             set val [FME_Execute EvaluateExpression {STRING} $val {$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher}];         } else {             set val [FME_DecodeTextOrAttr $val];         };       FME_SetAttribute [FME_DecodeText $name] $val    } }
FACTORY_DEF * TeeFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_SAMPLED"    OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_OUTPUT"         @Tcl2($(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_doFetch)

# -------------------------------------------------------------------------


FME_PYTHON_PATH "$(FME_MF_DIR)"

FACTORY_DEF * PythonFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_OUTPUT"    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_NOT_SAMPLED"    SYMBOL_NAME FeatureProcessor    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE import<space>fmeobjects<lf><lf>import<space>os<lf>import<space>os.path<lf>import<space>re<lf>import<space>csv<lf>import<space>sys<lf>if<space>sys.version_info<space><gt><space><openparen>3<comma><closeparen>:<lf><space><space><space><space>buffer<space>=<space>memoryview<lf>import<space>random<lf>import<space>string<lf>import<space>traceback<lf>import<space>inspect<lf><lf>import<space>sqlite3<lf>import<space>logging<lf><lf><lf><lf>#<space>Random<space>String<space>Generators<lf><lf>def<space>random_string<openparen>size=24<comma><space>characters=string.ascii_lowercase<space>+<space>string.digits<closeparen>:<lf><space><space><space><space>return<space><apos><apos>.join<openparen>random.choice<openparen>characters<closeparen><space>for<space>x<space>in<space>range<openparen>size<closeparen><closeparen><lf><lf><lf>def<space>random_path<openparen>directory<comma><space>prefix=<quote><quote><comma><space>size=24<comma><space>characters=string.ascii_lowercase<space>+<space>string.digits<comma><space>suffix=<quote><quote><closeparen>:<lf><space><space><space><space>while<space>True:<lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>path<space>=<space>os.path.join<openparen>directory<comma><space>prefix<space>+<space>random_string<openparen>size<comma><space>characters<closeparen><space>+<space>suffix<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>fd<space>=<space>os.open<openparen>path<comma><space>os.O_RDONLY<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>os.close<openparen>fd<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>continue<lf><space><space><space><space><space><space><space><space>except<space>OSError:<lf><space><space><space><space><space><space><space><space><space><space><space><space>break<lf><space><space><space><space>return<space>path<lf><lf><lf><lf>#<space>Text<space>Interpretation<lf><lf>FME_TAG_CODE_TRANSLATIONS<space>=<space><opencurly><apos>lf<apos>:<space><space><space><space><space><space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>div.*?<apos>:<space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>br.*?<apos>:<space><space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>p.*?<apos>:<space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>cr<apos>:<space><space><space><space><space><space><space><space><space><space><space><apos><backslash>r<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>space<apos>:<space><space><space><space><space><space><space><space><apos><space><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>tab<apos>:<space><space><space><space><space><space><space><space><space><space><apos><backslash>t<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>comma<apos>:<space><space><space><space><space><space><space><space><apos><comma><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>solidus<apos>:<space><space><space><space><space><space><apos><solidus><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>apos<apos>:<space><space><space><space><space><space><space><space><space><apos><comma><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>openparen<apos>:<space><space><space><space><apos><openparen><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closeparen<apos>:<space><space><space><apos><closeparen><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>openbracket<apos>:<space><space><apos><openbracket><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closebracket<apos>:<space><apos><closebracket><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>opencurly<apos>:<space><space><space><space><apos><opencurly><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closecurly<apos>:<space><space><space><apos><closecurly><apos><closecurly><lf><lf>def<space>interpret_fme_character_tags<openparen>raw_text<closeparen>:<lf><space><space><space><space>result<space>=<space>raw_text<lf><space><space><space><space>for<space>fme_tag_code<space>in<space>FME_TAG_CODE_TRANSLATIONS.keys<openparen><closeparen>:<lf><space><space><space><space><space><space><space><space>result<space>=<space>re.sub<openparen><apos><lt><apos><space>+<space>fme_tag_code<space>+<space><apos><gt><apos><comma><space>FME_TAG_CODE_TRANSLATIONS<openbracket>fme_tag_code<closebracket><comma><space>result<closeparen><lf><space><space><space><space>return<space>result<lf><lf>def<space>sanitize_text<openparen>raw_text<closeparen>:<lf><space><space><space><space><quote><quote><quote>Replace<space>FME<space>tags<comma><space>HTML<space>tags<space>or<space>SQL<space>meta-characters<space>with<space>clean<space>and<space>safe<space>equivalents.<quote><quote><quote><lf><space><space><space><space>result<space>=<space>interpret_fme_character_tags<openparen>raw_text<closeparen><lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<quote><apos><openbracket><closeparen><backslash><quote><semicolon>!=<closebracket><quote><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space>#<space>Sanitize<space>SQL<space>metacharacters.<lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<apos><lt>.+?<gt><apos><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space><space><space><space><space>#<space>Sanitize<space>all<space>HTML<space>tags.<lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<apos>^<gt><openbracket><backslash>t<space><closebracket>*<apos><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space><space>#<space>Sanitize<space>email<space>quoting<space>prefixes.<lf><space><space><space><space>return<space>result<lf><lf>def<space>extract_dict_from_tab_delimited_data<openparen>text<closeparen>:<lf><space><space><space><space>rows<space>=<space>re.sub<openparen>r<apos><openbracket><space><backslash>t<closebracket>+<apos><comma><space><quote><backslash>t<quote><comma><space>text<closeparen>.splitlines<openparen><closeparen><space><space>#<space>Replace<space>repeated<space>delimiter<space>characters<space>by<space>a<space>single<space>tab<space>to<space>simplify<space>extraction.<lf><space><space><space><space>return<space><openbracket>row<space>for<space>row<space>in<space>csv.DictReader<openparen>rows<comma><space><openbracket><apos>name<apos><comma><space><apos>type<apos><comma><space><apos>ordinality<apos><closebracket><comma><space>None<comma><space>None<comma><space><apos>excel-tab<apos><closeparen><closebracket><lf><lf><lf><lf>#<space>Logging<space>Support<lf><lf>class<space>FMELogFormatter<openparen>logging.Formatter<closeparen>:<lf><space><space><space><space>def<space>__init__<openparen>self<comma><space>arg<closeparen>:<lf><space><space><space><space><space><space><space><space>super<openparen>FMELogFormatter<comma><space>self<closeparen>.__init__<openparen><closeparen><lf><space><space><space><space><space><space><space><space>self.arg<space>=<space>arg<lf><lf><lf>class<space>FMELogHandler<openparen>logging.Handler<closeparen>:<lf><space><space><space><space>def<space>emit<openparen>self<comma><space>record<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Emit<space>a<space>log<space>record.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>logger<space>=<space>fmeobjects.FMELogFile<openparen><closeparen><lf><space><space><space><space><space><space><space><space>logger.logMessageString<openparen>record.getMessage<openparen><closeparen><closeparen><lf><lf>def<space>getFMELogger<openparen>name<closeparen>:<lf><space><space><space><space><quote><quote><quote>Get<space>an<space>FME<space>logger.<quote><quote><quote><lf><space><space><space><space>logger<space>=<space>logging.getLogger<openparen>name<closeparen><lf><space><space><space><space>formatter<space>=<space>logging.Formatter<openparen><quote>%<openparen>asctime<closeparen>s<space>%<openparen>levelname<closeparen>s:<space>%<openparen>message<closeparen>s<quote><closeparen><lf><space><space><space><space>handler<space>=<space>FMELogHandler<openparen>level=<quote>INFO<quote><closeparen><lf><space><space><space><space>handler.setFormatter<openparen>formatter<closeparen><lf><space><space><space><space>logger.addHandler<openparen>handler<closeparen><lf><space><space><space><space>return<space>logger<lf><lf><lf><lf>#<space>Exception<solidus>Error<space>Classes<lf><lf>class<space>MGSError<openparen>Exception<closeparen>:<lf><tab><quote><quote><quote>Base<space>class<space>for<space>exceptions.<quote><quote><quote><lf><tab><lf><tab>def<space>__init__<openparen>self<comma><space>message<closeparen>:<lf><tab><tab>super<openparen>MGSError<comma><space>self<closeparen>.__init__<openparen>message<closeparen><lf><tab><lf><tab>def<space>type<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Error<space>type<space>string.<quote><quote><quote><lf><tab><tab>return<space><quote>Error<quote><lf><tab><lf><tab>def<space>instructions<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Post-message<space>instructions.<quote><quote><quote><lf><tab><tab>return<space><quote><quote><quote>Please<space>try<space>again.<quote><quote><quote><lf><lf>class<space>MGSSystemError<openparen>MGSError<closeparen>:<lf><tab><lf><tab>def<space>__init__<openparen>self<comma><space>message<closeparen>:<lf><tab><tab>super<openparen>MGSSystemError<comma><space>self<closeparen>.__init__<openparen>message<closeparen><lf><tab><lf><tab>def<space>type<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Error<space>type<space>string.<quote><quote><quote><lf><tab><tab>return<space><quote>Unexpected<space>System<space>Error<quote><lf><tab><lf><tab>def<space>instructions<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Post-message<space>instructions.<quote><quote><quote><lf><tab><tab>return<space><quote><quote><quote>Please<space>try<space>again.<quote><quote><quote><lf><lf><lf><lf>#<space>FME<space>Template<space>Class<space>Interface<lf><lf>TEMP<space>=<space><apos>FME_SHAREDRESOURCE_TEMP<apos><lf><lf>class<space>FeatureProcessor:<lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Load<space>a<space>feature<space>into<space>the<space>sort<space>table.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>feature.getAttribute<openparen><apos>sqlite_sort_record_number<apos><closeparen><space>==<space>1:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>temporary<space>SQLite<space>database<space>and<space>feature<space>table.<quote><quote><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db<space>=<space>None<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>keys<space>=<space>feature.getAttribute<openparen><apos>sqlite_sort_keys<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Configure<space>database<space>file<space>path<space>and<space>sort<space>table<space>name.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db_path<space>=<space>random_path<openparen>directory=FME_MacroValues<openbracket>TEMP<closebracket><comma><space>prefix=<apos>SQLiteSorter_<apos><comma><space>suffix=<apos>.sqlite<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.table_name<space>=<space><apos>features<apos><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>SQL<space>DDF<space>key<space>column<space>definitions<space>from<space>the<space>Sort_Keys<space>parameter.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.keys<space>=<space>extract_dict_from_tab_delimited_data<openparen>sanitize_text<openparen>re.sub<openparen>r<apos><lt>apos<gt><apos><comma><space><quote><apos><quote><comma><space>keys<closeparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>column_defs<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><openparen>key<openbracket><apos>name<apos><closebracket><space>+<space><apos><space><apos><space>+<space>key<openbracket><apos>type<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>temporary<space>database<space>and<space>sort<space>table<space>with<space>a<space>BLOB<space>to<space>contain<space>the<space>serialized<space>feature.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db<space>=<space>sqlite3.connect<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.text_factory<space>=<space>str<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor<space>=<space>self.db.execute<openparen><quote>create<space>table<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>column_defs<space>+<space><quote><comma><space>feature<space>BLOB<closeparen><semicolon><quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>for<space>key<space>in<space>self.keys:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.execute<openparen><quote>create<space>index<space><quote><space>+<space>key<openbracket><apos>name<apos><closebracket><space>+<space><quote>_index<space>on<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>key<openbracket><apos>name<apos><closebracket><space>+<space><quote><space>asc<closeparen><semicolon><quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>except<space>Exception<space>as<space>e:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>open<space>SQLite<space>database<space><quote>%s<quote><space>to<space>sort<space>records:<space>%s<backslash>n%s<apos><comma><space>self.db_path<comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>if<space>hasattr<openparen>self<comma><space><apos>db<apos><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Construct<space>insertion<space>statement<space>elements.<lf><space><space><space><space><space><space><space><space><space><space><space><space>key_names<space>=<space><apos><comma><space><apos>.join<openparen><openbracket>key<openbracket><apos>name<apos><closebracket><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>key_placeholders<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><apos>?<apos><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>all_values<space>=<space><openbracket>self.get_feature_attribute<openparen>feature<comma><space>key<openbracket><apos>name<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><space>+<space><openbracket>buffer<openparen>self.serialize_feature<openparen>feature<closeparen><closeparen><closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Insert<space>the<space>feature<space>record<space>into<space>the<space>sort<space>table.<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.execute<openparen><quote>insert<space>into<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>key_names<space>+<space><quote><comma><space>feature<closeparen><space>values<space><openparen><quote><space>+<space>key_placeholders<space>+<space><quote><comma><space>?<closeparen><semicolon><quote><comma><space>all_values<closeparen><lf><space><space><space><space><space><space><space><space>except:<lf><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>store<space>records<space>in<space>SQLite<space>for<space>sorting:<space>%s<backslash>n%s<apos><comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Read<space>all<space>stored<space>features<space>from<space>the<space>sort<space>table<space>in<space>the<space>requested<space>order.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>hasattr<openparen>self<comma><space><apos>db<apos><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.commit<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Construct<space>the<space>ORDER<space>BY<space>clause.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>sort_defs<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><openparen>key<openbracket><apos>name<apos><closebracket><space>+<space><apos><space><apos><space>+<space>key<openbracket><apos>ordinality<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>logger<space>=<space>fmeobjects.FMELogFile<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>logger.logMessageString<openparen><apos>sort_defs:<space><apos><space>+<space>repr<openparen>sort_defs<closeparen><space>+<space><quote><backslash>n<quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Execute<space>the<space>query<space>and<space>output<space>the<space>features<space>in<space>sorted<space>order<comma><space>reconstructing<space>them<space>from<space>the<space>serialized<space>copy<space>in<space>the<space>temporary<space>table.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>for<space>feature_record<space>in<space>self.cursor.execute<openparen><quote>select<space>feature<space>from<space><quote><space>+<space>self.table_name<space>+<space><quote><space>order<space>by<space><quote><space>+<space>sort_defs<space>+<space><quote><semicolon><quote><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.output_feature_from_blob<openparen>feature_record<openbracket>0<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>except:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>sort<space>records<space>via<space>SQLite:<space>%s<backslash>n%s<apos><comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>finally:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Don<apos>t<space>leave<space>temporary<space>resource<space>files<space>behind.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><lf><space><space><space><space>def<space>output_feature_from_blob<openparen>self<comma><space>blob<closeparen>:<lf><space><space><space><space><space><space><space><space>feature<space>=<space>self.deserialize_feature<openparen>blob<closeparen><lf><space><space><space><space><space><space><space><space>self.output_feature<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>deserialize_feature<openparen>self<comma><space>blob<closeparen>:<lf><space><space><space><space><space><space><space><space>feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space>feature.deserialize<openparen>bytearray<openparen>blob<closeparen><closeparen><lf><space><space><space><space><space><space><space><space>return<space>feature<lf><lf><space><space><space><space>def<space>output_feature<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>get_feature_attribute<openparen>self<comma><space>feature<comma><space>feature_name<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space>feature.getAttribute<openparen>feature_name<closeparen><lf><lf><space><space><space><space>def<space>serialize_feature<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space>feature.serialize<openparen><closeparen><lf>    OUTPUT PYOUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller_OUTPUT"

FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Sorted1530575988 Output Collector"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller_OUTPUT"   OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sorted"
INCLUDE [puts {MACRO WB_CURRENT_CONTEXT $(WB_OLD_CONTEXT_$(SQLiteSorter_WORKSPACE_NAME))}]
#! <?xml version="1.0" encoding="UTF-8" ?>
#! <TRANSFORMER
# TRANSFORMER_BEGIN SQLiteSorter,4,Workflows,7c8f18a5-08fd-49e0-923d-b8725ef268b7,"Linked by Default",No,NO_PARALLELISM,,No,18310,YES,No,2or3
# <p>An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.</p>
# <p>For issues or questions, please Create an issue <a href="https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues">here</a>.  For the source, including test driver components, please see the <a href="https://modgeosys.assembla.com/spaces/fme-components/subversion/source">Assembla repository</a>.  For a list of planned improvements, see <a href="https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues">here</a>.</p>
# <p>Copyright &copy; 2017-2018 by Modern geoSystems, released under <a href="https://modgeosys.assembla.com/spaces/fme-components/subversion/source/HEAD/LICENSE?_format=raw">this BSD 3-clause license</a>.</p>
# TRANSFORMER_END
#!   ATTR_TYPE_ENCODING="SDF"
#!   BLOCKED_LOOPING="No"
#!   CATEGORY="Workflows"
#!   DESCRIPTION="&lt;p&gt;An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.&lt;/p&gt;&#10;&lt;p&gt;For issues or questions, please Create an issue &lt;a href=&quot;https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues&quot;&gt;here&lt;/a&gt;.  For the source, including test driver components, please see the &lt;a href=&quot;https://modgeosys.assembla.com/spaces/fme-components/subversion/source&quot;&gt;Assembla repository&lt;/a&gt;.  For a list of planned improvements, see &lt;a href=&quot;https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;&#10;&lt;p&gt;Copyright &amp;copy; 2017-2018 by Modern geoSystems, released under &lt;a href=&quot;https://modgeosys.assembla.com/spaces/fme-components/subversion/source/HEAD/LICENSE?_format=raw&quot;&gt;this BSD 3-clause license&lt;/a&gt;.&lt;/p&gt;"
#!   DOC_EXTENTS="3903 371.003"
#!   DOC_TOP_LEFT="-600 -68"
#!   EXPLICIT_BOOKMARK_ORDER="false"
#!   FME_BUILD_NUM="18310"
#!   FME_DOCUMENT_GUID="7c8f18a5-08fd-49e0-923d-b8725ef268b7"
#!   FME_DOCUMENT_PRIORGUID=""
#!   FME_LINKED_TRANSFORMER_VERSION="4"
#!   FME_PROCESS_COUNT="NO_PARALLELISM"
#!   FME_PROCESS_GROUPS_ORDERED="No"
#!   FME_PROCESS_GROUP_BY=""
#!   FME_SERVER_SERVICES=""
#!   FMX_ATTRIBUTE_PROPOGATION_MODE="AUTO"
#!   FMX_INSERT_MODE="Linked by Default"
#!   HISTORY="2017-11-26,Kevin&lt;space&gt;Weller,Initial&lt;space&gt;publication&lt;semicolon&gt;&lt;space&gt;test&lt;space&gt;workspace&lt;space&gt;fails&lt;space&gt;due&lt;space&gt;to&lt;space&gt;FME&lt;space&gt;Hub&lt;space&gt;version&lt;space&gt;delay.,2017-11-30,Kevin&lt;space&gt;Weller,Enhance&lt;space&gt;stack&lt;space&gt;trace&lt;space&gt;reporting&lt;semicolon&gt;&lt;space&gt;use&lt;space&gt;truncated&lt;space&gt;test&lt;space&gt;data&lt;space&gt;and&lt;space&gt;universal&lt;space&gt;temp&lt;space&gt;directory.,2018-01-20,Kevin&lt;space&gt;Weller,Fix&lt;space&gt;absolute&lt;space&gt;parameter&lt;space&gt;name&lt;space&gt;references&lt;space&gt;from&lt;space&gt;PythonCaller&lt;space&gt;when&lt;space&gt;SQLiteServer&lt;space&gt;is&lt;space&gt;called&lt;space&gt;from&lt;space&gt;another&lt;space&gt;custom&lt;space&gt;transformer&lt;space&gt;rather&lt;space&gt;than&lt;space&gt;from&lt;space&gt;the&lt;space&gt;top-level&lt;space&gt;workspace.,2018-03-08,Kevin&lt;space&gt;Weller,Update&lt;space&gt;documentation&lt;space&gt;to&lt;space&gt;reflect&lt;space&gt;move&lt;space&gt;from&lt;space&gt;GitHub&lt;space&gt;to&lt;space&gt;Assembla&lt;space&gt;and&lt;space&gt;Atlassian.,2018-03-18,Kevin&lt;space&gt;Weller,Fix&lt;space&gt;Python&lt;space&gt;syntax&lt;space&gt;error&lt;semicolon&gt;&lt;space&gt;test&lt;space&gt;driver&lt;space&gt;failed&lt;space&gt;to&lt;space&gt;test&lt;space&gt;latest&lt;space&gt;version&lt;comma&gt;&lt;space&gt;so&lt;space&gt;it&lt;space&gt;looked&lt;space&gt;like&lt;space&gt;it&lt;space&gt;worked&lt;space&gt;10&lt;space&gt;days&lt;space&gt;ago&lt;comma&gt;&lt;space&gt;but&lt;space&gt;it&lt;space&gt;didn&lt;apos&gt;t.&lt;space&gt;&lt;amp&gt;*^*&lt;openparen&gt;^&lt;amp&gt;^&lt;openparen&gt;&lt;amp&gt;*!"
#!   ITERATION_COUNT_ATTR=""
#!   LAST_SAVE_BUILD="FME(R) 2018.0.1.0 (20180518 - Build 18310 - macosx)"
#!   LAST_SAVE_DATE="2018-07-02T17:59:27"
#!   MARKDOWN_DESCRIPTION="An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.&#10;&#10;For issues or questions, please Create an issue [here](https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues).  For the source, including test driver components, please see the [Assembla repository](https://modgeosys.assembla.com/spaces/fme-components/subversion/source).  For a list of planned improvements, see [here](https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues).&#10;&#10;Copyright &amp;copy; 2017-2018 by Modern geoSystems, released under [this BSD 3-clause license](https://modgeosys.assembla.com/spaces/fme-components/subversion/source/HEAD/LICENSE?_format=raw)."
#!   MARKDOWN_USAGE="### Ports&#10;&#10;#### Input&#10;Feed the features to be sorted here.  If the input features consist of a variety of different feature types, it would be wise to ensure the sort key fields are represented in all of them.&#10;&#10;#### Output&#10;The sorted features emerge here.&#10;&#10;### Parameters&#10;&#10;#### Sort_Keys&#10;A tab- or space-delimited table of the sort keys to be applied.  The first column contains the names of the fields to be sorted, in order of sort priority.  The second column contains the database field data type.  The third and last column specifies whether the field is to be sorted in `asc`ending or `desc`ending order, e.g.:  &#10;  &#10;   `kml_name&#9;varchar asc`  &#10;    `kml_id  varchar desc`  &#10;"
#!   MAX_LOOP_ITERATIONS=""
#!   PASSWORD=""
#!   PYTHON_COMPATIBILITY="2or3"
#!   SHOW_ANNOTATIONS="true"
#!   SHOW_INFO_NODES="true"
#!   TITLE="SQLiteSorter"
#!   USAGE="&lt;h3&gt;Ports&lt;/h3&gt;&#10;&lt;h4&gt;Input&lt;/h4&gt;&#10;&lt;p&gt;Feed the features to be sorted here.  If the input features consist of a variety of different feature types, it would be wise to ensure the sort key fields are represented in all of them.&lt;/p&gt;&#10;&lt;h4&gt;Output&lt;/h4&gt;&#10;&lt;p&gt;The sorted features emerge here.&lt;/p&gt;&#10;&lt;h3&gt;Parameters&lt;/h3&gt;&#10;&lt;h4&gt;Sort_Keys&lt;/h4&gt;&#10;&lt;p&gt;A tab- or space-delimited table of the sort keys to be applied.  The first column contains the names of the fields to be sorted, in order of sort priority.  The second column contains the database field data type.  The third and last column specifies whether the field is to be sorted in &lt;code&gt;asc&lt;/code&gt;ending or &lt;code&gt;desc&lt;/code&gt;ending order, e.g.:  &lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;kml_name    varchar asc&lt;/code&gt;&lt;br /&gt;&#10;&lt;code&gt;kml_id  varchar desc&lt;/code&gt;  &lt;/p&gt;"
#!   USE_MARKDOWN="YES"
#!   VIEW_POSITION="-684.007 456.005"
#!   WARN_INVALID_XFORM_PARAM="Yes"
#!   WORKSPACE_VERSION="1"
#!   XFORM_DEPRECATED="No"
#!   ZOOM_SCALE="100"
#! >
#! <DATASETS>
#! </DATASETS>
#! <DATA_TYPES>
#! </DATA_TYPES>
#! <GEOM_TYPES>
#! </GEOM_TYPES>
#! <FEATURE_TYPES>
#! </FEATURE_TYPES>
#! <FMESERVER>
#! </FMESERVER>
#! <GLOBAL_PARAMETERS>
#! <GLOBAL_PARAMETER
#!   GUI_LINE="GUI TEXT_EDIT_OR_ATTR Sort_Keys &quot; &quot; Sort Keys:"
#!   DEFAULT_VALUE=""
#!   IS_STAND_ALONE="true"
#! />
#! </GLOBAL_PARAMETERS>
#! <COMMENTS>
#! <COMMENT
#!   IDENTIFIER="7"
#!   COMMENT_VALUE="&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0//EN&quot; &quot;http://www.w3.org/TR/REC-html40/strict.dtd&quot;&gt;&#10;&lt;html&gt;&lt;head&gt;&lt;meta name=&quot;qrichtext&quot; content=&quot;1&quot; /&gt;&lt;style type=&quot;text/css&quot;&gt;&#10;p, li { white-space: pre-wrap; }&#10;&lt;/style&gt;&lt;/head&gt;&lt;body style=&quot; font-family:&apos;helvetica neue&apos;; font-size:13pt; font-weight:400; font-style:normal;&quot;&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;This is much easier in&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;Python than with FME&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;transformers.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;"
#!   POSITION="2552.9985299853006 303.0000300003"
#!   TOP_LEFT="2552.9985299853006 303.0000300003"
#!   BOTTOM_RIGHT="2551.9985299853006 304.0000300003"
#!   BOUNDING_RECT="2552.9985299853006 303.0000300003 -1 -1"
#!   ORDER="500000000000000"
#!   FOLLOW_ANCHOR="true"
#!   INFO_NODE="false"
#!   COLOUR="1,1,0.78431372549019607,0.19215686274509805"
#!   SIZE_POLICY="8"
#!   ANCHORED_NODE="4"
#! />
#! </COMMENTS>
#! <CONSTANTS>
#! </CONSTANTS>
#! <BOOKMARKS>
#! </BOOKMARKS>
#! <TRANSFORMERS>
#! <TRANSFORMER
#!   IDENTIFIER="4"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="2552.9985299853006 3.0000300003000007"
#!   BOUNDING_RECT="2552.9985299853006 3.0000300003000007 516.04700000000003 71"
#!   ORDER="500000000000000"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_keys" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fmeobjects&lt;lf&gt;&lt;lf&gt;import&lt;space&gt;os&lt;lf&gt;import&lt;space&gt;os.path&lt;lf&gt;import&lt;space&gt;re&lt;lf&gt;import&lt;space&gt;csv&lt;lf&gt;import&lt;space&gt;sys&lt;lf&gt;if&lt;space&gt;sys.version_info&lt;space&gt;&lt;gt&gt;&lt;space&gt;&lt;openparen&gt;3&lt;comma&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;buffer&lt;space&gt;=&lt;space&gt;memoryview&lt;lf&gt;import&lt;space&gt;random&lt;lf&gt;import&lt;space&gt;string&lt;lf&gt;import&lt;space&gt;traceback&lt;lf&gt;import&lt;space&gt;inspect&lt;lf&gt;&lt;lf&gt;import&lt;space&gt;sqlite3&lt;lf&gt;import&lt;space&gt;logging&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Random&lt;space&gt;String&lt;space&gt;Generators&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;random_string&lt;openparen&gt;size=24&lt;comma&gt;&lt;space&gt;characters=string.ascii_lowercase&lt;space&gt;+&lt;space&gt;string.digits&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;random.choice&lt;openparen&gt;characters&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;x&lt;space&gt;in&lt;space&gt;range&lt;openparen&gt;size&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;random_path&lt;openparen&gt;directory&lt;comma&gt;&lt;space&gt;prefix=&lt;quote&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;size=24&lt;comma&gt;&lt;space&gt;characters=string.ascii_lowercase&lt;space&gt;+&lt;space&gt;string.digits&lt;comma&gt;&lt;space&gt;suffix=&lt;quote&gt;&lt;quote&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;while&lt;space&gt;True:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;path&lt;space&gt;=&lt;space&gt;os.path.join&lt;openparen&gt;directory&lt;comma&gt;&lt;space&gt;prefix&lt;space&gt;+&lt;space&gt;random_string&lt;openparen&gt;size&lt;comma&gt;&lt;space&gt;characters&lt;closeparen&gt;&lt;space&gt;+&lt;space&gt;suffix&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;fd&lt;space&gt;=&lt;space&gt;os.open&lt;openparen&gt;path&lt;comma&gt;&lt;space&gt;os.O_RDONLY&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.close&lt;openparen&gt;fd&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;continue&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;OSError:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;break&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;path&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Text&lt;space&gt;Interpretation&lt;lf&gt;&lt;lf&gt;FME_TAG_CODE_TRANSLATIONS&lt;space&gt;=&lt;space&gt;&lt;opencurly&gt;&lt;apos&gt;lf&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;div.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;br.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;p.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;cr&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;r&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;space&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;tab&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;t&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;comma&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;solidus&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;solidus&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;apos&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;openparen&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;openparen&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closeparen&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;closeparen&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;openbracket&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;openbracket&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closebracket&lt;apos&gt;:&lt;space&gt;&lt;apos&gt;&lt;closebracket&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;opencurly&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;opencurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closecurly&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;closecurly&gt;&lt;apos&gt;&lt;closecurly&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;interpret_fme_character_tags&lt;openparen&gt;raw_text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;raw_text&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;fme_tag_code&lt;space&gt;in&lt;space&gt;FME_TAG_CODE_TRANSLATIONS.keys&lt;openparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;&lt;apos&gt;&lt;lt&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;fme_tag_code&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;FME_TAG_CODE_TRANSLATIONS&lt;openbracket&gt;fme_tag_code&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;result&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;result&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;sanitize_text&lt;openparen&gt;raw_text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Replace&lt;space&gt;FME&lt;space&gt;tags&lt;comma&gt;&lt;space&gt;HTML&lt;space&gt;tags&lt;space&gt;or&lt;space&gt;SQL&lt;space&gt;meta-characters&lt;space&gt;with&lt;space&gt;clean&lt;space&gt;and&lt;space&gt;safe&lt;space&gt;equivalents.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;interpret_fme_character_tags&lt;openparen&gt;raw_text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;quote&gt;&lt;apos&gt;&lt;openbracket&gt;&lt;closeparen&gt;&lt;backslash&gt;&lt;quote&gt;&lt;semicolon&gt;!=&lt;closebracket&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;SQL&lt;space&gt;metacharacters.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;lt&gt;.+?&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;all&lt;space&gt;HTML&lt;space&gt;tags.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;^&lt;gt&gt;&lt;openbracket&gt;&lt;backslash&gt;t&lt;space&gt;&lt;closebracket&gt;*&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;email&lt;space&gt;quoting&lt;space&gt;prefixes.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;result&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;extract_dict_from_tab_delimited_data&lt;openparen&gt;text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;rows&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;openbracket&gt;&lt;space&gt;&lt;backslash&gt;t&lt;closebracket&gt;+&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;&lt;backslash&gt;t&lt;quote&gt;&lt;comma&gt;&lt;space&gt;text&lt;closeparen&gt;.splitlines&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Replace&lt;space&gt;repeated&lt;space&gt;delimiter&lt;space&gt;characters&lt;space&gt;by&lt;space&gt;a&lt;space&gt;single&lt;space&gt;tab&lt;space&gt;to&lt;space&gt;simplify&lt;space&gt;extraction.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;&lt;openbracket&gt;row&lt;space&gt;for&lt;space&gt;row&lt;space&gt;in&lt;space&gt;csv.DictReader&lt;openparen&gt;rows&lt;comma&gt;&lt;space&gt;&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;type&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;ordinality&lt;apos&gt;&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;None&lt;comma&gt;&lt;space&gt;None&lt;comma&gt;&lt;space&gt;&lt;apos&gt;excel-tab&lt;apos&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Logging&lt;space&gt;Support&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FMELogFormatter&lt;openparen&gt;logging.Formatter&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;arg&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;super&lt;openparen&gt;FMELogFormatter&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.arg&lt;space&gt;=&lt;space&gt;arg&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FMELogHandler&lt;openparen&gt;logging.Handler&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;emit&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;record&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Emit&lt;space&gt;a&lt;space&gt;log&lt;space&gt;record.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger&lt;space&gt;=&lt;space&gt;fmeobjects.FMELogFile&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger.logMessageString&lt;openparen&gt;record.getMessage&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;getFMELogger&lt;openparen&gt;name&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Get&lt;space&gt;an&lt;space&gt;FME&lt;space&gt;logger.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger&lt;space&gt;=&lt;space&gt;logging.getLogger&lt;openparen&gt;name&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;formatter&lt;space&gt;=&lt;space&gt;logging.Formatter&lt;openparen&gt;&lt;quote&gt;%&lt;openparen&gt;asctime&lt;closeparen&gt;s&lt;space&gt;%&lt;openparen&gt;levelname&lt;closeparen&gt;s:&lt;space&gt;%&lt;openparen&gt;message&lt;closeparen&gt;s&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;handler&lt;space&gt;=&lt;space&gt;FMELogHandler&lt;openparen&gt;level=&lt;quote&gt;INFO&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;handler.setFormatter&lt;openparen&gt;formatter&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger.addHandler&lt;openparen&gt;handler&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;logger&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Exception&lt;solidus&gt;Error&lt;space&gt;Classes&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;MGSError&lt;openparen&gt;Exception&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;class&lt;space&gt;for&lt;space&gt;exceptions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;message&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;super&lt;openparen&gt;MGSError&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;message&lt;closeparen&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;type&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Error&lt;space&gt;type&lt;space&gt;string.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;Error&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;instructions&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Post-message&lt;space&gt;instructions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;MGSSystemError&lt;openparen&gt;MGSError&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;message&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;super&lt;openparen&gt;MGSSystemError&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;message&lt;closeparen&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;type&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Error&lt;space&gt;type&lt;space&gt;string.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;instructions&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Post-message&lt;space&gt;instructions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;FME&lt;space&gt;Template&lt;space&gt;Class&lt;space&gt;Interface&lt;lf&gt;&lt;lf&gt;TEMP&lt;space&gt;=&lt;space&gt;&lt;apos&gt;FME_SHAREDRESOURCE_TEMP&lt;apos&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Load&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;into&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;sqlite_sort_record_number&lt;apos&gt;&lt;closeparen&gt;&lt;space&gt;==&lt;space&gt;1:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;temporary&lt;space&gt;SQLite&lt;space&gt;database&lt;space&gt;and&lt;space&gt;feature&lt;space&gt;table.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db&lt;space&gt;=&lt;space&gt;None&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;keys&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;sqlite_sort_keys&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Configure&lt;space&gt;database&lt;space&gt;file&lt;space&gt;path&lt;space&gt;and&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;name.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db_path&lt;space&gt;=&lt;space&gt;random_path&lt;openparen&gt;directory=FME_MacroValues&lt;openbracket&gt;TEMP&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;prefix=&lt;apos&gt;SQLiteSorter_&lt;apos&gt;&lt;comma&gt;&lt;space&gt;suffix=&lt;apos&gt;.sqlite&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.table_name&lt;space&gt;=&lt;space&gt;&lt;apos&gt;features&lt;apos&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;SQL&lt;space&gt;DDF&lt;space&gt;key&lt;space&gt;column&lt;space&gt;definitions&lt;space&gt;from&lt;space&gt;the&lt;space&gt;Sort_Keys&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.keys&lt;space&gt;=&lt;space&gt;extract_dict_from_tab_delimited_data&lt;openparen&gt;sanitize_text&lt;openparen&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;lt&gt;apos&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;&lt;apos&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;keys&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;column_defs&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;openparen&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;type&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;temporary&lt;space&gt;database&lt;space&gt;and&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;with&lt;space&gt;a&lt;space&gt;BLOB&lt;space&gt;to&lt;space&gt;contain&lt;space&gt;the&lt;space&gt;serialized&lt;space&gt;feature.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db&lt;space&gt;=&lt;space&gt;sqlite3.connect&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.text_factory&lt;space&gt;=&lt;space&gt;str&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor&lt;space&gt;=&lt;space&gt;self.db.execute&lt;openparen&gt;&lt;quote&gt;create&lt;space&gt;table&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;column_defs&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;feature&lt;space&gt;BLOB&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;create&lt;space&gt;index&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;quote&gt;_index&lt;space&gt;on&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;asc&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;Exception&lt;space&gt;as&lt;space&gt;e:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;open&lt;space&gt;SQLite&lt;space&gt;database&lt;space&gt;&lt;quote&gt;%s&lt;quote&gt;&lt;space&gt;to&lt;space&gt;sort&lt;space&gt;records:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.db_path&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;hasattr&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;&lt;apos&gt;db&lt;apos&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Construct&lt;space&gt;insertion&lt;space&gt;statement&lt;space&gt;elements.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;key_names&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;key_placeholders&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;apos&gt;?&lt;apos&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;all_values&lt;space&gt;=&lt;space&gt;&lt;openbracket&gt;self.get_feature_attribute&lt;openparen&gt;feature&lt;comma&gt;&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;openbracket&gt;buffer&lt;openparen&gt;self.serialize_feature&lt;openparen&gt;feature&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Insert&lt;space&gt;the&lt;space&gt;feature&lt;space&gt;record&lt;space&gt;into&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;insert&lt;space&gt;into&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key_names&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;&lt;space&gt;values&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key_placeholders&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;?&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;all_values&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;store&lt;space&gt;records&lt;space&gt;in&lt;space&gt;SQLite&lt;space&gt;for&lt;space&gt;sorting:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Read&lt;space&gt;all&lt;space&gt;stored&lt;space&gt;features&lt;space&gt;from&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;in&lt;space&gt;the&lt;space&gt;requested&lt;space&gt;order.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;hasattr&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;&lt;apos&gt;db&lt;apos&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.commit&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Construct&lt;space&gt;the&lt;space&gt;ORDER&lt;space&gt;BY&lt;space&gt;clause.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;sort_defs&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;openparen&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;ordinality&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger&lt;space&gt;=&lt;space&gt;fmeobjects.FMELogFile&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger.logMessageString&lt;openparen&gt;&lt;apos&gt;sort_defs:&lt;space&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;repr&lt;openparen&gt;sort_defs&lt;closeparen&gt;&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;backslash&gt;n&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Execute&lt;space&gt;the&lt;space&gt;query&lt;space&gt;and&lt;space&gt;output&lt;space&gt;the&lt;space&gt;features&lt;space&gt;in&lt;space&gt;sorted&lt;space&gt;order&lt;comma&gt;&lt;space&gt;reconstructing&lt;space&gt;them&lt;space&gt;from&lt;space&gt;the&lt;space&gt;serialized&lt;space&gt;copy&lt;space&gt;in&lt;space&gt;the&lt;space&gt;temporary&lt;space&gt;table.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;feature_record&lt;space&gt;in&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;select&lt;space&gt;feature&lt;space&gt;from&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;order&lt;space&gt;by&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;sort_defs&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.output_feature_from_blob&lt;openparen&gt;feature_record&lt;openbracket&gt;0&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;sort&lt;space&gt;records&lt;space&gt;via&lt;space&gt;SQLite:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;finally:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Don&lt;apos&gt;t&lt;space&gt;leave&lt;space&gt;temporary&lt;space&gt;resource&lt;space&gt;files&lt;space&gt;behind.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;output_feature_from_blob&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;blob&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature&lt;space&gt;=&lt;space&gt;self.deserialize_feature&lt;openparen&gt;blob&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.output_feature&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;deserialize_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;blob&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.deserialize&lt;openparen&gt;bytearray&lt;openparen&gt;blob&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;output_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;get_feature_attribute&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;comma&gt;&lt;space&gt;feature_name&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature.getAttribute&lt;openparen&gt;feature_name&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;serialize_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature.serialize&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="SQLiteSortPythonCaller"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="8"
#!   TYPE="Counter"
#!   VERSION="2"
#!   POSITION="150 0"
#!   BOUNDING_RECT="150 0 -1 -1"
#!   ORDER="500000000000001"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="fme_rejection_code" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="CNT_ATTR" PARM_VALUE="sqlite_sort_record_number"/>
#!     <XFORM_PARM PARM_NAME="DOMAIN" PARM_VALUE="sqlite_sort_counter"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SCOPE" PARM_VALUE="Local"/>
#!     <XFORM_PARM PARM_NAME="START" PARM_VALUE="1"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Counter"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="11"
#!   TYPE="ParameterFetcher"
#!   VERSION="4"
#!   POSITION="1803.0000300002998 303.00303003030029"
#!   BOUNDING_RECT="1803.0000300002998 303.00303003030029 -1 -1"
#!   ORDER="500000000000002"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_keys" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ATTR_LIST" PARM_VALUE="sqlite_sort_keys $(Sort_Keys)"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ParameterFetcher"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="14"
#!   TYPE="Sampler"
#!   VERSION="4"
#!   POSITION="906.009060090601 -3.0000300002999438"
#!   BOUNDING_RECT="906.009060090601 -3.0000300002999438 -1 -1"
#!   ORDER="500000000000003"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="SAMPLED"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="NOT_SAMPLED"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="RATE" PARM_VALUE="1"/>
#!     <XFORM_PARM PARM_NAME="SAMPLE_MODE" PARM_VALUE="No"/>
#!     <XFORM_PARM PARM_NAME="SAMPLE_TYPE_LONG" PARM_VALUE="First N Features"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Sampler"/>
#! </TRANSFORMER>
#! </TRANSFORMERS>
#! <SUBDOCUMENT_IOS>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="2"
#!   NAME="Input"
#!   POSITION="-600 0"
#!   BOUNDING_RECT="-600 0 -1 -1"
#!   COLLAPSED="true"
#!   PUBLISHED="true"
#!   IS_SOURCE="true"
#!   ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="3"
#!   NAME="Sorted"
#!   POSITION="3302.9985299853006 3.0000300003000007"
#!   BOUNDING_RECT="3302.9985299853006 3.0000300003000007 -1 -1"
#!   COLLAPSED="true"
#!   IS_SOURCE="false"
#!   ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! </SUBDOCUMENT_IOS>
#! <FEAT_LINKS>
#! <FEAT_LINK
#!   IDENTIFIER="21"
#!   SOURCE_NODE="2"
#!   TARGET_NODE="8"
#!   SOURCE_PORT_DESC="0"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="6"
#!   SOURCE_NODE="4"
#!   TARGET_NODE="3"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="0"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="15"
#!   SOURCE_NODE="8"
#!   TARGET_NODE="14"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="13"
#!   SOURCE_NODE="11"
#!   TARGET_NODE="4"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="16"
#!   SOURCE_NODE="14"
#!   TARGET_NODE="11"
#!   SOURCE_PORT_DESC="fo 0 SAMPLED"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="17"
#!   SOURCE_NODE="14"
#!   TARGET_NODE="4"
#!   SOURCE_PORT_DESC="fo 1 NOT_SAMPLED"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! </FEAT_LINKS>
#! <BREAKPOINTS>
#! </BREAKPOINTS>
#! <ATTR_LINKS>
#! </ATTR_LINKS>
#! <SUBDOCUMENTS>
#! </SUBDOCUMENTS>
#! <LOOKUP_TABLES>
#! </LOOKUP_TABLES>
#! </TRANSFORMER>
FME_PYTHON_VERSION 2or3
DEFAULT_MACRO $(SQLiteSorter_WORKSPACE_NAME)_Sort_Keys 
#! START_HEADER
#! END_HEADER

LOG_TIMINGS YES
LOG_FILTER_MASK -1
DEFAULT_MACRO WB_CURRENT_CONTEXT
DEFAULT_MACRO SQLiteSorter_WORKSPACE_NAME ""
INCLUDE [puts {MACRO WB_OLD_CONTEXT_$(SQLiteSorter_WORKSPACE_NAME) $(WB_CURRENT_CONTEXT)};          puts {MACRO WB_CURRENT_CONTEXT $(SQLiteSorter_WORKSPACE_NAME)}]
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Input1530575967 Input Splitter"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"   OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"
# -------------------------------------------------------------------------

# Create the DomainName that this transformer will use.
# Because @Count itself will evalute the expression to calculate the
# domain, we don't need to do anything in Tcl per feature going by

INCLUDE [    set domainPrefix {};    if { {Local} == {Local} }    {       set domainPrefix [FME_EncodeText {$(SQLiteSorter_WORKSPACE_NAME)_Counter_}];    };    puts "MACRO $(SQLiteSorter_WORKSPACE_NAME)_Counter_FULL_DOMAIN ${domainPrefix}sqlite_sort_counter"; ]
FACTORY_DEF * ExecuteFunctionFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Counter_Rejector    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"    FUNCTION_DEFINITION @Count(REJECTABLE_WITH_FLAG,fme_encoded,$($(SQLiteSorter_WORKSPACE_NAME)_Counter_FULL_DOMAIN),"1")    RESULT_ATTRIBUTE "sqlite_sort_record_number"    OUTPUT COMPLETE FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_OUTPUT"    OUTPUT REJECTED FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_<REJECTED>"

FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Counter <REJECTED> Transformer Output Nuker"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_<REJECTED>"
# -------------------------------------------------------------------------

# If we're doing LAST N features, then the multiplier comes in as 0.
# If we're doing First N, multiplier is -1.
# For RANDOM, we need to treat LAST N as if it was first N (i.e. have a -1)
# That is what the ? : does in the rate multiplier.

INCLUDE [ if { {-1} == {0} && {ORIGINAL} == {ORIGINAL} } {              puts "MACRO REAL_MODE LAST"; 	         puts "MACRO REAL_RATE 1"; 	      } else {              puts "MACRO REAL_MODE ORIGINAL";              puts "MACRO REAL_RATE [expr 1 * ( -1 ? -1 : -1 ) ]"; 	      } ]
FACTORY_DEF {*} SamplingFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Sampler    COMMAND_PARM_EVALUATION SINGLE_PASS    SAMPLE_RATE $(REAL_RATE)    SAMPLE_ORDER $(REAL_MODE)    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_OUTPUT"    OUTPUT SAMPLED FEATURE_TYPE ___SAMPLED___    OUTPUT NOT_SAMPLED FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_NOT_SAMPLED"
# This TeeFactory is needed because Sampler will still output features if it has no OUTPUT clauses specified.
# This way we behave nicely even if there are no output connections on the transformer. See PR#28886.

FACTORY_DEF * TeeFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Sampler_Sampled    INPUT FEATURE_TYPE ___SAMPLED___    OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_SAMPLED"


# -------------------------------------------------------------------------

Tcl2 proc $(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_doFetch {} {    foreach {name val} {"sqlite_sort_keys {$($(SQLiteSorter_WORKSPACE_NAME)_Sort_Keys)}"} {         if { [string match {*<at>*} $val] == 1 } {             set val [FME_Execute EvaluateExpression {STRING} $val {$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher}];         } elseif {[string match {*FME_CONDITIONAL*} $val] == 1} {             set val [FME_Execute EvaluateExpression {STRING} $val {$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher}];         } else {             set val [FME_DecodeTextOrAttr $val];         };       FME_SetAttribute [FME_DecodeText $name] $val    } }
FACTORY_DEF * TeeFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_SAMPLED"    OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_OUTPUT"         @Tcl2($(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_doFetch)

# -------------------------------------------------------------------------


FME_PYTHON_PATH "$(FME_MF_DIR)"

FACTORY_DEF * PythonFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_OUTPUT"    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_NOT_SAMPLED"    SYMBOL_NAME FeatureProcessor    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE import<space>fmeobjects<lf><lf>import<space>os<lf>import<space>os.path<lf>import<space>re<lf>import<space>csv<lf>import<space>sys<lf>if<space>sys.version_info<space><gt><space><openparen>3<comma><closeparen>:<lf><space><space><space><space>buffer<space>=<space>memoryview<lf>import<space>random<lf>import<space>string<lf>import<space>traceback<lf>import<space>inspect<lf><lf>import<space>sqlite3<lf>import<space>logging<lf><lf><lf><lf>#<space>Random<space>String<space>Generators<lf><lf>def<space>random_string<openparen>size=24<comma><space>characters=string.ascii_lowercase<space>+<space>string.digits<closeparen>:<lf><space><space><space><space>return<space><apos><apos>.join<openparen>random.choice<openparen>characters<closeparen><space>for<space>x<space>in<space>range<openparen>size<closeparen><closeparen><lf><lf><lf>def<space>random_path<openparen>directory<comma><space>prefix=<quote><quote><comma><space>size=24<comma><space>characters=string.ascii_lowercase<space>+<space>string.digits<comma><space>suffix=<quote><quote><closeparen>:<lf><space><space><space><space>while<space>True:<lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>path<space>=<space>os.path.join<openparen>directory<comma><space>prefix<space>+<space>random_string<openparen>size<comma><space>characters<closeparen><space>+<space>suffix<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>fd<space>=<space>os.open<openparen>path<comma><space>os.O_RDONLY<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>os.close<openparen>fd<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>continue<lf><space><space><space><space><space><space><space><space>except<space>OSError:<lf><space><space><space><space><space><space><space><space><space><space><space><space>break<lf><space><space><space><space>return<space>path<lf><lf><lf><lf>#<space>Text<space>Interpretation<lf><lf>FME_TAG_CODE_TRANSLATIONS<space>=<space><opencurly><apos>lf<apos>:<space><space><space><space><space><space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>div.*?<apos>:<space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>br.*?<apos>:<space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>p.*?<apos>:<space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>cr<apos>:<space><space><space><space><space><space><space><space><space><space><space><apos><backslash>r<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>space<apos>:<space><space><space><space><space><space><space><space><apos><space><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>tab<apos>:<space><space><space><space><space><space><space><space><space><space><apos><backslash>t<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>comma<apos>:<space><space><space><space><space><space><space><space><apos><comma><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>solidus<apos>:<space><space><space><space><space><space><apos><solidus><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>apos<apos>:<space><space><space><space><space><space><space><space><space><apos><comma><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>openparen<apos>:<space><space><space><space><apos><openparen><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closeparen<apos>:<space><space><space><apos><closeparen><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>openbracket<apos>:<space><space><apos><openbracket><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closebracket<apos>:<space><apos><closebracket><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>opencurly<apos>:<space><space><space><space><apos><opencurly><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closecurly<apos>:<space><space><space><apos><closecurly><apos><closecurly><lf><lf>def<space>interpret_fme_character_tags<openparen>raw_text<closeparen>:<lf><space><space><space><space>result<space>=<space>raw_text<lf><space><space><space><space>for<space>fme_tag_code<space>in<space>FME_TAG_CODE_TRANSLATIONS.keys<openparen><closeparen>:<lf><space><space><space><space><space><space><space><space>result<space>=<space>re.sub<openparen><apos><lt><apos><space>+<space>fme_tag_code<space>+<space><apos><gt><apos><comma><space>FME_TAG_CODE_TRANSLATIONS<openbracket>fme_tag_code<closebracket><comma><space>result<closeparen><lf><space><space><space><space>return<space>result<lf><lf>def<space>sanitize_text<openparen>raw_text<closeparen>:<lf><space><space><space><space><quote><quote><quote>Replace<space>FME<space>tags<comma><space>HTML<space>tags<space>or<space>SQL<space>meta-characters<space>with<space>clean<space>and<space>safe<space>equivalents.<quote><quote><quote><lf><space><space><space><space>result<space>=<space>interpret_fme_character_tags<openparen>raw_text<closeparen><lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<quote><apos><openbracket><closeparen><backslash><quote><semicolon>!=<closebracket><quote><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space>#<space>Sanitize<space>SQL<space>metacharacters.<lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<apos><lt>.+?<gt><apos><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space><space><space><space><space>#<space>Sanitize<space>all<space>HTML<space>tags.<lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<apos>^<gt><openbracket><backslash>t<space><closebracket>*<apos><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space><space>#<space>Sanitize<space>email<space>quoting<space>prefixes.<lf><space><space><space><space>return<space>result<lf><lf>def<space>extract_dict_from_tab_delimited_data<openparen>text<closeparen>:<lf><space><space><space><space>rows<space>=<space>re.sub<openparen>r<apos><openbracket><space><backslash>t<closebracket>+<apos><comma><space><quote><backslash>t<quote><comma><space>text<closeparen>.splitlines<openparen><closeparen><space><space>#<space>Replace<space>repeated<space>delimiter<space>characters<space>by<space>a<space>single<space>tab<space>to<space>simplify<space>extraction.<lf><space><space><space><space>return<space><openbracket>row<space>for<space>row<space>in<space>csv.DictReader<openparen>rows<comma><space><openbracket><apos>name<apos><comma><space><apos>type<apos><comma><space><apos>ordinality<apos><closebracket><comma><space>None<comma><space>None<comma><space><apos>excel-tab<apos><closeparen><closebracket><lf><lf><lf><lf>#<space>Logging<space>Support<lf><lf>class<space>FMELogFormatter<openparen>logging.Formatter<closeparen>:<lf><space><space><space><space>def<space>__init__<openparen>self<comma><space>arg<closeparen>:<lf><space><space><space><space><space><space><space><space>super<openparen>FMELogFormatter<comma><space>self<closeparen>.__init__<openparen><closeparen><lf><space><space><space><space><space><space><space><space>self.arg<space>=<space>arg<lf><lf><lf>class<space>FMELogHandler<openparen>logging.Handler<closeparen>:<lf><space><space><space><space>def<space>emit<openparen>self<comma><space>record<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Emit<space>a<space>log<space>record.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>logger<space>=<space>fmeobjects.FMELogFile<openparen><closeparen><lf><space><space><space><space><space><space><space><space>logger.logMessageString<openparen>record.getMessage<openparen><closeparen><closeparen><lf><lf>def<space>getFMELogger<openparen>name<closeparen>:<lf><space><space><space><space><quote><quote><quote>Get<space>an<space>FME<space>logger.<quote><quote><quote><lf><space><space><space><space>logger<space>=<space>logging.getLogger<openparen>name<closeparen><lf><space><space><space><space>formatter<space>=<space>logging.Formatter<openparen><quote>%<openparen>asctime<closeparen>s<space>%<openparen>levelname<closeparen>s:<space>%<openparen>message<closeparen>s<quote><closeparen><lf><space><space><space><space>handler<space>=<space>FMELogHandler<openparen>level=<quote>INFO<quote><closeparen><lf><space><space><space><space>handler.setFormatter<openparen>formatter<closeparen><lf><space><space><space><space>logger.addHandler<openparen>handler<closeparen><lf><space><space><space><space>return<space>logger<lf><lf><lf><lf>#<space>Exception<solidus>Error<space>Classes<lf><lf>class<space>MGSError<openparen>Exception<closeparen>:<lf><tab><quote><quote><quote>Base<space>class<space>for<space>exceptions.<quote><quote><quote><lf><tab><lf><tab>def<space>__init__<openparen>self<comma><space>message<closeparen>:<lf><tab><tab>super<openparen>MGSError<comma><space>self<closeparen>.__init__<openparen>message<closeparen><lf><tab><lf><tab>def<space>type<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Error<space>type<space>string.<quote><quote><quote><lf><tab><tab>return<space><quote>Error<quote><lf><tab><lf><tab>def<space>instructions<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Post-message<space>instructions.<quote><quote><quote><lf><tab><tab>return<space><quote><quote><quote>Please<space>try<space>again.<quote><quote><quote><lf><lf>class<space>MGSSystemError<openparen>MGSError<closeparen>:<lf><tab><lf><tab>def<space>__init__<openparen>self<comma><space>message<closeparen>:<lf><tab><tab>super<openparen>MGSSystemError<comma><space>self<closeparen>.__init__<openparen>message<closeparen><lf><tab><lf><tab>def<space>type<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Error<space>type<space>string.<quote><quote><quote><lf><tab><tab>return<space><quote>Unexpected<space>System<space>Error<quote><lf><tab><lf><tab>def<space>instructions<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Post-message<space>instructions.<quote><quote><quote><lf><tab><tab>return<space><quote><quote><quote>Please<space>try<space>again.<quote><quote><quote><lf><lf><lf><lf>#<space>FME<space>Template<space>Class<space>Interface<lf><lf>TEMP<space>=<space><apos>FME_SHAREDRESOURCE_TEMP<apos><lf><lf>class<space>FeatureProcessor:<lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Load<space>a<space>feature<space>into<space>the<space>sort<space>table.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>feature.getAttribute<openparen><apos>sqlite_sort_record_number<apos><closeparen><space>==<space>1:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>temporary<space>SQLite<space>database<space>and<space>feature<space>table.<quote><quote><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db<space>=<space>None<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>keys<space>=<space>feature.getAttribute<openparen><apos>sqlite_sort_keys<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Configure<space>database<space>file<space>path<space>and<space>sort<space>table<space>name.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db_path<space>=<space>random_path<openparen>directory=FME_MacroValues<openbracket>TEMP<closebracket><comma><space>prefix=<apos>SQLiteSorter_<apos><comma><space>suffix=<apos>.sqlite<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.table_name<space>=<space><apos>features<apos><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>SQL<space>DDF<space>key<space>column<space>definitions<space>from<space>the<space>Sort_Keys<space>parameter.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.keys<space>=<space>extract_dict_from_tab_delimited_data<openparen>sanitize_text<openparen>re.sub<openparen>r<apos><lt>apos<gt><apos><comma><space><quote><apos><quote><comma><space>keys<closeparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>column_defs<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><openparen>key<openbracket><apos>name<apos><closebracket><space>+<space><apos><space><apos><space>+<space>key<openbracket><apos>type<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>temporary<space>database<space>and<space>sort<space>table<space>with<space>a<space>BLOB<space>to<space>contain<space>the<space>serialized<space>feature.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db<space>=<space>sqlite3.connect<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.text_factory<space>=<space>str<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor<space>=<space>self.db.execute<openparen><quote>create<space>table<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>column_defs<space>+<space><quote><comma><space>feature<space>BLOB<closeparen><semicolon><quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>for<space>key<space>in<space>self.keys:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.execute<openparen><quote>create<space>index<space><quote><space>+<space>key<openbracket><apos>name<apos><closebracket><space>+<space><quote>_index<space>on<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>key<openbracket><apos>name<apos><closebracket><space>+<space><quote><space>asc<closeparen><semicolon><quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>except<space>Exception<space>as<space>e:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>open<space>SQLite<space>database<space><quote>%s<quote><space>to<space>sort<space>records:<space>%s<backslash>n%s<apos><comma><space>self.db_path<comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>if<space>hasattr<openparen>self<comma><space><apos>db<apos><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Construct<space>insertion<space>statement<space>elements.<lf><space><space><space><space><space><space><space><space><space><space><space><space>key_names<space>=<space><apos><comma><space><apos>.join<openparen><openbracket>key<openbracket><apos>name<apos><closebracket><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>key_placeholders<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><apos>?<apos><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>all_values<space>=<space><openbracket>self.get_feature_attribute<openparen>feature<comma><space>key<openbracket><apos>name<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><space>+<space><openbracket>buffer<openparen>self.serialize_feature<openparen>feature<closeparen><closeparen><closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Insert<space>the<space>feature<space>record<space>into<space>the<space>sort<space>table.<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.execute<openparen><quote>insert<space>into<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>key_names<space>+<space><quote><comma><space>feature<closeparen><space>values<space><openparen><quote><space>+<space>key_placeholders<space>+<space><quote><comma><space>?<closeparen><semicolon><quote><comma><space>all_values<closeparen><lf><space><space><space><space><space><space><space><space>except:<lf><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>store<space>records<space>in<space>SQLite<space>for<space>sorting:<space>%s<backslash>n%s<apos><comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Read<space>all<space>stored<space>features<space>from<space>the<space>sort<space>table<space>in<space>the<space>requested<space>order.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>hasattr<openparen>self<comma><space><apos>db<apos><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.commit<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Construct<space>the<space>ORDER<space>BY<space>clause.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>sort_defs<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><openparen>key<openbracket><apos>name<apos><closebracket><space>+<space><apos><space><apos><space>+<space>key<openbracket><apos>ordinality<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>logger<space>=<space>fmeobjects.FMELogFile<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>logger.logMessageString<openparen><apos>sort_defs:<space><apos><space>+<space>repr<openparen>sort_defs<closeparen><space>+<space><quote><backslash>n<quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Execute<space>the<space>query<space>and<space>output<space>the<space>features<space>in<space>sorted<space>order<comma><space>reconstructing<space>them<space>from<space>the<space>serialized<space>copy<space>in<space>the<space>temporary<space>table.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>for<space>feature_record<space>in<space>self.cursor.execute<openparen><quote>select<space>feature<space>from<space><quote><space>+<space>self.table_name<space>+<space><quote><space>order<space>by<space><quote><space>+<space>sort_defs<space>+<space><quote><semicolon><quote><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.output_feature_from_blob<openparen>feature_record<openbracket>0<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>except:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>sort<space>records<space>via<space>SQLite:<space>%s<backslash>n%s<apos><comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>finally:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Don<apos>t<space>leave<space>temporary<space>resource<space>files<space>behind.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><lf><space><space><space><space>def<space>output_feature_from_blob<openparen>self<comma><space>blob<closeparen>:<lf><space><space><space><space><space><space><space><space>feature<space>=<space>self.deserialize_feature<openparen>blob<closeparen><lf><space><space><space><space><space><space><space><space>self.output_feature<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>deserialize_feature<openparen>self<comma><space>blob<closeparen>:<lf><space><space><space><space><space><space><space><space>feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space>feature.deserialize<openparen>bytearray<openparen>blob<closeparen><closeparen><lf><space><space><space><space><space><space><space><space>return<space>feature<lf><lf><space><space><space><space>def<space>output_feature<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>get_feature_attribute<openparen>self<comma><space>feature<comma><space>feature_name<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space>feature.getAttribute<openparen>feature_name<closeparen><lf><lf><space><space><space><space>def<space>serialize_feature<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space>feature.serialize<openparen><closeparen><lf>    OUTPUT PYOUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller_OUTPUT"

FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Sorted1530575967 Output Collector"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller_OUTPUT"   OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sorted"
INCLUDE [puts {MACRO WB_CURRENT_CONTEXT $(WB_OLD_CONTEXT_$(SQLiteSorter_WORKSPACE_NAME))}]
#! <?xml version="1.0" encoding="UTF-8" ?>
#! <TRANSFORMER
# TRANSFORMER_BEGIN SQLiteSorter,3,Workflows,4c5d6153-fdd8-4f3a-b0bd-93713146856c,"Linked by Default",No,NO_PARALLELISM,,No,18310,YES,No,2or3
# <p>An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.</p>
# <p>For issues or questions, please Create an issue <a href="https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues">here</a>.  For the source, including test driver components, please see the <a href="https://modgeosys.assembla.com/spaces/fme-components/subversion/source">Assembla repository</a>.  For a list of planned improvements, see <a href="https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues">here</a>.</p>
# <p>Copyright &copy; 2017-2018 by Modern geoSystems, released under <a href="https://modgeosys.assembla.com/spaces/fme-components/subversion/source/HEAD/LICENSE?_format=raw">this BSD 3-clause license</a>.</p>
# TRANSFORMER_END
#!   ATTR_TYPE_ENCODING="SDF"
#!   BLOCKED_LOOPING="No"
#!   CATEGORY="Workflows"
#!   DESCRIPTION="&lt;p&gt;An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.&lt;/p&gt;&#10;&lt;p&gt;For issues or questions, please Create an issue &lt;a href=&quot;https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues&quot;&gt;here&lt;/a&gt;.  For the source, including test driver components, please see the &lt;a href=&quot;https://modgeosys.assembla.com/spaces/fme-components/subversion/source&quot;&gt;Assembla repository&lt;/a&gt;.  For a list of planned improvements, see &lt;a href=&quot;https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;&#10;&lt;p&gt;Copyright &amp;copy; 2017-2018 by Modern geoSystems, released under &lt;a href=&quot;https://modgeosys.assembla.com/spaces/fme-components/subversion/source/HEAD/LICENSE?_format=raw&quot;&gt;this BSD 3-clause license&lt;/a&gt;.&lt;/p&gt;"
#!   DOC_EXTENTS="3903 371.003"
#!   DOC_TOP_LEFT="-600 -68"
#!   EXPLICIT_BOOKMARK_ORDER="false"
#!   FME_BUILD_NUM="18310"
#!   FME_DOCUMENT_GUID="4c5d6153-fdd8-4f3a-b0bd-93713146856c"
#!   FME_DOCUMENT_PRIORGUID=""
#!   FME_LINKED_TRANSFORMER_VERSION="3"
#!   FME_PROCESS_COUNT="NO_PARALLELISM"
#!   FME_PROCESS_GROUPS_ORDERED="No"
#!   FME_PROCESS_GROUP_BY=""
#!   FME_SERVER_SERVICES=""
#!   FMX_ATTRIBUTE_PROPOGATION_MODE="AUTO"
#!   FMX_INSERT_MODE="Linked by Default"
#!   HISTORY="2017-11-26,Kevin&lt;space&gt;Weller,Initial&lt;space&gt;publication&lt;semicolon&gt;&lt;space&gt;test&lt;space&gt;workspace&lt;space&gt;fails&lt;space&gt;due&lt;space&gt;to&lt;space&gt;FME&lt;space&gt;Hub&lt;space&gt;version&lt;space&gt;delay.,2017-11-30,Kevin&lt;space&gt;Weller,Enhance&lt;space&gt;stack&lt;space&gt;trace&lt;space&gt;reporting&lt;semicolon&gt;&lt;space&gt;use&lt;space&gt;truncated&lt;space&gt;test&lt;space&gt;data&lt;space&gt;and&lt;space&gt;universal&lt;space&gt;temp&lt;space&gt;directory.,2018-01-20,Kevin&lt;space&gt;Weller,Fix&lt;space&gt;absolute&lt;space&gt;parameter&lt;space&gt;name&lt;space&gt;references&lt;space&gt;from&lt;space&gt;PythonCaller&lt;space&gt;when&lt;space&gt;SQLiteServer&lt;space&gt;is&lt;space&gt;called&lt;space&gt;from&lt;space&gt;another&lt;space&gt;custom&lt;space&gt;transformer&lt;space&gt;rather&lt;space&gt;than&lt;space&gt;from&lt;space&gt;the&lt;space&gt;top-level&lt;space&gt;workspace.,2018-03-08,Kevin&lt;space&gt;Weller,Update&lt;space&gt;documentation&lt;space&gt;to&lt;space&gt;reflect&lt;space&gt;move&lt;space&gt;from&lt;space&gt;GitHub&lt;space&gt;to&lt;space&gt;Assembla&lt;space&gt;and&lt;space&gt;Atlassian.,2018-03-18,Kevin&lt;space&gt;Weller,Fix&lt;space&gt;Python&lt;space&gt;syntax&lt;space&gt;error&lt;semicolon&gt;&lt;space&gt;test&lt;space&gt;driver&lt;space&gt;failed&lt;space&gt;to&lt;space&gt;test&lt;space&gt;latest&lt;space&gt;version&lt;comma&gt;&lt;space&gt;so&lt;space&gt;it&lt;space&gt;looked&lt;space&gt;like&lt;space&gt;it&lt;space&gt;worked&lt;space&gt;10&lt;space&gt;days&lt;space&gt;ago&lt;comma&gt;&lt;space&gt;but&lt;space&gt;it&lt;space&gt;didn&lt;apos&gt;t.&lt;space&gt;&lt;amp&gt;*^*&lt;openparen&gt;^&lt;amp&gt;^&lt;openparen&gt;&lt;amp&gt;*!"
#!   ITERATION_COUNT_ATTR=""
#!   LAST_SAVE_BUILD="FME(R) 2018.0.1.0 (20180518 - Build 18310 - macosx)"
#!   LAST_SAVE_DATE="2018-07-02T17:58:25"
#!   MARKDOWN_DESCRIPTION="An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.&#10;&#10;For issues or questions, please Create an issue [here](https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues).  For the source, including test driver components, please see the [Assembla repository](https://modgeosys.assembla.com/spaces/fme-components/subversion/source).  For a list of planned improvements, see [here](https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues).&#10;&#10;Copyright &amp;copy; 2017-2018 by Modern geoSystems, released under [this BSD 3-clause license](https://modgeosys.assembla.com/spaces/fme-components/subversion/source/HEAD/LICENSE?_format=raw)."
#!   MARKDOWN_USAGE="### Ports&#10;&#10;#### Input&#10;Feed the features to be sorted here.  If the input features consist of a variety of different feature types, it would be wise to ensure the sort key fields are represented in all of them.&#10;&#10;#### Output&#10;The sorted features emerge here.&#10;&#10;### Parameters&#10;&#10;#### Sort_Keys&#10;A tab- or space-delimited table of the sort keys to be applied.  The first column contains the names of the fields to be sorted, in order of sort priority.  The second column contains the database field data type.  The third and last column specifies whether the field is to be sorted in `asc`ending or `desc`ending order, e.g.:  &#10;  &#10;   `kml_name&#9;varchar asc`  &#10;    `kml_id  varchar desc`  &#10;"
#!   MAX_LOOP_ITERATIONS=""
#!   PASSWORD=""
#!   PYTHON_COMPATIBILITY="2or3"
#!   SHOW_ANNOTATIONS="true"
#!   SHOW_INFO_NODES="true"
#!   TITLE="SQLiteSorter"
#!   USAGE="&lt;h3&gt;Ports&lt;/h3&gt;&#10;&lt;h4&gt;Input&lt;/h4&gt;&#10;&lt;p&gt;Feed the features to be sorted here.  If the input features consist of a variety of different feature types, it would be wise to ensure the sort key fields are represented in all of them.&lt;/p&gt;&#10;&lt;h4&gt;Output&lt;/h4&gt;&#10;&lt;p&gt;The sorted features emerge here.&lt;/p&gt;&#10;&lt;h3&gt;Parameters&lt;/h3&gt;&#10;&lt;h4&gt;Sort_Keys&lt;/h4&gt;&#10;&lt;p&gt;A tab- or space-delimited table of the sort keys to be applied.  The first column contains the names of the fields to be sorted, in order of sort priority.  The second column contains the database field data type.  The third and last column specifies whether the field is to be sorted in &lt;code&gt;asc&lt;/code&gt;ending or &lt;code&gt;desc&lt;/code&gt;ending order, e.g.:  &lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;kml_name    varchar asc&lt;/code&gt;&lt;br /&gt;&#10;&lt;code&gt;kml_id  varchar desc&lt;/code&gt;  &lt;/p&gt;"
#!   USE_MARKDOWN="YES"
#!   VIEW_POSITION="-684.007 456.005"
#!   WARN_INVALID_XFORM_PARAM="Yes"
#!   WORKSPACE_VERSION="1"
#!   XFORM_DEPRECATED="No"
#!   ZOOM_SCALE="100"
#! >
#! <DATASETS>
#! </DATASETS>
#! <DATA_TYPES>
#! </DATA_TYPES>
#! <GEOM_TYPES>
#! </GEOM_TYPES>
#! <FEATURE_TYPES>
#! </FEATURE_TYPES>
#! <FMESERVER>
#! </FMESERVER>
#! <GLOBAL_PARAMETERS>
#! <GLOBAL_PARAMETER
#!   GUI_LINE="GUI TEXT_EDIT_OR_ATTR Sort_Keys &quot; &quot; Sort Keys:"
#!   DEFAULT_VALUE=""
#!   IS_STAND_ALONE="true"
#! />
#! </GLOBAL_PARAMETERS>
#! <COMMENTS>
#! <COMMENT
#!   IDENTIFIER="7"
#!   COMMENT_VALUE="&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0//EN&quot; &quot;http://www.w3.org/TR/REC-html40/strict.dtd&quot;&gt;&#10;&lt;html&gt;&lt;head&gt;&lt;meta name=&quot;qrichtext&quot; content=&quot;1&quot; /&gt;&lt;style type=&quot;text/css&quot;&gt;&#10;p, li { white-space: pre-wrap; }&#10;&lt;/style&gt;&lt;/head&gt;&lt;body style=&quot; font-family:&apos;helvetica neue&apos;; font-size:13pt; font-weight:400; font-style:normal;&quot;&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;This is much easier in&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;Python than with FME&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;transformers.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;"
#!   POSITION="2552.9985299853006 303.0000300003"
#!   TOP_LEFT="2552.9985299853006 303.0000300003"
#!   BOTTOM_RIGHT="2551.9985299853006 304.0000300003"
#!   BOUNDING_RECT="2552.9985299853006 303.0000300003 -1 -1"
#!   ORDER="500000000000000"
#!   FOLLOW_ANCHOR="true"
#!   INFO_NODE="false"
#!   COLOUR="1,1,0.78431372549019607,0.19215686274509805"
#!   SIZE_POLICY="8"
#!   ANCHORED_NODE="4"
#! />
#! </COMMENTS>
#! <CONSTANTS>
#! </CONSTANTS>
#! <BOOKMARKS>
#! </BOOKMARKS>
#! <TRANSFORMERS>
#! <TRANSFORMER
#!   IDENTIFIER="4"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="2552.9985299853006 3.0000300003000007"
#!   BOUNDING_RECT="2552.9985299853006 3.0000300003000007 516.04700000000003 71"
#!   ORDER="500000000000000"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_keys" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fmeobjects&lt;lf&gt;&lt;lf&gt;import&lt;space&gt;os&lt;lf&gt;import&lt;space&gt;os.path&lt;lf&gt;import&lt;space&gt;re&lt;lf&gt;import&lt;space&gt;csv&lt;lf&gt;import&lt;space&gt;sys&lt;lf&gt;if&lt;space&gt;sys.version_info&lt;space&gt;&lt;gt&gt;&lt;space&gt;&lt;openparen&gt;3&lt;comma&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;buffer&lt;space&gt;=&lt;space&gt;memoryview&lt;lf&gt;import&lt;space&gt;random&lt;lf&gt;import&lt;space&gt;string&lt;lf&gt;import&lt;space&gt;traceback&lt;lf&gt;import&lt;space&gt;inspect&lt;lf&gt;&lt;lf&gt;import&lt;space&gt;sqlite3&lt;lf&gt;import&lt;space&gt;logging&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Random&lt;space&gt;String&lt;space&gt;Generators&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;random_string&lt;openparen&gt;size=24&lt;comma&gt;&lt;space&gt;characters=string.ascii_lowercase&lt;space&gt;+&lt;space&gt;string.digits&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;random.choice&lt;openparen&gt;characters&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;x&lt;space&gt;in&lt;space&gt;range&lt;openparen&gt;size&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;random_path&lt;openparen&gt;directory&lt;comma&gt;&lt;space&gt;prefix=&lt;quote&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;size=24&lt;comma&gt;&lt;space&gt;characters=string.ascii_lowercase&lt;space&gt;+&lt;space&gt;string.digits&lt;comma&gt;&lt;space&gt;suffix=&lt;quote&gt;&lt;quote&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;while&lt;space&gt;True:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;path&lt;space&gt;=&lt;space&gt;os.path.join&lt;openparen&gt;directory&lt;comma&gt;&lt;space&gt;prefix&lt;space&gt;+&lt;space&gt;random_string&lt;openparen&gt;size&lt;comma&gt;&lt;space&gt;characters&lt;closeparen&gt;&lt;space&gt;+&lt;space&gt;suffix&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;fd&lt;space&gt;=&lt;space&gt;os.open&lt;openparen&gt;path&lt;comma&gt;&lt;space&gt;os.O_RDONLY&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.close&lt;openparen&gt;fd&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;continue&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;OSError:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;break&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;path&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Text&lt;space&gt;Interpretation&lt;lf&gt;&lt;lf&gt;FME_TAG_CODE_TRANSLATIONS&lt;space&gt;=&lt;space&gt;&lt;opencurly&gt;&lt;apos&gt;lf&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;div.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;br.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;p.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;cr&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;r&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;space&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;tab&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;t&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;comma&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;solidus&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;solidus&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;apos&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;openparen&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;openparen&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closeparen&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;closeparen&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;openbracket&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;openbracket&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closebracket&lt;apos&gt;:&lt;space&gt;&lt;apos&gt;&lt;closebracket&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;opencurly&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;opencurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closecurly&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;closecurly&gt;&lt;apos&gt;&lt;closecurly&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;interpret_fme_character_tags&lt;openparen&gt;raw_text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;raw_text&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;fme_tag_code&lt;space&gt;in&lt;space&gt;FME_TAG_CODE_TRANSLATIONS.keys&lt;openparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;&lt;apos&gt;&lt;lt&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;fme_tag_code&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;FME_TAG_CODE_TRANSLATIONS&lt;openbracket&gt;fme_tag_code&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;result&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;result&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;sanitize_text&lt;openparen&gt;raw_text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Replace&lt;space&gt;FME&lt;space&gt;tags&lt;comma&gt;&lt;space&gt;HTML&lt;space&gt;tags&lt;space&gt;or&lt;space&gt;SQL&lt;space&gt;meta-characters&lt;space&gt;with&lt;space&gt;clean&lt;space&gt;and&lt;space&gt;safe&lt;space&gt;equivalents.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;interpret_fme_character_tags&lt;openparen&gt;raw_text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;quote&gt;&lt;apos&gt;&lt;openbracket&gt;&lt;closeparen&gt;&lt;backslash&gt;&lt;quote&gt;&lt;semicolon&gt;!=&lt;closebracket&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;SQL&lt;space&gt;metacharacters.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;lt&gt;.+?&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;all&lt;space&gt;HTML&lt;space&gt;tags.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;^&lt;gt&gt;&lt;openbracket&gt;&lt;backslash&gt;t&lt;space&gt;&lt;closebracket&gt;*&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;email&lt;space&gt;quoting&lt;space&gt;prefixes.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;result&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;extract_dict_from_tab_delimited_data&lt;openparen&gt;text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;rows&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;openbracket&gt;&lt;space&gt;&lt;backslash&gt;t&lt;closebracket&gt;+&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;&lt;backslash&gt;t&lt;quote&gt;&lt;comma&gt;&lt;space&gt;text&lt;closeparen&gt;.splitlines&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Replace&lt;space&gt;repeated&lt;space&gt;delimiter&lt;space&gt;characters&lt;space&gt;by&lt;space&gt;a&lt;space&gt;single&lt;space&gt;tab&lt;space&gt;to&lt;space&gt;simplify&lt;space&gt;extraction.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;&lt;openbracket&gt;row&lt;space&gt;for&lt;space&gt;row&lt;space&gt;in&lt;space&gt;csv.DictReader&lt;openparen&gt;rows&lt;comma&gt;&lt;space&gt;&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;type&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;ordinality&lt;apos&gt;&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;None&lt;comma&gt;&lt;space&gt;None&lt;comma&gt;&lt;space&gt;&lt;apos&gt;excel-tab&lt;apos&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Logging&lt;space&gt;Support&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FMELogFormatter&lt;openparen&gt;logging.Formatter&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;arg&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;super&lt;openparen&gt;FMELogFormatter&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.arg&lt;space&gt;=&lt;space&gt;arg&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FMELogHandler&lt;openparen&gt;logging.Handler&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;emit&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;record&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Emit&lt;space&gt;a&lt;space&gt;log&lt;space&gt;record.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger&lt;space&gt;=&lt;space&gt;fmeobjects.FMELogFile&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger.logMessageString&lt;openparen&gt;record.getMessage&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;getFMELogger&lt;openparen&gt;name&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Get&lt;space&gt;an&lt;space&gt;FME&lt;space&gt;logger.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger&lt;space&gt;=&lt;space&gt;logging.getLogger&lt;openparen&gt;name&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;formatter&lt;space&gt;=&lt;space&gt;logging.Formatter&lt;openparen&gt;&lt;quote&gt;%&lt;openparen&gt;asctime&lt;closeparen&gt;s&lt;space&gt;%&lt;openparen&gt;levelname&lt;closeparen&gt;s:&lt;space&gt;%&lt;openparen&gt;message&lt;closeparen&gt;s&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;handler&lt;space&gt;=&lt;space&gt;FMELogHandler&lt;openparen&gt;level=&lt;quote&gt;INFO&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;handler.setFormatter&lt;openparen&gt;formatter&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger.addHandler&lt;openparen&gt;handler&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;logger&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Exception&lt;solidus&gt;Error&lt;space&gt;Classes&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;MGSError&lt;openparen&gt;Exception&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;class&lt;space&gt;for&lt;space&gt;exceptions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;message&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;super&lt;openparen&gt;MGSError&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;message&lt;closeparen&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;type&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Error&lt;space&gt;type&lt;space&gt;string.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;Error&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;instructions&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Post-message&lt;space&gt;instructions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;MGSSystemError&lt;openparen&gt;MGSError&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;message&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;super&lt;openparen&gt;MGSSystemError&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;message&lt;closeparen&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;type&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Error&lt;space&gt;type&lt;space&gt;string.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;instructions&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Post-message&lt;space&gt;instructions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;FME&lt;space&gt;Template&lt;space&gt;Class&lt;space&gt;Interface&lt;lf&gt;&lt;lf&gt;TEMP&lt;space&gt;=&lt;space&gt;&lt;apos&gt;FME_SHAREDRESOURCE_TEMP&lt;apos&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Load&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;into&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;sqlite_sort_record_number&lt;apos&gt;&lt;closeparen&gt;&lt;space&gt;==&lt;space&gt;1:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;temporary&lt;space&gt;SQLite&lt;space&gt;database&lt;space&gt;and&lt;space&gt;feature&lt;space&gt;table.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db&lt;space&gt;=&lt;space&gt;None&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;keys&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;sqlite_sort_keys&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Configure&lt;space&gt;database&lt;space&gt;file&lt;space&gt;path&lt;space&gt;and&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;name.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db_path&lt;space&gt;=&lt;space&gt;random_path&lt;openparen&gt;directory=FME_MacroValues&lt;openbracket&gt;TEMP&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;prefix=&lt;apos&gt;SQLiteSorter_&lt;apos&gt;&lt;comma&gt;&lt;space&gt;suffix=&lt;apos&gt;.sqlite&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.table_name&lt;space&gt;=&lt;space&gt;&lt;apos&gt;features&lt;apos&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;SQL&lt;space&gt;DDF&lt;space&gt;key&lt;space&gt;column&lt;space&gt;definitions&lt;space&gt;from&lt;space&gt;the&lt;space&gt;Sort_Keys&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.keys&lt;space&gt;=&lt;space&gt;extract_dict_from_tab_delimited_data&lt;openparen&gt;sanitize_text&lt;openparen&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;lt&gt;apos&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;&lt;apos&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;keys&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;column_defs&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;openparen&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;type&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;temporary&lt;space&gt;database&lt;space&gt;and&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;with&lt;space&gt;a&lt;space&gt;BLOB&lt;space&gt;to&lt;space&gt;contain&lt;space&gt;the&lt;space&gt;serialized&lt;space&gt;feature.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db&lt;space&gt;=&lt;space&gt;sqlite3.connect&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.text_factory&lt;space&gt;=&lt;space&gt;str&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor&lt;space&gt;=&lt;space&gt;self.db.execute&lt;openparen&gt;&lt;quote&gt;create&lt;space&gt;table&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;column_defs&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;feature&lt;space&gt;BLOB&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;create&lt;space&gt;index&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;quote&gt;_index&lt;space&gt;on&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;asc&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;Exception&lt;space&gt;as&lt;space&gt;e:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;open&lt;space&gt;SQLite&lt;space&gt;database&lt;space&gt;&lt;quote&gt;%s&lt;quote&gt;&lt;space&gt;to&lt;space&gt;sort&lt;space&gt;records:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.db_path&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;hasattr&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;&lt;apos&gt;db&lt;apos&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Construct&lt;space&gt;insertion&lt;space&gt;statement&lt;space&gt;elements.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;key_names&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;key_placeholders&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;apos&gt;?&lt;apos&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;all_values&lt;space&gt;=&lt;space&gt;&lt;openbracket&gt;self.get_feature_attribute&lt;openparen&gt;feature&lt;comma&gt;&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;openbracket&gt;buffer&lt;openparen&gt;self.serialize_feature&lt;openparen&gt;feature&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Insert&lt;space&gt;the&lt;space&gt;feature&lt;space&gt;record&lt;space&gt;into&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;insert&lt;space&gt;into&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key_names&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;&lt;space&gt;values&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key_placeholders&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;?&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;all_values&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;store&lt;space&gt;records&lt;space&gt;in&lt;space&gt;SQLite&lt;space&gt;for&lt;space&gt;sorting:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Read&lt;space&gt;all&lt;space&gt;stored&lt;space&gt;features&lt;space&gt;from&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;in&lt;space&gt;the&lt;space&gt;requested&lt;space&gt;order.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;hasattr&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;&lt;apos&gt;db&lt;apos&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.commit&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Construct&lt;space&gt;the&lt;space&gt;ORDER&lt;space&gt;BY&lt;space&gt;clause.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;sort_defs&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;openparen&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;ordinality&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger&lt;space&gt;=&lt;space&gt;fmeobjects.FMELogFile&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger.logMessageString&lt;openparen&gt;&lt;apos&gt;sort_defs:&lt;space&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;repr&lt;openparen&gt;sort_defs&lt;closeparen&gt;&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;backslash&gt;n&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Execute&lt;space&gt;the&lt;space&gt;query&lt;space&gt;and&lt;space&gt;output&lt;space&gt;the&lt;space&gt;features&lt;space&gt;in&lt;space&gt;sorted&lt;space&gt;order&lt;comma&gt;&lt;space&gt;reconstructing&lt;space&gt;them&lt;space&gt;from&lt;space&gt;the&lt;space&gt;serialized&lt;space&gt;copy&lt;space&gt;in&lt;space&gt;the&lt;space&gt;temporary&lt;space&gt;table.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;feature_record&lt;space&gt;in&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;select&lt;space&gt;feature&lt;space&gt;from&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;order&lt;space&gt;by&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;sort_defs&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.output_feature_from_blob&lt;openparen&gt;feature_record&lt;openbracket&gt;0&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;sort&lt;space&gt;records&lt;space&gt;via&lt;space&gt;SQLite:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;finally:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Don&lt;apos&gt;t&lt;space&gt;leave&lt;space&gt;temporary&lt;space&gt;resource&lt;space&gt;files&lt;space&gt;behind.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;output_feature_from_blob&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;blob&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature&lt;space&gt;=&lt;space&gt;self.deserialize_feature&lt;openparen&gt;blob&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.output_feature&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;deserialize_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;blob&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.deserialize&lt;openparen&gt;bytearray&lt;openparen&gt;blob&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;output_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;get_feature_attribute&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;comma&gt;&lt;space&gt;feature_name&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature.getAttribute&lt;openparen&gt;feature_name&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;serialize_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature.serialize&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="SQLiteSortPythonCaller"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="8"
#!   TYPE="Counter"
#!   VERSION="2"
#!   POSITION="150 0"
#!   BOUNDING_RECT="150 0 -1 -1"
#!   ORDER="500000000000001"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="fme_rejection_code" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="CNT_ATTR" PARM_VALUE="sqlite_sort_record_number"/>
#!     <XFORM_PARM PARM_NAME="DOMAIN" PARM_VALUE="sqlite_sort_counter"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SCOPE" PARM_VALUE="Local"/>
#!     <XFORM_PARM PARM_NAME="START" PARM_VALUE="1"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Counter"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="11"
#!   TYPE="ParameterFetcher"
#!   VERSION="4"
#!   POSITION="1803.0000300002998 303.00303003030029"
#!   BOUNDING_RECT="1803.0000300002998 303.00303003030029 -1 -1"
#!   ORDER="500000000000002"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_keys" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ATTR_LIST" PARM_VALUE="sqlite_sort_keys $(Sort_Keys)"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ParameterFetcher"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="14"
#!   TYPE="Sampler"
#!   VERSION="4"
#!   POSITION="906.009060090601 -3.0000300002999438"
#!   BOUNDING_RECT="906.009060090601 -3.0000300002999438 -1 -1"
#!   ORDER="500000000000003"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="SAMPLED"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="NOT_SAMPLED"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="RATE" PARM_VALUE="1"/>
#!     <XFORM_PARM PARM_NAME="SAMPLE_MODE" PARM_VALUE="No"/>
#!     <XFORM_PARM PARM_NAME="SAMPLE_TYPE_LONG" PARM_VALUE="First N Features"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Sampler"/>
#! </TRANSFORMER>
#! </TRANSFORMERS>
#! <SUBDOCUMENT_IOS>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="2"
#!   NAME="Input"
#!   POSITION="-600 0"
#!   BOUNDING_RECT="-600 0 -1 -1"
#!   COLLAPSED="true"
#!   PUBLISHED="true"
#!   IS_SOURCE="true"
#!   ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="3"
#!   NAME="Sorted"
#!   POSITION="3302.9985299853006 3.0000300003000007"
#!   BOUNDING_RECT="3302.9985299853006 3.0000300003000007 -1 -1"
#!   COLLAPSED="true"
#!   IS_SOURCE="false"
#!   ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! </SUBDOCUMENT_IOS>
#! <FEAT_LINKS>
#! <FEAT_LINK
#!   IDENTIFIER="21"
#!   SOURCE_NODE="2"
#!   TARGET_NODE="8"
#!   SOURCE_PORT_DESC="0"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="6"
#!   SOURCE_NODE="4"
#!   TARGET_NODE="3"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="0"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="15"
#!   SOURCE_NODE="8"
#!   TARGET_NODE="14"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="13"
#!   SOURCE_NODE="11"
#!   TARGET_NODE="4"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="16"
#!   SOURCE_NODE="14"
#!   TARGET_NODE="11"
#!   SOURCE_PORT_DESC="fo 0 SAMPLED"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="17"
#!   SOURCE_NODE="14"
#!   TARGET_NODE="4"
#!   SOURCE_PORT_DESC="fo 1 NOT_SAMPLED"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! </FEAT_LINKS>
#! <BREAKPOINTS>
#! </BREAKPOINTS>
#! <ATTR_LINKS>
#! </ATTR_LINKS>
#! <SUBDOCUMENTS>
#! </SUBDOCUMENTS>
#! <LOOKUP_TABLES>
#! </LOOKUP_TABLES>
#! </TRANSFORMER>
FME_PYTHON_VERSION 2or3
DEFAULT_MACRO $(SQLiteSorter_WORKSPACE_NAME)_Sort_Keys 
#! START_HEADER
#! END_HEADER

LOG_TIMINGS YES
LOG_FILTER_MASK -1
DEFAULT_MACRO WB_CURRENT_CONTEXT
DEFAULT_MACRO SQLiteSorter_WORKSPACE_NAME ""
INCLUDE [puts {MACRO WB_OLD_CONTEXT_$(SQLiteSorter_WORKSPACE_NAME) $(WB_CURRENT_CONTEXT)};          puts {MACRO WB_CURRENT_CONTEXT $(SQLiteSorter_WORKSPACE_NAME)}]
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Input1530575905 Input Splitter"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"   OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"
# -------------------------------------------------------------------------

# Create the DomainName that this transformer will use.
# Because @Count itself will evalute the expression to calculate the
# domain, we don't need to do anything in Tcl per feature going by

INCLUDE [    set domainPrefix {};    if { {Local} == {Local} }    {       set domainPrefix [FME_EncodeText {$(SQLiteSorter_WORKSPACE_NAME)_Counter_}];    };    puts "MACRO $(SQLiteSorter_WORKSPACE_NAME)_Counter_FULL_DOMAIN ${domainPrefix}sqlite_sort_counter"; ]
FACTORY_DEF * ExecuteFunctionFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Counter_Rejector    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"    FUNCTION_DEFINITION @Count(REJECTABLE_WITH_FLAG,fme_encoded,$($(SQLiteSorter_WORKSPACE_NAME)_Counter_FULL_DOMAIN),"1")    RESULT_ATTRIBUTE "sqlite_sort_record_number"    OUTPUT COMPLETE FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_OUTPUT"    OUTPUT REJECTED FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_<REJECTED>"

FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Counter <REJECTED> Transformer Output Nuker"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_<REJECTED>"
# -------------------------------------------------------------------------

# If we're doing LAST N features, then the multiplier comes in as 0.
# If we're doing First N, multiplier is -1.
# For RANDOM, we need to treat LAST N as if it was first N (i.e. have a -1)
# That is what the ? : does in the rate multiplier.

INCLUDE [ if { {-1} == {0} && {ORIGINAL} == {ORIGINAL} } {              puts "MACRO REAL_MODE LAST"; 	         puts "MACRO REAL_RATE 1"; 	      } else {              puts "MACRO REAL_MODE ORIGINAL";              puts "MACRO REAL_RATE [expr 1 * ( -1 ? -1 : -1 ) ]"; 	      } ]
FACTORY_DEF {*} SamplingFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Sampler    COMMAND_PARM_EVALUATION SINGLE_PASS    SAMPLE_RATE $(REAL_RATE)    SAMPLE_ORDER $(REAL_MODE)    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_OUTPUT"    OUTPUT SAMPLED FEATURE_TYPE ___SAMPLED___    OUTPUT NOT_SAMPLED FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_NOT_SAMPLED"
# This TeeFactory is needed because Sampler will still output features if it has no OUTPUT clauses specified.
# This way we behave nicely even if there are no output connections on the transformer. See PR#28886.

FACTORY_DEF * TeeFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Sampler_Sampled    INPUT FEATURE_TYPE ___SAMPLED___    OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_SAMPLED"


# -------------------------------------------------------------------------

Tcl2 proc $(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_doFetch {} {    foreach {name val} {"sqlite_sort_keys {$($(SQLiteSorter_WORKSPACE_NAME)_Sort_Keys)}"} {         if { [string match {*<at>*} $val] == 1 } {             set val [FME_Execute EvaluateExpression {STRING} $val {$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher}];         } elseif {[string match {*FME_CONDITIONAL*} $val] == 1} {             set val [FME_Execute EvaluateExpression {STRING} $val {$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher}];         } else {             set val [FME_DecodeTextOrAttr $val];         };       FME_SetAttribute [FME_DecodeText $name] $val    } }
FACTORY_DEF * TeeFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_SAMPLED"    OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_OUTPUT"         @Tcl2($(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_doFetch)

# -------------------------------------------------------------------------


FME_PYTHON_PATH "$(FME_MF_DIR)"

FACTORY_DEF * PythonFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_OUTPUT"    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_NOT_SAMPLED"    SYMBOL_NAME FeatureProcessor    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE import<space>fmeobjects<lf><lf>import<space>os<lf>import<space>os.path<lf>import<space>re<lf>import<space>csv<lf>import<space>sys<lf>if<space>sys.version_info<space><gt><space><openparen>3<comma><closeparen>:<lf><space><space><space><space>buffer<space>=<space>memoryview<lf>import<space>random<lf>import<space>string<lf>import<space>traceback<lf>import<space>inspect<lf><lf>import<space>sqlite3<lf>import<space>logging<lf><lf><lf><lf>#<space>Random<space>String<space>Generators<lf><lf>def<space>random_string<openparen>size=24<comma><space>characters=string.ascii_lowercase<space>+<space>string.digits<closeparen>:<lf><space><space><space><space>return<space><apos><apos>.join<openparen>random.choice<openparen>characters<closeparen><space>for<space>x<space>in<space>range<openparen>size<closeparen><closeparen><lf><lf><lf>def<space>random_path<openparen>directory<comma><space>prefix=<quote><quote><comma><space>size=24<comma><space>characters=string.ascii_lowercase<space>+<space>string.digits<comma><space>suffix=<quote><quote><closeparen>:<lf><space><space><space><space>while<space>True:<lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>path<space>=<space>os.path.join<openparen>directory<comma><space>prefix<space>+<space>random_string<openparen>size<comma><space>characters<closeparen><space>+<space>suffix<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>fd<space>=<space>os.open<openparen>path<comma><space>os.O_RDONLY<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>os.close<openparen>fd<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>continue<lf><space><space><space><space><space><space><space><space>except<space>OSError:<lf><space><space><space><space><space><space><space><space><space><space><space><space>break<lf><space><space><space><space>return<space>path<lf><lf><lf><lf>#<space>Text<space>Interpretation<lf><lf>FME_TAG_CODE_TRANSLATIONS<space>=<space><opencurly><apos>lf<apos>:<space><space><space><space><space><space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>div.*?<apos>:<space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>br.*?<apos>:<space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>p.*?<apos>:<space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>cr<apos>:<space><space><space><space><space><space><space><space><space><space><space><apos><backslash>r<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>space<apos>:<space><space><space><space><space><space><space><space><apos><space><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>tab<apos>:<space><space><space><space><space><space><space><space><space><space><apos><backslash>t<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>comma<apos>:<space><space><space><space><space><space><space><space><apos><comma><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>solidus<apos>:<space><space><space><space><space><space><apos><solidus><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>apos<apos>:<space><space><space><space><space><space><space><space><space><apos><comma><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>openparen<apos>:<space><space><space><space><apos><openparen><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closeparen<apos>:<space><space><space><apos><closeparen><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>openbracket<apos>:<space><space><apos><openbracket><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closebracket<apos>:<space><apos><closebracket><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>opencurly<apos>:<space><space><space><space><apos><opencurly><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closecurly<apos>:<space><space><space><apos><closecurly><apos><closecurly><lf><lf>def<space>interpret_fme_character_tags<openparen>raw_text<closeparen>:<lf><space><space><space><space>result<space>=<space>raw_text<lf><space><space><space><space>for<space>fme_tag_code<space>in<space>FME_TAG_CODE_TRANSLATIONS.keys<openparen><closeparen>:<lf><space><space><space><space><space><space><space><space>result<space>=<space>re.sub<openparen><apos><lt><apos><space>+<space>fme_tag_code<space>+<space><apos><gt><apos><comma><space>FME_TAG_CODE_TRANSLATIONS<openbracket>fme_tag_code<closebracket><comma><space>result<closeparen><lf><space><space><space><space>return<space>result<lf><lf>def<space>sanitize_text<openparen>raw_text<closeparen>:<lf><space><space><space><space><quote><quote><quote>Replace<space>FME<space>tags<comma><space>HTML<space>tags<space>or<space>SQL<space>meta-characters<space>with<space>clean<space>and<space>safe<space>equivalents.<quote><quote><quote><lf><space><space><space><space>result<space>=<space>interpret_fme_character_tags<openparen>raw_text<closeparen><lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<quote><apos><openbracket><closeparen><backslash><quote><semicolon>!=<closebracket><quote><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space>#<space>Sanitize<space>SQL<space>metacharacters.<lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<apos><lt>.+?<gt><apos><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space><space><space><space><space>#<space>Sanitize<space>all<space>HTML<space>tags.<lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<apos>^<gt><openbracket><backslash>t<space><closebracket>*<apos><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space><space>#<space>Sanitize<space>email<space>quoting<space>prefixes.<lf><space><space><space><space>return<space>result<lf><lf>def<space>extract_dict_from_tab_delimited_data<openparen>text<closeparen>:<lf><space><space><space><space>rows<space>=<space>re.sub<openparen>r<apos><openbracket><space><backslash>t<closebracket>+<apos><comma><space><quote><backslash>t<quote><comma><space>text<closeparen>.splitlines<openparen><closeparen><space><space>#<space>Replace<space>repeated<space>delimiter<space>characters<space>by<space>a<space>single<space>tab<space>to<space>simplify<space>extraction.<lf><space><space><space><space>return<space><openbracket>row<space>for<space>row<space>in<space>csv.DictReader<openparen>rows<comma><space><openbracket><apos>name<apos><comma><space><apos>type<apos><comma><space><apos>ordinality<apos><closebracket><comma><space>None<comma><space>None<comma><space><apos>excel-tab<apos><closeparen><closebracket><lf><lf><lf><lf>#<space>Logging<space>Support<lf><lf>class<space>FMELogFormatter<openparen>logging.Formatter<closeparen>:<lf><space><space><space><space>def<space>__init__<openparen>self<comma><space>arg<closeparen>:<lf><space><space><space><space><space><space><space><space>super<openparen>FMELogFormatter<comma><space>self<closeparen>.__init__<openparen><closeparen><lf><space><space><space><space><space><space><space><space>self.arg<space>=<space>arg<lf><lf><lf>class<space>FMELogHandler<openparen>logging.Handler<closeparen>:<lf><space><space><space><space>def<space>emit<openparen>self<comma><space>record<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Emit<space>a<space>log<space>record.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>logger<space>=<space>fmeobjects.FMELogFile<openparen><closeparen><lf><space><space><space><space><space><space><space><space>logger.logMessageString<openparen>record.getMessage<openparen><closeparen><closeparen><lf><lf>def<space>getFMELogger<openparen>name<closeparen>:<lf><space><space><space><space><quote><quote><quote>Get<space>an<space>FME<space>logger.<quote><quote><quote><lf><space><space><space><space>logger<space>=<space>logging.getLogger<openparen>name<closeparen><lf><space><space><space><space>formatter<space>=<space>logging.Formatter<openparen><quote>%<openparen>asctime<closeparen>s<space>%<openparen>levelname<closeparen>s:<space>%<openparen>message<closeparen>s<quote><closeparen><lf><space><space><space><space>handler<space>=<space>FMELogHandler<openparen>level=<quote>INFO<quote><closeparen><lf><space><space><space><space>handler.setFormatter<openparen>formatter<closeparen><lf><space><space><space><space>logger.addHandler<openparen>handler<closeparen><lf><space><space><space><space>return<space>logger<lf><lf><lf><lf>#<space>Exception<solidus>Error<space>Classes<lf><lf>class<space>MGSError<openparen>Exception<closeparen>:<lf><tab><quote><quote><quote>Base<space>class<space>for<space>exceptions.<quote><quote><quote><lf><tab><lf><tab>def<space>__init__<openparen>self<comma><space>message<closeparen>:<lf><tab><tab>super<openparen>MGSError<comma><space>self<closeparen>.__init__<openparen>message<closeparen><lf><tab><lf><tab>def<space>type<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Error<space>type<space>string.<quote><quote><quote><lf><tab><tab>return<space><quote>Error<quote><lf><tab><lf><tab>def<space>instructions<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Post-message<space>instructions.<quote><quote><quote><lf><tab><tab>return<space><quote><quote><quote>Please<space>try<space>again.<quote><quote><quote><lf><lf>class<space>MGSSystemError<openparen>MGSError<closeparen>:<lf><tab><lf><tab>def<space>__init__<openparen>self<comma><space>message<closeparen>:<lf><tab><tab>super<openparen>MGSSystemError<comma><space>self<closeparen>.__init__<openparen>message<closeparen><lf><tab><lf><tab>def<space>type<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Error<space>type<space>string.<quote><quote><quote><lf><tab><tab>return<space><quote>Unexpected<space>System<space>Error<quote><lf><tab><lf><tab>def<space>instructions<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Post-message<space>instructions.<quote><quote><quote><lf><tab><tab>return<space><quote><quote><quote>Please<space>try<space>again.<quote><quote><quote><lf><lf><lf><lf>#<space>FME<space>Template<space>Class<space>Interface<lf><lf>TEMP<space>=<space><apos>FME_SHAREDRESOURCE_TEMP<apos><lf><lf>class<space>FeatureProcessor:<lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Load<space>a<space>feature<space>into<space>the<space>sort<space>table.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>feature.getAttribute<openparen><apos>sqlite_sort_record_number<apos><closeparen><space>==<space>1:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>temporary<space>SQLite<space>database<space>and<space>feature<space>table.<quote><quote><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db<space>=<space>None<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>keys<space>=<space>feature.getAttribute<openparen><apos>sqlite_sort_keys<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Configure<space>database<space>file<space>path<space>and<space>sort<space>table<space>name.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db_path<space>=<space>random_path<openparen>directory=FME_MacroValues<openbracket>TEMP<closebracket><comma><space>prefix=<apos>SQLiteSorter_<apos><comma><space>suffix=<apos>.sqlite<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.table_name<space>=<space><apos>features<apos><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>SQL<space>DDF<space>key<space>column<space>definitions<space>from<space>the<space>Sort_Keys<space>parameter.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.keys<space>=<space>extract_dict_from_tab_delimited_data<openparen>sanitize_text<openparen>re.sub<openparen>r<apos><lt>apos<gt><apos><comma><space><quote><apos><quote><comma><space>keys<closeparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>column_defs<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><openparen>key<openbracket><apos>name<apos><closebracket><space>+<space><apos><space><apos><space>+<space>key<openbracket><apos>type<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>temporary<space>database<space>and<space>sort<space>table<space>with<space>a<space>BLOB<space>to<space>contain<space>the<space>serialized<space>feature.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db<space>=<space>sqlite3.connect<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.text_factory<space>=<space>str<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor<space>=<space>self.db.execute<openparen><quote>create<space>table<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>column_defs<space>+<space><quote><comma><space>feature<space>BLOB<closeparen><semicolon><quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>for<space>key<space>in<space>self.keys:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.execute<openparen><quote>create<space>index<space><quote><space>+<space>key<openbracket><apos>name<apos><closebracket><space>+<space><quote>_index<space>on<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>key<openbracket><apos>name<apos><closebracket><space>+<space><quote><space>asc<closeparen><semicolon><quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>except<space>Exception<space>as<space>e:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>open<space>SQLite<space>database<space><quote>%s<quote><space>to<space>sort<space>records:<space>%s<backslash>n%s<apos><comma><space>self.db_path<comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>if<space>hasattr<openparen>self<comma><space><apos>db<apos><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Construct<space>insertion<space>statement<space>elements.<lf><space><space><space><space><space><space><space><space><space><space><space><space>key_names<space>=<space><apos><comma><space><apos>.join<openparen><openbracket>key<openbracket><apos>name<apos><closebracket><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>key_placeholders<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><apos>?<apos><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>all_values<space>=<space><openbracket>self.get_feature_attribute<openparen>feature<comma><space>key<openbracket><apos>name<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><space>+<space><openbracket>buffer<openparen>self.serialize_feature<openparen>feature<closeparen><closeparen><closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Insert<space>the<space>feature<space>record<space>into<space>the<space>sort<space>table.<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.execute<openparen><quote>insert<space>into<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>key_names<space>+<space><quote><comma><space>feature<closeparen><space>values<space><openparen><quote><space>+<space>key_placeholders<space>+<space><quote><comma><space>?<closeparen><semicolon><quote><comma><space>all_values<closeparen><lf><space><space><space><space><space><space><space><space>except:<lf><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>store<space>records<space>in<space>SQLite<space>for<space>sorting:<space>%s<backslash>n%s<apos><comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Read<space>all<space>stored<space>features<space>from<space>the<space>sort<space>table<space>in<space>the<space>requested<space>order.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>hasattr<openparen>self<comma><space><apos>db<apos><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.commit<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Construct<space>the<space>ORDER<space>BY<space>clause.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>sort_defs<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><openparen>key<openbracket><apos>name<apos><closebracket><space>+<space><apos><space><apos><space>+<space>key<openbracket><apos>ordinality<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>logger<space>=<space>fmeobjects.FMELogFile<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>logger.logMessageString<openparen><apos>sort_defs:<space><apos><space>+<space>repr<openparen>sort_defs<closeparen><space>+<space><quote><backslash>n<quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Execute<space>the<space>query<space>and<space>output<space>the<space>features<space>in<space>sorted<space>order<comma><space>reconstructing<space>them<space>from<space>the<space>serialized<space>copy<space>in<space>the<space>temporary<space>table.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>for<space>feature_record<space>in<space>self.cursor.execute<openparen><quote>select<space>feature<space>from<space><quote><space>+<space>self.table_name<space>+<space><quote><space>order<space>by<space><quote><space>+<space>sort_defs<space>+<space><quote><semicolon><quote><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.output_feature_from_blob<openparen>feature_record<openbracket>0<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>except:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>sort<space>records<space>via<space>SQLite:<space>%s<backslash>n%s<apos><comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>finally:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Don<apos>t<space>leave<space>temporary<space>resource<space>files<space>behind.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><lf><space><space><space><space>def<space>output_feature_from_blob<openparen>self<comma><space>blob<closeparen>:<lf><space><space><space><space><space><space><space><space>feature<space>=<space>self.deserialize_feature<openparen>blob<closeparen><lf><space><space><space><space><space><space><space><space>self.output_feature<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>deserialize_feature<openparen>self<comma><space>blob<closeparen>:<lf><space><space><space><space><space><space><space><space>feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space>feature.deserialize<openparen>bytearray<openparen>blob<closeparen><closeparen><lf><space><space><space><space><space><space><space><space>return<space>feature<lf><lf><space><space><space><space>def<space>output_feature<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>get_feature_attribute<openparen>self<comma><space>feature<comma><space>feature_name<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space>feature.getAttribute<openparen>feature_name<closeparen><lf><lf><space><space><space><space>def<space>serialize_feature<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space>feature.serialize<openparen><closeparen><lf>    OUTPUT PYOUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller_OUTPUT"

FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Sorted1530575905 Output Collector"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller_OUTPUT"   OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sorted"
INCLUDE [puts {MACRO WB_CURRENT_CONTEXT $(WB_OLD_CONTEXT_$(SQLiteSorter_WORKSPACE_NAME))}]
#! <?xml version="1.0" encoding="UTF-8" ?>
#! <TRANSFORMER
# TRANSFORMER_BEGIN SQLiteSorter,2,Workflows,4bef3df8-9516-4883-b1a2-b41fec3a382c,"Linked by Default",No,NO_PARALLELISM,,No,18310,YES,No,2or3
# <p>An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.</p>
# <p>For issues or questions, please Create an issue <a href="https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues">here</a>.  For the source, including test driver components, please see the <a href="https://modgeosys.assembla.com/spaces/fme-components/subversion/source">Assembla repository</a>.  For a list of planned improvements, see <a href="https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues">here</a>.</p>
# <p>Copyright &copy; 2017-2018 by Modern geoSystems, released under <a href="https://modgeosys.assembla.com/spaces/fme-components/subversion/source/HEAD/LICENSE?_format=raw">this BSD 3-clause license</a>.</p>
# TRANSFORMER_END
#!   ATTR_TYPE_ENCODING="SDF"
#!   BLOCKED_LOOPING="No"
#!   CATEGORY="Workflows"
#!   DESCRIPTION="&lt;p&gt;An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.&lt;/p&gt;&#10;&lt;p&gt;For issues or questions, please Create an issue &lt;a href=&quot;https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues&quot;&gt;here&lt;/a&gt;.  For the source, including test driver components, please see the &lt;a href=&quot;https://modgeosys.assembla.com/spaces/fme-components/subversion/source&quot;&gt;Assembla repository&lt;/a&gt;.  For a list of planned improvements, see &lt;a href=&quot;https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;&#10;&lt;p&gt;Copyright &amp;copy; 2017-2018 by Modern geoSystems, released under &lt;a href=&quot;https://modgeosys.assembla.com/spaces/fme-components/subversion/source/HEAD/LICENSE?_format=raw&quot;&gt;this BSD 3-clause license&lt;/a&gt;.&lt;/p&gt;"
#!   DOC_EXTENTS="3903 371.003"
#!   DOC_TOP_LEFT="-600 -68"
#!   EXPLICIT_BOOKMARK_ORDER="false"
#!   FME_BUILD_NUM="18310"
#!   FME_DOCUMENT_GUID="4bef3df8-9516-4883-b1a2-b41fec3a382c"
#!   FME_DOCUMENT_PRIORGUID=""
#!   FME_LINKED_TRANSFORMER_VERSION="2"
#!   FME_PROCESS_COUNT="NO_PARALLELISM"
#!   FME_PROCESS_GROUPS_ORDERED="No"
#!   FME_PROCESS_GROUP_BY=""
#!   FME_SERVER_SERVICES=""
#!   FMX_ATTRIBUTE_PROPOGATION_MODE="AUTO"
#!   FMX_INSERT_MODE="Linked by Default"
#!   HISTORY="2017-11-26,Kevin&lt;space&gt;Weller,Initial&lt;space&gt;publication&lt;semicolon&gt;&lt;space&gt;test&lt;space&gt;workspace&lt;space&gt;fails&lt;space&gt;due&lt;space&gt;to&lt;space&gt;FME&lt;space&gt;Hub&lt;space&gt;version&lt;space&gt;delay.,2017-11-30,Kevin&lt;space&gt;Weller,Enhance&lt;space&gt;stack&lt;space&gt;trace&lt;space&gt;reporting&lt;semicolon&gt;&lt;space&gt;use&lt;space&gt;truncated&lt;space&gt;test&lt;space&gt;data&lt;space&gt;and&lt;space&gt;universal&lt;space&gt;temp&lt;space&gt;directory.,2018-01-20,Kevin&lt;space&gt;Weller,Fix&lt;space&gt;absolute&lt;space&gt;parameter&lt;space&gt;name&lt;space&gt;references&lt;space&gt;from&lt;space&gt;PythonCaller&lt;space&gt;when&lt;space&gt;SQLiteServer&lt;space&gt;is&lt;space&gt;called&lt;space&gt;from&lt;space&gt;another&lt;space&gt;custom&lt;space&gt;transformer&lt;space&gt;rather&lt;space&gt;than&lt;space&gt;from&lt;space&gt;the&lt;space&gt;top-level&lt;space&gt;workspace.,2018-03-08,Kevin&lt;space&gt;Weller,Update&lt;space&gt;documentation&lt;space&gt;to&lt;space&gt;reflect&lt;space&gt;move&lt;space&gt;from&lt;space&gt;GitHub&lt;space&gt;to&lt;space&gt;Assembla&lt;space&gt;and&lt;space&gt;Atlassian.,2018-03-18,Kevin&lt;space&gt;Weller,Fix&lt;space&gt;Python&lt;space&gt;syntax&lt;space&gt;error&lt;semicolon&gt;&lt;space&gt;test&lt;space&gt;driver&lt;space&gt;failed&lt;space&gt;to&lt;space&gt;test&lt;space&gt;latest&lt;space&gt;version&lt;comma&gt;&lt;space&gt;so&lt;space&gt;it&lt;space&gt;looked&lt;space&gt;like&lt;space&gt;it&lt;space&gt;worked&lt;space&gt;10&lt;space&gt;days&lt;space&gt;ago&lt;comma&gt;&lt;space&gt;but&lt;space&gt;it&lt;space&gt;didn&lt;apos&gt;t.&lt;space&gt;&lt;amp&gt;*^*&lt;openparen&gt;^&lt;amp&gt;^&lt;openparen&gt;&lt;amp&gt;*!"
#!   ITERATION_COUNT_ATTR=""
#!   LAST_SAVE_BUILD="FME(R) 2018.0.1.0 (20180518 - Build 18310 - macosx)"
#!   LAST_SAVE_DATE="2018-07-02T17:56:59"
#!   MARKDOWN_DESCRIPTION="An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.&#10;&#10;For issues or questions, please Create an issue [here](https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues).  For the source, including test driver components, please see the [Assembla repository](https://modgeosys.assembla.com/spaces/fme-components/subversion/source).  For a list of planned improvements, see [here](https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues).&#10;&#10;Copyright &amp;copy; 2017-2018 by Modern geoSystems, released under [this BSD 3-clause license](https://modgeosys.assembla.com/spaces/fme-components/subversion/source/HEAD/LICENSE?_format=raw)."
#!   MARKDOWN_USAGE="### Ports&#10;&#10;#### Input&#10;Feed the features to be sorted here.  If the input features consist of a variety of different feature types, it would be wise to ensure the sort key fields are represented in all of them.&#10;&#10;#### Output&#10;The sorted features emerge here.&#10;&#10;### Parameters&#10;&#10;#### Sort_Keys&#10;A tab- or space-delimited table of the sort keys to be applied.  The first column contains the names of the fields to be sorted, in order of sort priority.  The second column contains the database field data type.  The third and last column specifies whether the field is to be sorted in `asc`ending or `desc`ending order, e.g.:  &#10;  &#10;   `kml_name&#9;varchar asc`  &#10;    `kml_id  varchar desc`  &#10;"
#!   MAX_LOOP_ITERATIONS=""
#!   PASSWORD=""
#!   PYTHON_COMPATIBILITY="2or3"
#!   SHOW_ANNOTATIONS="true"
#!   SHOW_INFO_NODES="true"
#!   TITLE="SQLiteSorter"
#!   USAGE="&lt;h3&gt;Ports&lt;/h3&gt;&#10;&lt;h4&gt;Input&lt;/h4&gt;&#10;&lt;p&gt;Feed the features to be sorted here.  If the input features consist of a variety of different feature types, it would be wise to ensure the sort key fields are represented in all of them.&lt;/p&gt;&#10;&lt;h4&gt;Output&lt;/h4&gt;&#10;&lt;p&gt;The sorted features emerge here.&lt;/p&gt;&#10;&lt;h3&gt;Parameters&lt;/h3&gt;&#10;&lt;h4&gt;Sort_Keys&lt;/h4&gt;&#10;&lt;p&gt;A tab- or space-delimited table of the sort keys to be applied.  The first column contains the names of the fields to be sorted, in order of sort priority.  The second column contains the database field data type.  The third and last column specifies whether the field is to be sorted in &lt;code&gt;asc&lt;/code&gt;ending or &lt;code&gt;desc&lt;/code&gt;ending order, e.g.:  &lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;kml_name    varchar asc&lt;/code&gt;&lt;br /&gt;&#10;&lt;code&gt;kml_id  varchar desc&lt;/code&gt;  &lt;/p&gt;"
#!   USE_MARKDOWN="YES"
#!   VIEW_POSITION="-684.007 456.005"
#!   WARN_INVALID_XFORM_PARAM="Yes"
#!   WORKSPACE_VERSION="1"
#!   XFORM_DEPRECATED="No"
#!   ZOOM_SCALE="100"
#! >
#! <DATASETS>
#! </DATASETS>
#! <DATA_TYPES>
#! </DATA_TYPES>
#! <GEOM_TYPES>
#! </GEOM_TYPES>
#! <FEATURE_TYPES>
#! </FEATURE_TYPES>
#! <FMESERVER>
#! </FMESERVER>
#! <GLOBAL_PARAMETERS>
#! <GLOBAL_PARAMETER
#!   GUI_LINE="GUI TEXT_EDIT_OR_ATTR Sort_Keys &quot; &quot; Sort Keys:"
#!   DEFAULT_VALUE=""
#!   IS_STAND_ALONE="true"
#! />
#! </GLOBAL_PARAMETERS>
#! <COMMENTS>
#! <COMMENT
#!   IDENTIFIER="7"
#!   COMMENT_VALUE="&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0//EN&quot; &quot;http://www.w3.org/TR/REC-html40/strict.dtd&quot;&gt;&#10;&lt;html&gt;&lt;head&gt;&lt;meta name=&quot;qrichtext&quot; content=&quot;1&quot; /&gt;&lt;style type=&quot;text/css&quot;&gt;&#10;p, li { white-space: pre-wrap; }&#10;&lt;/style&gt;&lt;/head&gt;&lt;body style=&quot; font-family:&apos;helvetica neue&apos;; font-size:13pt; font-weight:400; font-style:normal;&quot;&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;This is much easier in&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;Python than with FME&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;transformers.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;"
#!   POSITION="2552.9985299853006 303.0000300003"
#!   TOP_LEFT="2552.9985299853006 303.0000300003"
#!   BOTTOM_RIGHT="2551.9985299853006 304.0000300003"
#!   BOUNDING_RECT="2552.9985299853006 303.0000300003 -1 -1"
#!   ORDER="500000000000000"
#!   FOLLOW_ANCHOR="true"
#!   INFO_NODE="false"
#!   COLOUR="1,1,0.78431372549019607,0.19215686274509805"
#!   SIZE_POLICY="8"
#!   ANCHORED_NODE="4"
#! />
#! </COMMENTS>
#! <CONSTANTS>
#! </CONSTANTS>
#! <BOOKMARKS>
#! </BOOKMARKS>
#! <TRANSFORMERS>
#! <TRANSFORMER
#!   IDENTIFIER="4"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="2552.9985299853006 3.0000300003000007"
#!   BOUNDING_RECT="2552.9985299853006 3.0000300003000007 516.04700000000003 71"
#!   ORDER="500000000000000"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_keys" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fmeobjects&lt;lf&gt;&lt;lf&gt;import&lt;space&gt;os&lt;lf&gt;import&lt;space&gt;os.path&lt;lf&gt;import&lt;space&gt;re&lt;lf&gt;import&lt;space&gt;csv&lt;lf&gt;import&lt;space&gt;sys&lt;lf&gt;if&lt;space&gt;sys.version_info&lt;space&gt;&lt;gt&gt;&lt;space&gt;&lt;openparen&gt;3&lt;comma&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;buffer&lt;space&gt;=&lt;space&gt;memoryview&lt;lf&gt;import&lt;space&gt;random&lt;lf&gt;import&lt;space&gt;string&lt;lf&gt;import&lt;space&gt;traceback&lt;lf&gt;import&lt;space&gt;inspect&lt;lf&gt;&lt;lf&gt;import&lt;space&gt;sqlite3&lt;lf&gt;import&lt;space&gt;logging&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Random&lt;space&gt;String&lt;space&gt;Generators&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;random_string&lt;openparen&gt;size=24&lt;comma&gt;&lt;space&gt;characters=string.ascii_lowercase&lt;space&gt;+&lt;space&gt;string.digits&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;random.choice&lt;openparen&gt;characters&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;x&lt;space&gt;in&lt;space&gt;range&lt;openparen&gt;size&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;random_path&lt;openparen&gt;directory&lt;comma&gt;&lt;space&gt;prefix=&lt;quote&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;size=24&lt;comma&gt;&lt;space&gt;characters=string.ascii_lowercase&lt;space&gt;+&lt;space&gt;string.digits&lt;comma&gt;&lt;space&gt;suffix=&lt;quote&gt;&lt;quote&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;while&lt;space&gt;True:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;path&lt;space&gt;=&lt;space&gt;os.path.join&lt;openparen&gt;directory&lt;comma&gt;&lt;space&gt;prefix&lt;space&gt;+&lt;space&gt;random_string&lt;openparen&gt;size&lt;comma&gt;&lt;space&gt;characters&lt;closeparen&gt;&lt;space&gt;+&lt;space&gt;suffix&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;fd&lt;space&gt;=&lt;space&gt;os.open&lt;openparen&gt;path&lt;comma&gt;&lt;space&gt;os.O_RDONLY&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.close&lt;openparen&gt;fd&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;continue&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;OSError:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;break&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;path&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Text&lt;space&gt;Interpretation&lt;lf&gt;&lt;lf&gt;FME_TAG_CODE_TRANSLATIONS&lt;space&gt;=&lt;space&gt;&lt;opencurly&gt;&lt;apos&gt;lf&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;div.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;br.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;p.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;cr&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;r&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;space&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;tab&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;t&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;comma&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;solidus&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;solidus&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;apos&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;openparen&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;openparen&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closeparen&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;closeparen&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;openbracket&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;openbracket&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closebracket&lt;apos&gt;:&lt;space&gt;&lt;apos&gt;&lt;closebracket&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;opencurly&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;opencurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closecurly&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;closecurly&gt;&lt;apos&gt;&lt;closecurly&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;interpret_fme_character_tags&lt;openparen&gt;raw_text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;raw_text&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;fme_tag_code&lt;space&gt;in&lt;space&gt;FME_TAG_CODE_TRANSLATIONS.keys&lt;openparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;&lt;apos&gt;&lt;lt&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;fme_tag_code&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;FME_TAG_CODE_TRANSLATIONS&lt;openbracket&gt;fme_tag_code&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;result&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;result&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;sanitize_text&lt;openparen&gt;raw_text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Replace&lt;space&gt;FME&lt;space&gt;tags&lt;comma&gt;&lt;space&gt;HTML&lt;space&gt;tags&lt;space&gt;or&lt;space&gt;SQL&lt;space&gt;meta-characters&lt;space&gt;with&lt;space&gt;clean&lt;space&gt;and&lt;space&gt;safe&lt;space&gt;equivalents.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;interpret_fme_character_tags&lt;openparen&gt;raw_text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;quote&gt;&lt;apos&gt;&lt;openbracket&gt;&lt;closeparen&gt;&lt;backslash&gt;&lt;quote&gt;&lt;semicolon&gt;!=&lt;closebracket&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;SQL&lt;space&gt;metacharacters.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;lt&gt;.+?&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;all&lt;space&gt;HTML&lt;space&gt;tags.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;^&lt;gt&gt;&lt;openbracket&gt;&lt;backslash&gt;t&lt;space&gt;&lt;closebracket&gt;*&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;email&lt;space&gt;quoting&lt;space&gt;prefixes.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;result&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;extract_dict_from_tab_delimited_data&lt;openparen&gt;text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;rows&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;openbracket&gt;&lt;space&gt;&lt;backslash&gt;t&lt;closebracket&gt;+&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;&lt;backslash&gt;t&lt;quote&gt;&lt;comma&gt;&lt;space&gt;text&lt;closeparen&gt;.splitlines&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Replace&lt;space&gt;repeated&lt;space&gt;delimiter&lt;space&gt;characters&lt;space&gt;by&lt;space&gt;a&lt;space&gt;single&lt;space&gt;tab&lt;space&gt;to&lt;space&gt;simplify&lt;space&gt;extraction.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;&lt;openbracket&gt;row&lt;space&gt;for&lt;space&gt;row&lt;space&gt;in&lt;space&gt;csv.DictReader&lt;openparen&gt;rows&lt;comma&gt;&lt;space&gt;&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;type&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;ordinality&lt;apos&gt;&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;None&lt;comma&gt;&lt;space&gt;None&lt;comma&gt;&lt;space&gt;&lt;apos&gt;excel-tab&lt;apos&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Logging&lt;space&gt;Support&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FMELogFormatter&lt;openparen&gt;logging.Formatter&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;arg&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;super&lt;openparen&gt;FMELogFormatter&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.arg&lt;space&gt;=&lt;space&gt;arg&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FMELogHandler&lt;openparen&gt;logging.Handler&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;emit&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;record&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Emit&lt;space&gt;a&lt;space&gt;log&lt;space&gt;record.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger&lt;space&gt;=&lt;space&gt;fmeobjects.FMELogFile&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger.logMessageString&lt;openparen&gt;record.getMessage&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;getFMELogger&lt;openparen&gt;name&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Get&lt;space&gt;an&lt;space&gt;FME&lt;space&gt;logger.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger&lt;space&gt;=&lt;space&gt;logging.getLogger&lt;openparen&gt;name&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;formatter&lt;space&gt;=&lt;space&gt;logging.Formatter&lt;openparen&gt;&lt;quote&gt;%&lt;openparen&gt;asctime&lt;closeparen&gt;s&lt;space&gt;%&lt;openparen&gt;levelname&lt;closeparen&gt;s:&lt;space&gt;%&lt;openparen&gt;message&lt;closeparen&gt;s&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;handler&lt;space&gt;=&lt;space&gt;FMELogHandler&lt;openparen&gt;level=&lt;quote&gt;INFO&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;handler.setFormatter&lt;openparen&gt;formatter&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger.addHandler&lt;openparen&gt;handler&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;logger&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Exception&lt;solidus&gt;Error&lt;space&gt;Classes&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;MGSError&lt;openparen&gt;Exception&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;class&lt;space&gt;for&lt;space&gt;exceptions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;message&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;super&lt;openparen&gt;MGSError&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;message&lt;closeparen&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;type&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Error&lt;space&gt;type&lt;space&gt;string.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;Error&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;instructions&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Post-message&lt;space&gt;instructions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;MGSSystemError&lt;openparen&gt;MGSError&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;message&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;super&lt;openparen&gt;MGSSystemError&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;message&lt;closeparen&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;type&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Error&lt;space&gt;type&lt;space&gt;string.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;instructions&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Post-message&lt;space&gt;instructions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;FME&lt;space&gt;Template&lt;space&gt;Class&lt;space&gt;Interface&lt;lf&gt;&lt;lf&gt;TEMP&lt;space&gt;=&lt;space&gt;&lt;apos&gt;FME_SHAREDRESOURCE_TEMP&lt;apos&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Load&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;into&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;sqlite_sort_record_number&lt;apos&gt;&lt;closeparen&gt;&lt;space&gt;==&lt;space&gt;1:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;temporary&lt;space&gt;SQLite&lt;space&gt;database&lt;space&gt;and&lt;space&gt;feature&lt;space&gt;table.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db&lt;space&gt;=&lt;space&gt;None&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;keys&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;sqlite_sort_keys&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Configure&lt;space&gt;database&lt;space&gt;file&lt;space&gt;path&lt;space&gt;and&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;name.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db_path&lt;space&gt;=&lt;space&gt;random_path&lt;openparen&gt;directory=FME_MacroValues&lt;openbracket&gt;TEMP&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;prefix=&lt;apos&gt;SQLiteSorter_&lt;apos&gt;&lt;comma&gt;&lt;space&gt;suffix=&lt;apos&gt;.sqlite&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.table_name&lt;space&gt;=&lt;space&gt;&lt;apos&gt;features&lt;apos&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;SQL&lt;space&gt;DDF&lt;space&gt;key&lt;space&gt;column&lt;space&gt;definitions&lt;space&gt;from&lt;space&gt;the&lt;space&gt;Sort_Keys&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.keys&lt;space&gt;=&lt;space&gt;extract_dict_from_tab_delimited_data&lt;openparen&gt;sanitize_text&lt;openparen&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;lt&gt;apos&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;&lt;apos&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;keys&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;column_defs&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;openparen&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;type&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;temporary&lt;space&gt;database&lt;space&gt;and&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;with&lt;space&gt;a&lt;space&gt;BLOB&lt;space&gt;to&lt;space&gt;contain&lt;space&gt;the&lt;space&gt;serialized&lt;space&gt;feature.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db&lt;space&gt;=&lt;space&gt;sqlite3.connect&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.text_factory&lt;space&gt;=&lt;space&gt;str&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor&lt;space&gt;=&lt;space&gt;self.db.execute&lt;openparen&gt;&lt;quote&gt;create&lt;space&gt;table&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;column_defs&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;feature&lt;space&gt;BLOB&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;create&lt;space&gt;index&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;quote&gt;_index&lt;space&gt;on&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;asc&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;Exception&lt;space&gt;as&lt;space&gt;e:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;open&lt;space&gt;SQLite&lt;space&gt;database&lt;space&gt;&lt;quote&gt;%s&lt;quote&gt;&lt;space&gt;to&lt;space&gt;sort&lt;space&gt;records:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.db_path&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;hasattr&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;&lt;apos&gt;db&lt;apos&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Construct&lt;space&gt;insertion&lt;space&gt;statement&lt;space&gt;elements.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;key_names&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;key_placeholders&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;apos&gt;?&lt;apos&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;all_values&lt;space&gt;=&lt;space&gt;&lt;openbracket&gt;self.get_feature_attribute&lt;openparen&gt;feature&lt;comma&gt;&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;openbracket&gt;buffer&lt;openparen&gt;self.serialize_feature&lt;openparen&gt;feature&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Insert&lt;space&gt;the&lt;space&gt;feature&lt;space&gt;record&lt;space&gt;into&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;insert&lt;space&gt;into&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key_names&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;&lt;space&gt;values&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key_placeholders&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;?&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;all_values&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;store&lt;space&gt;records&lt;space&gt;in&lt;space&gt;SQLite&lt;space&gt;for&lt;space&gt;sorting:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Read&lt;space&gt;all&lt;space&gt;stored&lt;space&gt;features&lt;space&gt;from&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;in&lt;space&gt;the&lt;space&gt;requested&lt;space&gt;order.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;hasattr&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;&lt;apos&gt;db&lt;apos&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.commit&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Construct&lt;space&gt;the&lt;space&gt;ORDER&lt;space&gt;BY&lt;space&gt;clause.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;sort_defs&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;openparen&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;ordinality&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger&lt;space&gt;=&lt;space&gt;fmeobjects.FMELogFile&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger.logMessageString&lt;openparen&gt;&lt;apos&gt;sort_defs:&lt;space&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;repr&lt;openparen&gt;sort_defs&lt;closeparen&gt;&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;backslash&gt;n&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Execute&lt;space&gt;the&lt;space&gt;query&lt;space&gt;and&lt;space&gt;output&lt;space&gt;the&lt;space&gt;features&lt;space&gt;in&lt;space&gt;sorted&lt;space&gt;order&lt;comma&gt;&lt;space&gt;reconstructing&lt;space&gt;them&lt;space&gt;from&lt;space&gt;the&lt;space&gt;serialized&lt;space&gt;copy&lt;space&gt;in&lt;space&gt;the&lt;space&gt;temporary&lt;space&gt;table.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;feature_record&lt;space&gt;in&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;select&lt;space&gt;feature&lt;space&gt;from&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;order&lt;space&gt;by&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;sort_defs&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.output_feature_from_blob&lt;openparen&gt;feature_record&lt;openbracket&gt;0&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;sort&lt;space&gt;records&lt;space&gt;via&lt;space&gt;SQLite:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;finally:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Don&lt;apos&gt;t&lt;space&gt;leave&lt;space&gt;temporary&lt;space&gt;resource&lt;space&gt;files&lt;space&gt;behind.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;output_feature_from_blob&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;blob&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature&lt;space&gt;=&lt;space&gt;self.deserialize_feature&lt;openparen&gt;blob&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.output_feature&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;deserialize_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;blob&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.deserialize&lt;openparen&gt;bytearray&lt;openparen&gt;blob&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;output_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;get_feature_attribute&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;comma&gt;&lt;space&gt;feature_name&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature.getAttribute&lt;openparen&gt;feature_name&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;serialize_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature.serialize&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;globalize_transformer_parameter&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;local_parameter_name&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;FME_MacroValues&lt;openbracket&gt;self.parameter_prefix&lt;space&gt;+&lt;space&gt;local_parameter_name&lt;closebracket&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="SQLiteSortPythonCaller"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="8"
#!   TYPE="Counter"
#!   VERSION="2"
#!   POSITION="150 0"
#!   BOUNDING_RECT="150 0 -1 -1"
#!   ORDER="500000000000001"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="fme_rejection_code" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="CNT_ATTR" PARM_VALUE="sqlite_sort_record_number"/>
#!     <XFORM_PARM PARM_NAME="DOMAIN" PARM_VALUE="sqlite_sort_counter"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SCOPE" PARM_VALUE="Local"/>
#!     <XFORM_PARM PARM_NAME="START" PARM_VALUE="1"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Counter"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="11"
#!   TYPE="ParameterFetcher"
#!   VERSION="4"
#!   POSITION="1803.0000300002998 303.00303003030029"
#!   BOUNDING_RECT="1803.0000300002998 303.00303003030029 -1 -1"
#!   ORDER="500000000000002"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_keys" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ATTR_LIST" PARM_VALUE="sqlite_sort_keys $(Sort_Keys)"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ParameterFetcher"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="14"
#!   TYPE="Sampler"
#!   VERSION="4"
#!   POSITION="906.009060090601 -3.0000300002999438"
#!   BOUNDING_RECT="906.009060090601 -3.0000300002999438 -1 -1"
#!   ORDER="500000000000003"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="SAMPLED"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="NOT_SAMPLED"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="RATE" PARM_VALUE="1"/>
#!     <XFORM_PARM PARM_NAME="SAMPLE_MODE" PARM_VALUE="No"/>
#!     <XFORM_PARM PARM_NAME="SAMPLE_TYPE_LONG" PARM_VALUE="First N Features"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Sampler"/>
#! </TRANSFORMER>
#! </TRANSFORMERS>
#! <SUBDOCUMENT_IOS>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="2"
#!   NAME="Input"
#!   POSITION="-600 0"
#!   BOUNDING_RECT="-600 0 -1 -1"
#!   COLLAPSED="true"
#!   PUBLISHED="true"
#!   IS_SOURCE="true"
#!   ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="3"
#!   NAME="Sorted"
#!   POSITION="3302.9985299853006 3.0000300003000007"
#!   BOUNDING_RECT="3302.9985299853006 3.0000300003000007 -1 -1"
#!   COLLAPSED="true"
#!   IS_SOURCE="false"
#!   ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! </SUBDOCUMENT_IOS>
#! <FEAT_LINKS>
#! <FEAT_LINK
#!   IDENTIFIER="21"
#!   SOURCE_NODE="2"
#!   TARGET_NODE="8"
#!   SOURCE_PORT_DESC="0"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="6"
#!   SOURCE_NODE="4"
#!   TARGET_NODE="3"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="0"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="15"
#!   SOURCE_NODE="8"
#!   TARGET_NODE="14"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="13"
#!   SOURCE_NODE="11"
#!   TARGET_NODE="4"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="16"
#!   SOURCE_NODE="14"
#!   TARGET_NODE="11"
#!   SOURCE_PORT_DESC="fo 0 SAMPLED"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="17"
#!   SOURCE_NODE="14"
#!   TARGET_NODE="4"
#!   SOURCE_PORT_DESC="fo 1 NOT_SAMPLED"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! </FEAT_LINKS>
#! <BREAKPOINTS>
#! </BREAKPOINTS>
#! <ATTR_LINKS>
#! </ATTR_LINKS>
#! <SUBDOCUMENTS>
#! </SUBDOCUMENTS>
#! <LOOKUP_TABLES>
#! </LOOKUP_TABLES>
#! </TRANSFORMER>
FME_PYTHON_VERSION 2or3
DEFAULT_MACRO $(SQLiteSorter_WORKSPACE_NAME)_Sort_Keys 
#! START_HEADER
#! END_HEADER

LOG_TIMINGS YES
LOG_FILTER_MASK -1
DEFAULT_MACRO WB_CURRENT_CONTEXT
DEFAULT_MACRO SQLiteSorter_WORKSPACE_NAME ""
INCLUDE [puts {MACRO WB_OLD_CONTEXT_$(SQLiteSorter_WORKSPACE_NAME) $(WB_CURRENT_CONTEXT)};          puts {MACRO WB_CURRENT_CONTEXT $(SQLiteSorter_WORKSPACE_NAME)}]
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Input1530575819 Input Splitter"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"   OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"
# -------------------------------------------------------------------------

# Create the DomainName that this transformer will use.
# Because @Count itself will evalute the expression to calculate the
# domain, we don't need to do anything in Tcl per feature going by

INCLUDE [    set domainPrefix {};    if { {Local} == {Local} }    {       set domainPrefix [FME_EncodeText {$(SQLiteSorter_WORKSPACE_NAME)_Counter_}];    };    puts "MACRO $(SQLiteSorter_WORKSPACE_NAME)_Counter_FULL_DOMAIN ${domainPrefix}sqlite_sort_counter"; ]
FACTORY_DEF * ExecuteFunctionFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Counter_Rejector    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"    FUNCTION_DEFINITION @Count(REJECTABLE_WITH_FLAG,fme_encoded,$($(SQLiteSorter_WORKSPACE_NAME)_Counter_FULL_DOMAIN),"1")    RESULT_ATTRIBUTE "sqlite_sort_record_number"    OUTPUT COMPLETE FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_OUTPUT"    OUTPUT REJECTED FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_<REJECTED>"

FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Counter <REJECTED> Transformer Output Nuker"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_<REJECTED>"
# -------------------------------------------------------------------------

# If we're doing LAST N features, then the multiplier comes in as 0.
# If we're doing First N, multiplier is -1.
# For RANDOM, we need to treat LAST N as if it was first N (i.e. have a -1)
# That is what the ? : does in the rate multiplier.

INCLUDE [ if { {-1} == {0} && {ORIGINAL} == {ORIGINAL} } {              puts "MACRO REAL_MODE LAST"; 	         puts "MACRO REAL_RATE 1"; 	      } else {              puts "MACRO REAL_MODE ORIGINAL";              puts "MACRO REAL_RATE [expr 1 * ( -1 ? -1 : -1 ) ]"; 	      } ]
FACTORY_DEF {*} SamplingFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Sampler    COMMAND_PARM_EVALUATION SINGLE_PASS    SAMPLE_RATE $(REAL_RATE)    SAMPLE_ORDER $(REAL_MODE)    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_OUTPUT"    OUTPUT SAMPLED FEATURE_TYPE ___SAMPLED___    OUTPUT NOT_SAMPLED FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_NOT_SAMPLED"
# This TeeFactory is needed because Sampler will still output features if it has no OUTPUT clauses specified.
# This way we behave nicely even if there are no output connections on the transformer. See PR#28886.

FACTORY_DEF * TeeFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Sampler_Sampled    INPUT FEATURE_TYPE ___SAMPLED___    OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_SAMPLED"


# -------------------------------------------------------------------------

Tcl2 proc $(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_doFetch {} {    foreach {name val} {"sqlite_sort_keys {$($(SQLiteSorter_WORKSPACE_NAME)_Sort_Keys)}"} {         if { [string match {*<at>*} $val] == 1 } {             set val [FME_Execute EvaluateExpression {STRING} $val {$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher}];         } elseif {[string match {*FME_CONDITIONAL*} $val] == 1} {             set val [FME_Execute EvaluateExpression {STRING} $val {$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher}];         } else {             set val [FME_DecodeTextOrAttr $val];         };       FME_SetAttribute [FME_DecodeText $name] $val    } }
FACTORY_DEF * TeeFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_SAMPLED"    OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_OUTPUT"         @Tcl2($(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_doFetch)

# -------------------------------------------------------------------------


FME_PYTHON_PATH "$(FME_MF_DIR)"

FACTORY_DEF * PythonFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_OUTPUT"    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_NOT_SAMPLED"    SYMBOL_NAME FeatureProcessor    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE import<space>fmeobjects<lf><lf>import<space>os<lf>import<space>os.path<lf>import<space>re<lf>import<space>csv<lf>import<space>sys<lf>if<space>sys.version_info<space><gt><space><openparen>3<comma><closeparen>:<lf><space><space><space><space>buffer<space>=<space>memoryview<lf>import<space>random<lf>import<space>string<lf>import<space>traceback<lf>import<space>inspect<lf><lf>import<space>sqlite3<lf>import<space>logging<lf><lf><lf><lf>#<space>Random<space>String<space>Generators<lf><lf>def<space>random_string<openparen>size=24<comma><space>characters=string.ascii_lowercase<space>+<space>string.digits<closeparen>:<lf><space><space><space><space>return<space><apos><apos>.join<openparen>random.choice<openparen>characters<closeparen><space>for<space>x<space>in<space>range<openparen>size<closeparen><closeparen><lf><lf><lf>def<space>random_path<openparen>directory<comma><space>prefix=<quote><quote><comma><space>size=24<comma><space>characters=string.ascii_lowercase<space>+<space>string.digits<comma><space>suffix=<quote><quote><closeparen>:<lf><space><space><space><space>while<space>True:<lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>path<space>=<space>os.path.join<openparen>directory<comma><space>prefix<space>+<space>random_string<openparen>size<comma><space>characters<closeparen><space>+<space>suffix<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>fd<space>=<space>os.open<openparen>path<comma><space>os.O_RDONLY<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>os.close<openparen>fd<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>continue<lf><space><space><space><space><space><space><space><space>except<space>OSError:<lf><space><space><space><space><space><space><space><space><space><space><space><space>break<lf><space><space><space><space>return<space>path<lf><lf><lf><lf>#<space>Text<space>Interpretation<lf><lf>FME_TAG_CODE_TRANSLATIONS<space>=<space><opencurly><apos>lf<apos>:<space><space><space><space><space><space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>div.*?<apos>:<space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>br.*?<apos>:<space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>p.*?<apos>:<space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>cr<apos>:<space><space><space><space><space><space><space><space><space><space><space><apos><backslash>r<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>space<apos>:<space><space><space><space><space><space><space><space><apos><space><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>tab<apos>:<space><space><space><space><space><space><space><space><space><space><apos><backslash>t<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>comma<apos>:<space><space><space><space><space><space><space><space><apos><comma><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>solidus<apos>:<space><space><space><space><space><space><apos><solidus><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>apos<apos>:<space><space><space><space><space><space><space><space><space><apos><comma><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>openparen<apos>:<space><space><space><space><apos><openparen><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closeparen<apos>:<space><space><space><apos><closeparen><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>openbracket<apos>:<space><space><apos><openbracket><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closebracket<apos>:<space><apos><closebracket><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>opencurly<apos>:<space><space><space><space><apos><opencurly><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closecurly<apos>:<space><space><space><apos><closecurly><apos><closecurly><lf><lf>def<space>interpret_fme_character_tags<openparen>raw_text<closeparen>:<lf><space><space><space><space>result<space>=<space>raw_text<lf><space><space><space><space>for<space>fme_tag_code<space>in<space>FME_TAG_CODE_TRANSLATIONS.keys<openparen><closeparen>:<lf><space><space><space><space><space><space><space><space>result<space>=<space>re.sub<openparen><apos><lt><apos><space>+<space>fme_tag_code<space>+<space><apos><gt><apos><comma><space>FME_TAG_CODE_TRANSLATIONS<openbracket>fme_tag_code<closebracket><comma><space>result<closeparen><lf><space><space><space><space>return<space>result<lf><lf>def<space>sanitize_text<openparen>raw_text<closeparen>:<lf><space><space><space><space><quote><quote><quote>Replace<space>FME<space>tags<comma><space>HTML<space>tags<space>or<space>SQL<space>meta-characters<space>with<space>clean<space>and<space>safe<space>equivalents.<quote><quote><quote><lf><space><space><space><space>result<space>=<space>interpret_fme_character_tags<openparen>raw_text<closeparen><lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<quote><apos><openbracket><closeparen><backslash><quote><semicolon>!=<closebracket><quote><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space>#<space>Sanitize<space>SQL<space>metacharacters.<lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<apos><lt>.+?<gt><apos><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space><space><space><space><space>#<space>Sanitize<space>all<space>HTML<space>tags.<lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<apos>^<gt><openbracket><backslash>t<space><closebracket>*<apos><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space><space>#<space>Sanitize<space>email<space>quoting<space>prefixes.<lf><space><space><space><space>return<space>result<lf><lf>def<space>extract_dict_from_tab_delimited_data<openparen>text<closeparen>:<lf><space><space><space><space>rows<space>=<space>re.sub<openparen>r<apos><openbracket><space><backslash>t<closebracket>+<apos><comma><space><quote><backslash>t<quote><comma><space>text<closeparen>.splitlines<openparen><closeparen><space><space>#<space>Replace<space>repeated<space>delimiter<space>characters<space>by<space>a<space>single<space>tab<space>to<space>simplify<space>extraction.<lf><space><space><space><space>return<space><openbracket>row<space>for<space>row<space>in<space>csv.DictReader<openparen>rows<comma><space><openbracket><apos>name<apos><comma><space><apos>type<apos><comma><space><apos>ordinality<apos><closebracket><comma><space>None<comma><space>None<comma><space><apos>excel-tab<apos><closeparen><closebracket><lf><lf><lf><lf>#<space>Logging<space>Support<lf><lf>class<space>FMELogFormatter<openparen>logging.Formatter<closeparen>:<lf><space><space><space><space>def<space>__init__<openparen>self<comma><space>arg<closeparen>:<lf><space><space><space><space><space><space><space><space>super<openparen>FMELogFormatter<comma><space>self<closeparen>.__init__<openparen><closeparen><lf><space><space><space><space><space><space><space><space>self.arg<space>=<space>arg<lf><lf><lf>class<space>FMELogHandler<openparen>logging.Handler<closeparen>:<lf><space><space><space><space>def<space>emit<openparen>self<comma><space>record<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Emit<space>a<space>log<space>record.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>logger<space>=<space>fmeobjects.FMELogFile<openparen><closeparen><lf><space><space><space><space><space><space><space><space>logger.logMessageString<openparen>record.getMessage<openparen><closeparen><closeparen><lf><lf>def<space>getFMELogger<openparen>name<closeparen>:<lf><space><space><space><space><quote><quote><quote>Get<space>an<space>FME<space>logger.<quote><quote><quote><lf><space><space><space><space>logger<space>=<space>logging.getLogger<openparen>name<closeparen><lf><space><space><space><space>formatter<space>=<space>logging.Formatter<openparen><quote>%<openparen>asctime<closeparen>s<space>%<openparen>levelname<closeparen>s:<space>%<openparen>message<closeparen>s<quote><closeparen><lf><space><space><space><space>handler<space>=<space>FMELogHandler<openparen>level=<quote>INFO<quote><closeparen><lf><space><space><space><space>handler.setFormatter<openparen>formatter<closeparen><lf><space><space><space><space>logger.addHandler<openparen>handler<closeparen><lf><space><space><space><space>return<space>logger<lf><lf><lf><lf>#<space>Exception<solidus>Error<space>Classes<lf><lf>class<space>MGSError<openparen>Exception<closeparen>:<lf><tab><quote><quote><quote>Base<space>class<space>for<space>exceptions.<quote><quote><quote><lf><tab><lf><tab>def<space>__init__<openparen>self<comma><space>message<closeparen>:<lf><tab><tab>super<openparen>MGSError<comma><space>self<closeparen>.__init__<openparen>message<closeparen><lf><tab><lf><tab>def<space>type<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Error<space>type<space>string.<quote><quote><quote><lf><tab><tab>return<space><quote>Error<quote><lf><tab><lf><tab>def<space>instructions<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Post-message<space>instructions.<quote><quote><quote><lf><tab><tab>return<space><quote><quote><quote>Please<space>try<space>again.<quote><quote><quote><lf><lf>class<space>MGSSystemError<openparen>MGSError<closeparen>:<lf><tab><lf><tab>def<space>__init__<openparen>self<comma><space>message<closeparen>:<lf><tab><tab>super<openparen>MGSSystemError<comma><space>self<closeparen>.__init__<openparen>message<closeparen><lf><tab><lf><tab>def<space>type<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Error<space>type<space>string.<quote><quote><quote><lf><tab><tab>return<space><quote>Unexpected<space>System<space>Error<quote><lf><tab><lf><tab>def<space>instructions<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Post-message<space>instructions.<quote><quote><quote><lf><tab><tab>return<space><quote><quote><quote>Please<space>try<space>again.<quote><quote><quote><lf><lf><lf><lf>#<space>FME<space>Template<space>Class<space>Interface<lf><lf>TEMP<space>=<space><apos>FME_SHAREDRESOURCE_TEMP<apos><lf><lf>class<space>FeatureProcessor:<lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Load<space>a<space>feature<space>into<space>the<space>sort<space>table.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>feature.getAttribute<openparen><apos>sqlite_sort_record_number<apos><closeparen><space>==<space>1:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>temporary<space>SQLite<space>database<space>and<space>feature<space>table.<quote><quote><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db<space>=<space>None<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>keys<space>=<space>feature.getAttribute<openparen><apos>sqlite_sort_keys<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Configure<space>database<space>file<space>path<space>and<space>sort<space>table<space>name.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db_path<space>=<space>random_path<openparen>directory=FME_MacroValues<openbracket>TEMP<closebracket><comma><space>prefix=<apos>SQLiteSorter_<apos><comma><space>suffix=<apos>.sqlite<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.table_name<space>=<space><apos>features<apos><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>SQL<space>DDF<space>key<space>column<space>definitions<space>from<space>the<space>Sort_Keys<space>parameter.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.keys<space>=<space>extract_dict_from_tab_delimited_data<openparen>sanitize_text<openparen>re.sub<openparen>r<apos><lt>apos<gt><apos><comma><space><quote><apos><quote><comma><space>keys<closeparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>column_defs<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><openparen>key<openbracket><apos>name<apos><closebracket><space>+<space><apos><space><apos><space>+<space>key<openbracket><apos>type<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>temporary<space>database<space>and<space>sort<space>table<space>with<space>a<space>BLOB<space>to<space>contain<space>the<space>serialized<space>feature.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db<space>=<space>sqlite3.connect<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.text_factory<space>=<space>str<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor<space>=<space>self.db.execute<openparen><quote>create<space>table<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>column_defs<space>+<space><quote><comma><space>feature<space>BLOB<closeparen><semicolon><quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>for<space>key<space>in<space>self.keys:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.execute<openparen><quote>create<space>index<space><quote><space>+<space>key<openbracket><apos>name<apos><closebracket><space>+<space><quote>_index<space>on<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>key<openbracket><apos>name<apos><closebracket><space>+<space><quote><space>asc<closeparen><semicolon><quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>except<space>Exception<space>as<space>e:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>open<space>SQLite<space>database<space><quote>%s<quote><space>to<space>sort<space>records:<space>%s<backslash>n%s<apos><comma><space>self.db_path<comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>if<space>hasattr<openparen>self<comma><space><apos>db<apos><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Construct<space>insertion<space>statement<space>elements.<lf><space><space><space><space><space><space><space><space><space><space><space><space>key_names<space>=<space><apos><comma><space><apos>.join<openparen><openbracket>key<openbracket><apos>name<apos><closebracket><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>key_placeholders<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><apos>?<apos><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>all_values<space>=<space><openbracket>self.get_feature_attribute<openparen>feature<comma><space>key<openbracket><apos>name<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><space>+<space><openbracket>buffer<openparen>self.serialize_feature<openparen>feature<closeparen><closeparen><closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Insert<space>the<space>feature<space>record<space>into<space>the<space>sort<space>table.<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.execute<openparen><quote>insert<space>into<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>key_names<space>+<space><quote><comma><space>feature<closeparen><space>values<space><openparen><quote><space>+<space>key_placeholders<space>+<space><quote><comma><space>?<closeparen><semicolon><quote><comma><space>all_values<closeparen><lf><space><space><space><space><space><space><space><space>except:<lf><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>store<space>records<space>in<space>SQLite<space>for<space>sorting:<space>%s<backslash>n%s<apos><comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Read<space>all<space>stored<space>features<space>from<space>the<space>sort<space>table<space>in<space>the<space>requested<space>order.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>hasattr<openparen>self<comma><space><apos>db<apos><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.commit<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Construct<space>the<space>ORDER<space>BY<space>clause.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>sort_defs<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><openparen>key<openbracket><apos>name<apos><closebracket><space>+<space><apos><space><apos><space>+<space>key<openbracket><apos>ordinality<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>logger<space>=<space>fmeobjects.FMELogFile<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>logger.logMessageString<openparen><apos>sort_defs:<space><apos><space>+<space>repr<openparen>sort_defs<closeparen><space>+<space><quote><backslash>n<quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Execute<space>the<space>query<space>and<space>output<space>the<space>features<space>in<space>sorted<space>order<comma><space>reconstructing<space>them<space>from<space>the<space>serialized<space>copy<space>in<space>the<space>temporary<space>table.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>for<space>feature_record<space>in<space>self.cursor.execute<openparen><quote>select<space>feature<space>from<space><quote><space>+<space>self.table_name<space>+<space><quote><space>order<space>by<space><quote><space>+<space>sort_defs<space>+<space><quote><semicolon><quote><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.output_feature_from_blob<openparen>feature_record<openbracket>0<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>except:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>sort<space>records<space>via<space>SQLite:<space>%s<backslash>n%s<apos><comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>finally:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Don<apos>t<space>leave<space>temporary<space>resource<space>files<space>behind.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><lf><space><space><space><space>def<space>output_feature_from_blob<openparen>self<comma><space>blob<closeparen>:<lf><space><space><space><space><space><space><space><space>feature<space>=<space>self.deserialize_feature<openparen>blob<closeparen><lf><space><space><space><space><space><space><space><space>self.output_feature<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>deserialize_feature<openparen>self<comma><space>blob<closeparen>:<lf><space><space><space><space><space><space><space><space>feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space>feature.deserialize<openparen>bytearray<openparen>blob<closeparen><closeparen><lf><space><space><space><space><space><space><space><space>return<space>feature<lf><lf><space><space><space><space>def<space>output_feature<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>get_feature_attribute<openparen>self<comma><space>feature<comma><space>feature_name<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space>feature.getAttribute<openparen>feature_name<closeparen><lf><lf><space><space><space><space>def<space>serialize_feature<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space>feature.serialize<openparen><closeparen><lf><space><space><space><space><lf><space><space><space><space>def<space>globalize_transformer_parameter<openparen>self<comma><space>local_parameter_name<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space>FME_MacroValues<openbracket>self.parameter_prefix<space>+<space>local_parameter_name<closebracket>    OUTPUT PYOUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller_OUTPUT"

FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Sorted1530575819 Output Collector"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller_OUTPUT"   OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sorted"
INCLUDE [puts {MACRO WB_CURRENT_CONTEXT $(WB_OLD_CONTEXT_$(SQLiteSorter_WORKSPACE_NAME))}]
#! <?xml version="1.0" encoding="UTF-8" ?>
#! <TRANSFORMER
# TRANSFORMER_BEGIN SQLiteSorter,1,Workflows,f95726f0-8aeb-477c-8849-17861f7ddc48,"Linked by Default",No,NO_PARALLELISM,,No,18310,YES,No,2or3
# <p>An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.</p>
# <p>For issues or questions, please Create an issue <a href="https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues">here</a>.  For the source, including test driver components, please see the <a href="https://modgeosys.assembla.com/spaces/fme-components/subversion/source">Assembla repository</a>.  For a list of planned improvements, see <a href="https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues">here</a>.</p>
# <p>Copyright &copy; 2017-2018 by Modern geoSystems, released under <a href="https://modgeosys.assembla.com/spaces/fme-components/subversion/source/HEAD/LICENSE?_format=raw">this BSD 3-clause license</a>.</p>
# TRANSFORMER_END
#!   ATTR_TYPE_ENCODING="SDF"
#!   BLOCKED_LOOPING="No"
#!   CATEGORY="Workflows"
#!   DESCRIPTION="&lt;p&gt;An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.&lt;/p&gt;&#10;&lt;p&gt;For issues or questions, please Create an issue &lt;a href=&quot;https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues&quot;&gt;here&lt;/a&gt;.  For the source, including test driver components, please see the &lt;a href=&quot;https://modgeosys.assembla.com/spaces/fme-components/subversion/source&quot;&gt;Assembla repository&lt;/a&gt;.  For a list of planned improvements, see &lt;a href=&quot;https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;&#10;&lt;p&gt;Copyright &amp;copy; 2017-2018 by Modern geoSystems, released under &lt;a href=&quot;https://modgeosys.assembla.com/spaces/fme-components/subversion/source/HEAD/LICENSE?_format=raw&quot;&gt;this BSD 3-clause license&lt;/a&gt;.&lt;/p&gt;"
#!   DOC_EXTENTS="3903 371.003"
#!   DOC_TOP_LEFT="-600 -68"
#!   EXPLICIT_BOOKMARK_ORDER="false"
#!   FME_BUILD_NUM="18310"
#!   FME_DOCUMENT_GUID="f95726f0-8aeb-477c-8849-17861f7ddc48"
#!   FME_DOCUMENT_PRIORGUID="311a2342-cb1d-43bd-9931-c74f42d34559"
#!   FME_LINKED_TRANSFORMER_VERSION="1"
#!   FME_PROCESS_COUNT="NO_PARALLELISM"
#!   FME_PROCESS_GROUPS_ORDERED="No"
#!   FME_PROCESS_GROUP_BY=""
#!   FME_SERVER_SERVICES=""
#!   FMX_ATTRIBUTE_PROPOGATION_MODE="AUTO"
#!   FMX_INSERT_MODE="Linked by Default"
#!   HISTORY="2017-11-26,Kevin&lt;space&gt;Weller,Initial&lt;space&gt;publication&lt;semicolon&gt;&lt;space&gt;test&lt;space&gt;workspace&lt;space&gt;fails&lt;space&gt;due&lt;space&gt;to&lt;space&gt;FME&lt;space&gt;Hub&lt;space&gt;version&lt;space&gt;delay.,2017-11-30,Kevin&lt;space&gt;Weller,Enhance&lt;space&gt;stack&lt;space&gt;trace&lt;space&gt;reporting&lt;semicolon&gt;&lt;space&gt;use&lt;space&gt;truncated&lt;space&gt;test&lt;space&gt;data&lt;space&gt;and&lt;space&gt;universal&lt;space&gt;temp&lt;space&gt;directory.,2018-01-20,Kevin&lt;space&gt;Weller,Fix&lt;space&gt;absolute&lt;space&gt;parameter&lt;space&gt;name&lt;space&gt;references&lt;space&gt;from&lt;space&gt;PythonCaller&lt;space&gt;when&lt;space&gt;SQLiteServer&lt;space&gt;is&lt;space&gt;called&lt;space&gt;from&lt;space&gt;another&lt;space&gt;custom&lt;space&gt;transformer&lt;space&gt;rather&lt;space&gt;than&lt;space&gt;from&lt;space&gt;the&lt;space&gt;top-level&lt;space&gt;workspace.,2018-03-08,Kevin&lt;space&gt;Weller,Update&lt;space&gt;documentation&lt;space&gt;to&lt;space&gt;reflect&lt;space&gt;move&lt;space&gt;from&lt;space&gt;GitHub&lt;space&gt;to&lt;space&gt;Assembla&lt;space&gt;and&lt;space&gt;Atlassian.,2018-03-18,Kevin&lt;space&gt;Weller,Fix&lt;space&gt;Python&lt;space&gt;syntax&lt;space&gt;error&lt;semicolon&gt;&lt;space&gt;test&lt;space&gt;driver&lt;space&gt;failed&lt;space&gt;to&lt;space&gt;test&lt;space&gt;latest&lt;space&gt;version&lt;comma&gt;&lt;space&gt;so&lt;space&gt;it&lt;space&gt;looked&lt;space&gt;like&lt;space&gt;it&lt;space&gt;worked&lt;space&gt;10&lt;space&gt;days&lt;space&gt;ago&lt;comma&gt;&lt;space&gt;but&lt;space&gt;it&lt;space&gt;didn&lt;apos&gt;t.&lt;space&gt;&lt;amp&gt;*^*&lt;openparen&gt;^&lt;amp&gt;^&lt;openparen&gt;&lt;amp&gt;*!"
#!   ITERATION_COUNT_ATTR=""
#!   LAST_SAVE_BUILD="FME(R) 2018.0.1.0 (20180518 - Build 18310 - macosx)"
#!   LAST_SAVE_DATE="2018-07-02T17:49:15"
#!   MARKDOWN_DESCRIPTION="An alternative to the built-in Sorter transformer using SQLite that is faster when sorting some datsets.  Geometries are preserved through the sort process despite the use of the non-spatially-extended basic SQLite format.&#10;&#10;For issues or questions, please Create an issue [here](https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues).  For the source, including test driver components, please see the [Assembla repository](https://modgeosys.assembla.com/spaces/fme-components/subversion/source).  For a list of planned improvements, see [here](https://modgeosys.atlassian.net/projects/MFC/issues/MFC-1?filter=allopenissues).&#10;&#10;Copyright &amp;copy; 2017-2018 by Modern geoSystems, released under [this BSD 3-clause license](https://modgeosys.assembla.com/spaces/fme-components/subversion/source/HEAD/LICENSE?_format=raw)."
#!   MARKDOWN_USAGE="### Ports&#10;&#10;#### Input&#10;Feed the features to be sorted here.  If the input features consist of a variety of different feature types, it would be wise to ensure the sort key fields are represented in all of them.&#10;&#10;#### Output&#10;The sorted features emerge here.&#10;&#10;### Parameters&#10;&#10;#### Sort_Keys&#10;A tab- or space-delimited table of the sort keys to be applied.  The first column contains the names of the fields to be sorted, in order of sort priority.  The second column contains the database field data type.  The third and last column specifies whether the field is to be sorted in `asc`ending or `desc`ending order, e.g.:  &#10;  &#10;   `kml_name&#9;varchar asc`  &#10;    `kml_id  varchar desc`  &#10;"
#!   MAX_LOOP_ITERATIONS=""
#!   PASSWORD=""
#!   PYTHON_COMPATIBILITY="2or3"
#!   SHOW_ANNOTATIONS="true"
#!   SHOW_INFO_NODES="true"
#!   TITLE="SQLiteSorter"
#!   USAGE="&lt;h3&gt;Ports&lt;/h3&gt;&#10;&lt;h4&gt;Input&lt;/h4&gt;&#10;&lt;p&gt;Feed the features to be sorted here.  If the input features consist of a variety of different feature types, it would be wise to ensure the sort key fields are represented in all of them.&lt;/p&gt;&#10;&lt;h4&gt;Output&lt;/h4&gt;&#10;&lt;p&gt;The sorted features emerge here.&lt;/p&gt;&#10;&lt;h3&gt;Parameters&lt;/h3&gt;&#10;&lt;h4&gt;Sort_Keys&lt;/h4&gt;&#10;&lt;p&gt;A tab- or space-delimited table of the sort keys to be applied.  The first column contains the names of the fields to be sorted, in order of sort priority.  The second column contains the database field data type.  The third and last column specifies whether the field is to be sorted in &lt;code&gt;asc&lt;/code&gt;ending or &lt;code&gt;desc&lt;/code&gt;ending order, e.g.:  &lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;kml_name    varchar asc&lt;/code&gt;&lt;br /&gt;&#10;&lt;code&gt;kml_id  varchar desc&lt;/code&gt;  &lt;/p&gt;"
#!   USE_MARKDOWN="YES"
#!   VIEW_POSITION="-684.007 456.005"
#!   WARN_INVALID_XFORM_PARAM="Yes"
#!   WORKSPACE_VERSION="1"
#!   XFORM_DEPRECATED="No"
#!   ZOOM_SCALE="100"
#! >
#! <DATASETS>
#! </DATASETS>
#! <DATA_TYPES>
#! </DATA_TYPES>
#! <GEOM_TYPES>
#! </GEOM_TYPES>
#! <FEATURE_TYPES>
#! </FEATURE_TYPES>
#! <FMESERVER>
#! </FMESERVER>
#! <GLOBAL_PARAMETERS>
#! <GLOBAL_PARAMETER
#!   GUI_LINE="GUI TEXT_EDIT_OR_ATTR Sort_Keys &quot; &quot; Sort Keys:"
#!   DEFAULT_VALUE=""
#!   IS_STAND_ALONE="true"
#! />
#! </GLOBAL_PARAMETERS>
#! <COMMENTS>
#! <COMMENT
#!   IDENTIFIER="7"
#!   COMMENT_VALUE="&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0//EN&quot; &quot;http://www.w3.org/TR/REC-html40/strict.dtd&quot;&gt;&#10;&lt;html&gt;&lt;head&gt;&lt;meta name=&quot;qrichtext&quot; content=&quot;1&quot; /&gt;&lt;style type=&quot;text/css&quot;&gt;&#10;p, li { white-space: pre-wrap; }&#10;&lt;/style&gt;&lt;/head&gt;&lt;body style=&quot; font-family:&apos;helvetica neue&apos;; font-size:13pt; font-weight:400; font-style:normal;&quot;&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;This is much easier in&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;Python than with FME&lt;/p&gt;&#10;&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;&quot;&gt;transformers.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;"
#!   POSITION="2552.9985299853006 303.0000300003"
#!   TOP_LEFT="2552.9985299853006 303.0000300003"
#!   BOTTOM_RIGHT="2551.9985299853006 304.0000300003"
#!   BOUNDING_RECT="2552.9985299853006 303.0000300003 -1 -1"
#!   ORDER="500000000000000"
#!   FOLLOW_ANCHOR="true"
#!   INFO_NODE="false"
#!   COLOUR="1,1,0.78431372549019607,0.19215686274509805"
#!   SIZE_POLICY="8"
#!   ANCHORED_NODE="4"
#! />
#! </COMMENTS>
#! <CONSTANTS>
#! </CONSTANTS>
#! <BOOKMARKS>
#! </BOOKMARKS>
#! <TRANSFORMERS>
#! <TRANSFORMER
#!   IDENTIFIER="4"
#!   TYPE="PythonCaller"
#!   VERSION="4"
#!   POSITION="2552.9985299853006 3.0000300003000007"
#!   BOUNDING_RECT="2552.9985299853006 3.0000300003000007 516.04700000000003 71"
#!   ORDER="500000000000000"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_keys" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ADVANCED_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="HIDE_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="LIST_ATTRS" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="NEW_ATTRIBUTES" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PYTHONSOURCE" PARM_VALUE="import&lt;space&gt;fmeobjects&lt;lf&gt;&lt;lf&gt;import&lt;space&gt;os&lt;lf&gt;import&lt;space&gt;os.path&lt;lf&gt;import&lt;space&gt;re&lt;lf&gt;import&lt;space&gt;csv&lt;lf&gt;import&lt;space&gt;sys&lt;lf&gt;if&lt;space&gt;sys.version_info&lt;space&gt;&lt;gt&gt;&lt;space&gt;&lt;openparen&gt;3&lt;comma&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;buffer&lt;space&gt;=&lt;space&gt;memoryview&lt;lf&gt;import&lt;space&gt;random&lt;lf&gt;import&lt;space&gt;string&lt;lf&gt;import&lt;space&gt;traceback&lt;lf&gt;import&lt;space&gt;inspect&lt;lf&gt;&lt;lf&gt;import&lt;space&gt;sqlite3&lt;lf&gt;import&lt;space&gt;logging&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Random&lt;space&gt;String&lt;space&gt;Generators&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;random_string&lt;openparen&gt;size=24&lt;comma&gt;&lt;space&gt;characters=string.ascii_lowercase&lt;space&gt;+&lt;space&gt;string.digits&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;random.choice&lt;openparen&gt;characters&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;x&lt;space&gt;in&lt;space&gt;range&lt;openparen&gt;size&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;random_path&lt;openparen&gt;directory&lt;comma&gt;&lt;space&gt;prefix=&lt;quote&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;size=24&lt;comma&gt;&lt;space&gt;characters=string.ascii_lowercase&lt;space&gt;+&lt;space&gt;string.digits&lt;comma&gt;&lt;space&gt;suffix=&lt;quote&gt;&lt;quote&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;while&lt;space&gt;True:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;path&lt;space&gt;=&lt;space&gt;os.path.join&lt;openparen&gt;directory&lt;comma&gt;&lt;space&gt;prefix&lt;space&gt;+&lt;space&gt;random_string&lt;openparen&gt;size&lt;comma&gt;&lt;space&gt;characters&lt;closeparen&gt;&lt;space&gt;+&lt;space&gt;suffix&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;fd&lt;space&gt;=&lt;space&gt;os.open&lt;openparen&gt;path&lt;comma&gt;&lt;space&gt;os.O_RDONLY&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.close&lt;openparen&gt;fd&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;continue&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;OSError:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;break&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;path&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Text&lt;space&gt;Interpretation&lt;lf&gt;&lt;lf&gt;FME_TAG_CODE_TRANSLATIONS&lt;space&gt;=&lt;space&gt;&lt;opencurly&gt;&lt;apos&gt;lf&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;div.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;br.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;r&lt;apos&gt;p.*?&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;n&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;cr&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;r&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;space&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;tab&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;backslash&gt;t&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;comma&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;solidus&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;solidus&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;apos&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;openparen&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;openparen&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closeparen&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;closeparen&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;openbracket&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;openbracket&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closebracket&lt;apos&gt;:&lt;space&gt;&lt;apos&gt;&lt;closebracket&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;opencurly&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;opencurly&gt;&lt;apos&gt;&lt;comma&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;closecurly&lt;apos&gt;:&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;apos&gt;&lt;closecurly&gt;&lt;apos&gt;&lt;closecurly&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;interpret_fme_character_tags&lt;openparen&gt;raw_text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;raw_text&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;fme_tag_code&lt;space&gt;in&lt;space&gt;FME_TAG_CODE_TRANSLATIONS.keys&lt;openparen&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;&lt;apos&gt;&lt;lt&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;fme_tag_code&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;FME_TAG_CODE_TRANSLATIONS&lt;openbracket&gt;fme_tag_code&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;result&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;result&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;sanitize_text&lt;openparen&gt;raw_text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Replace&lt;space&gt;FME&lt;space&gt;tags&lt;comma&gt;&lt;space&gt;HTML&lt;space&gt;tags&lt;space&gt;or&lt;space&gt;SQL&lt;space&gt;meta-characters&lt;space&gt;with&lt;space&gt;clean&lt;space&gt;and&lt;space&gt;safe&lt;space&gt;equivalents.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;interpret_fme_character_tags&lt;openparen&gt;raw_text&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;quote&gt;&lt;apos&gt;&lt;openbracket&gt;&lt;closeparen&gt;&lt;backslash&gt;&lt;quote&gt;&lt;semicolon&gt;!=&lt;closebracket&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;SQL&lt;space&gt;metacharacters.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;lt&gt;.+?&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;all&lt;space&gt;HTML&lt;space&gt;tags.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;result&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;^&lt;gt&gt;&lt;openbracket&gt;&lt;backslash&gt;t&lt;space&gt;&lt;closebracket&gt;*&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;result&lt;comma&gt;&lt;space&gt;flags=re.MULTILINE&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Sanitize&lt;space&gt;email&lt;space&gt;quoting&lt;space&gt;prefixes.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;result&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;extract_dict_from_tab_delimited_data&lt;openparen&gt;text&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;rows&lt;space&gt;=&lt;space&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;openbracket&gt;&lt;space&gt;&lt;backslash&gt;t&lt;closebracket&gt;+&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;&lt;backslash&gt;t&lt;quote&gt;&lt;comma&gt;&lt;space&gt;text&lt;closeparen&gt;.splitlines&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Replace&lt;space&gt;repeated&lt;space&gt;delimiter&lt;space&gt;characters&lt;space&gt;by&lt;space&gt;a&lt;space&gt;single&lt;space&gt;tab&lt;space&gt;to&lt;space&gt;simplify&lt;space&gt;extraction.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;&lt;openbracket&gt;row&lt;space&gt;for&lt;space&gt;row&lt;space&gt;in&lt;space&gt;csv.DictReader&lt;openparen&gt;rows&lt;comma&gt;&lt;space&gt;&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;type&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;ordinality&lt;apos&gt;&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;None&lt;comma&gt;&lt;space&gt;None&lt;comma&gt;&lt;space&gt;&lt;apos&gt;excel-tab&lt;apos&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Logging&lt;space&gt;Support&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FMELogFormatter&lt;openparen&gt;logging.Formatter&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;arg&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;super&lt;openparen&gt;FMELogFormatter&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.arg&lt;space&gt;=&lt;space&gt;arg&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FMELogHandler&lt;openparen&gt;logging.Handler&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;emit&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;record&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Emit&lt;space&gt;a&lt;space&gt;log&lt;space&gt;record.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger&lt;space&gt;=&lt;space&gt;fmeobjects.FMELogFile&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger.logMessageString&lt;openparen&gt;record.getMessage&lt;openparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;def&lt;space&gt;getFMELogger&lt;openparen&gt;name&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Get&lt;space&gt;an&lt;space&gt;FME&lt;space&gt;logger.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger&lt;space&gt;=&lt;space&gt;logging.getLogger&lt;openparen&gt;name&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;formatter&lt;space&gt;=&lt;space&gt;logging.Formatter&lt;openparen&gt;&lt;quote&gt;%&lt;openparen&gt;asctime&lt;closeparen&gt;s&lt;space&gt;%&lt;openparen&gt;levelname&lt;closeparen&gt;s:&lt;space&gt;%&lt;openparen&gt;message&lt;closeparen&gt;s&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;handler&lt;space&gt;=&lt;space&gt;FMELogHandler&lt;openparen&gt;level=&lt;quote&gt;INFO&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;handler.setFormatter&lt;openparen&gt;formatter&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger.addHandler&lt;openparen&gt;handler&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;logger&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;Exception&lt;solidus&gt;Error&lt;space&gt;Classes&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;MGSError&lt;openparen&gt;Exception&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Base&lt;space&gt;class&lt;space&gt;for&lt;space&gt;exceptions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;message&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;super&lt;openparen&gt;MGSError&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;message&lt;closeparen&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;type&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Error&lt;space&gt;type&lt;space&gt;string.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;Error&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;instructions&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Post-message&lt;space&gt;instructions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;MGSSystemError&lt;openparen&gt;MGSError&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;message&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;super&lt;openparen&gt;MGSSystemError&lt;comma&gt;&lt;space&gt;self&lt;closeparen&gt;.__init__&lt;openparen&gt;message&lt;closeparen&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;type&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Error&lt;space&gt;type&lt;space&gt;string.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;lf&gt;&lt;tab&gt;def&lt;space&gt;instructions&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Post-message&lt;space&gt;instructions.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;tab&gt;&lt;tab&gt;return&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;&lt;lf&gt;#&lt;space&gt;FME&lt;space&gt;Template&lt;space&gt;Class&lt;space&gt;Interface&lt;lf&gt;&lt;lf&gt;TEMP&lt;space&gt;=&lt;space&gt;&lt;apos&gt;FME_SHAREDRESOURCE_TEMP&lt;apos&gt;&lt;lf&gt;#SORT_KEYS&lt;space&gt;=&lt;space&gt;&lt;apos&gt;Sort_Keys&lt;apos&gt;&lt;lf&gt;&lt;lf&gt;class&lt;space&gt;FeatureProcessor:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;__init__&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;pass&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;input&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Load&lt;space&gt;a&lt;space&gt;feature&lt;space&gt;into&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;sqlite_sort_record_number&lt;apos&gt;&lt;closeparen&gt;&lt;space&gt;==&lt;space&gt;1:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;temporary&lt;space&gt;SQLite&lt;space&gt;database&lt;space&gt;and&lt;space&gt;feature&lt;space&gt;table.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db&lt;space&gt;=&lt;space&gt;None&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Retrieve&lt;space&gt;Sort_Keys&lt;space&gt;parameter&lt;space&gt;no&lt;space&gt;matter&lt;space&gt;how&lt;space&gt;deep&lt;space&gt;in&lt;space&gt;the&lt;space&gt;workspace&lt;space&gt;call&lt;space&gt;stack&lt;space&gt;&lt;openparen&gt;FME&lt;space&gt;prefixes&lt;space&gt;its&lt;space&gt;local&lt;space&gt;parameter&lt;space&gt;names&lt;space&gt;inside&lt;space&gt;a&lt;space&gt;PythonCaller&lt;closeparen&gt;.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#self.parameter_prefix&lt;space&gt;=&lt;space&gt;next&lt;openparen&gt;&lt;openparen&gt;parameter&lt;space&gt;for&lt;space&gt;parameter&lt;space&gt;in&lt;space&gt;FME_MacroValues.keys&lt;openparen&gt;&lt;closeparen&gt;&lt;space&gt;if&lt;space&gt;SORT_KEYS&lt;space&gt;in&lt;space&gt;parameter&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;None&lt;closeparen&gt;.replace&lt;openparen&gt;SORT_KEYS&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#keys&lt;space&gt;=&lt;space&gt;self.globalize_transformer_parameter&lt;openparen&gt;SORT_KEYS&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;keys&lt;space&gt;=&lt;space&gt;feature.getAttribute&lt;openparen&gt;&lt;apos&gt;sqlite_sort_keys&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Configure&lt;space&gt;database&lt;space&gt;file&lt;space&gt;path&lt;space&gt;and&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;name.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db_path&lt;space&gt;=&lt;space&gt;random_path&lt;openparen&gt;directory=FME_MacroValues&lt;openbracket&gt;TEMP&lt;closebracket&gt;&lt;comma&gt;&lt;space&gt;prefix=&lt;apos&gt;SQLiteSorter_&lt;apos&gt;&lt;comma&gt;&lt;space&gt;suffix=&lt;apos&gt;.sqlite&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.table_name&lt;space&gt;=&lt;space&gt;&lt;apos&gt;features&lt;apos&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;SQL&lt;space&gt;DDF&lt;space&gt;key&lt;space&gt;column&lt;space&gt;definitions&lt;space&gt;from&lt;space&gt;the&lt;space&gt;Sort_Keys&lt;space&gt;parameter.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.keys&lt;space&gt;=&lt;space&gt;extract_dict_from_tab_delimited_data&lt;openparen&gt;sanitize_text&lt;openparen&gt;re.sub&lt;openparen&gt;r&lt;apos&gt;&lt;lt&gt;apos&lt;gt&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;quote&gt;&lt;apos&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;keys&lt;closeparen&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;column_defs&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;openparen&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;type&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Create&lt;space&gt;temporary&lt;space&gt;database&lt;space&gt;and&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;with&lt;space&gt;a&lt;space&gt;BLOB&lt;space&gt;to&lt;space&gt;contain&lt;space&gt;the&lt;space&gt;serialized&lt;space&gt;feature.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db&lt;space&gt;=&lt;space&gt;sqlite3.connect&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.text_factory&lt;space&gt;=&lt;space&gt;str&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor&lt;space&gt;=&lt;space&gt;self.db.execute&lt;openparen&gt;&lt;quote&gt;create&lt;space&gt;table&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;column_defs&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;feature&lt;space&gt;BLOB&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;create&lt;space&gt;index&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;quote&gt;_index&lt;space&gt;on&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;asc&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except&lt;space&gt;Exception&lt;space&gt;as&lt;space&gt;e:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;open&lt;space&gt;SQLite&lt;space&gt;database&lt;space&gt;&lt;quote&gt;%s&lt;quote&gt;&lt;space&gt;to&lt;space&gt;sort&lt;space&gt;records:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;self.db_path&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#if&lt;space&gt;hasattr&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;&lt;apos&gt;db&lt;apos&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Construct&lt;space&gt;insertion&lt;space&gt;statement&lt;space&gt;elements.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;key_names&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;key_placeholders&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;apos&gt;?&lt;apos&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;all_values&lt;space&gt;=&lt;space&gt;&lt;openbracket&gt;self.get_feature_attribute&lt;openparen&gt;feature&lt;comma&gt;&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;openbracket&gt;buffer&lt;openparen&gt;self.serialize_feature&lt;openparen&gt;feature&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Insert&lt;space&gt;the&lt;space&gt;feature&lt;space&gt;record&lt;space&gt;into&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;insert&lt;space&gt;into&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key_names&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;&lt;space&gt;values&lt;space&gt;&lt;openparen&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;key_placeholders&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;?&lt;closeparen&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;comma&gt;&lt;space&gt;all_values&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;store&lt;space&gt;records&lt;space&gt;in&lt;space&gt;SQLite&lt;space&gt;for&lt;space&gt;sorting:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;close&lt;openparen&gt;self&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;Read&lt;space&gt;all&lt;space&gt;stored&lt;space&gt;features&lt;space&gt;from&lt;space&gt;the&lt;space&gt;sort&lt;space&gt;table&lt;space&gt;in&lt;space&gt;the&lt;space&gt;requested&lt;space&gt;order.&lt;quote&gt;&lt;quote&gt;&lt;quote&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;if&lt;space&gt;hasattr&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;&lt;apos&gt;db&lt;apos&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;try:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.commit&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Construct&lt;space&gt;the&lt;space&gt;ORDER&lt;space&gt;BY&lt;space&gt;clause.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;sort_defs&lt;space&gt;=&lt;space&gt;&lt;apos&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;&lt;openparen&gt;key&lt;openbracket&gt;&lt;apos&gt;name&lt;apos&gt;&lt;closebracket&gt;&lt;space&gt;+&lt;space&gt;&lt;apos&gt;&lt;space&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;key&lt;openbracket&gt;&lt;apos&gt;ordinality&lt;apos&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;space&gt;for&lt;space&gt;key&lt;space&gt;in&lt;space&gt;self.keys&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger&lt;space&gt;=&lt;space&gt;fmeobjects.FMELogFile&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;logger.logMessageString&lt;openparen&gt;&lt;apos&gt;sort_defs:&lt;space&gt;&lt;apos&gt;&lt;space&gt;+&lt;space&gt;repr&lt;openparen&gt;sort_defs&lt;closeparen&gt;&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;backslash&gt;n&lt;quote&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Execute&lt;space&gt;the&lt;space&gt;query&lt;space&gt;and&lt;space&gt;output&lt;space&gt;the&lt;space&gt;features&lt;space&gt;in&lt;space&gt;sorted&lt;space&gt;order&lt;comma&gt;&lt;space&gt;reconstructing&lt;space&gt;them&lt;space&gt;from&lt;space&gt;the&lt;space&gt;serialized&lt;space&gt;copy&lt;space&gt;in&lt;space&gt;the&lt;space&gt;temporary&lt;space&gt;table.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;for&lt;space&gt;feature_record&lt;space&gt;in&lt;space&gt;self.cursor.execute&lt;openparen&gt;&lt;quote&gt;select&lt;space&gt;feature&lt;space&gt;from&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;self.table_name&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;space&gt;order&lt;space&gt;by&lt;space&gt;&lt;quote&gt;&lt;space&gt;+&lt;space&gt;sort_defs&lt;space&gt;+&lt;space&gt;&lt;quote&gt;&lt;semicolon&gt;&lt;quote&gt;&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.output_feature_from_blob&lt;openparen&gt;feature_record&lt;openbracket&gt;0&lt;closebracket&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;except:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;getFMELogger&lt;openparen&gt;__name__&lt;closeparen&gt;.exception&lt;openparen&gt;&lt;apos&gt;Exception:&lt;space&gt;unable&lt;space&gt;to&lt;space&gt;sort&lt;space&gt;records&lt;space&gt;via&lt;space&gt;SQLite:&lt;space&gt;%s&lt;backslash&gt;n%s&lt;apos&gt;&lt;comma&gt;&lt;space&gt;repr&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;0:2&lt;closebracket&gt;&lt;closeparen&gt;&lt;comma&gt;&lt;space&gt;&lt;apos&gt;&lt;apos&gt;.join&lt;openparen&gt;&lt;openbracket&gt;elt&lt;space&gt;for&lt;space&gt;elt&lt;space&gt;in&lt;space&gt;traceback.format_list&lt;openparen&gt;traceback.extract_tb&lt;openparen&gt;sys.exc_info&lt;openparen&gt;&lt;closeparen&gt;&lt;openbracket&gt;2&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;closebracket&gt;&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;raise&lt;space&gt;MGSSystemError&lt;openparen&gt;&lt;apos&gt;Unexpected&lt;space&gt;System&lt;space&gt;Error:&lt;space&gt;Please&lt;space&gt;try&lt;space&gt;again.&lt;apos&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;finally:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;#&lt;space&gt;Don&lt;apos&gt;t&lt;space&gt;leave&lt;space&gt;temporary&lt;space&gt;resource&lt;space&gt;files&lt;space&gt;behind.&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.cursor.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.db.close&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;os.unlink&lt;openparen&gt;self.db_path&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;output_feature_from_blob&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;blob&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature&lt;space&gt;=&lt;space&gt;self.deserialize_feature&lt;openparen&gt;blob&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.output_feature&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;deserialize_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;blob&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature&lt;space&gt;=&lt;space&gt;fmeobjects.FMEFeature&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;feature.deserialize&lt;openparen&gt;bytearray&lt;openparen&gt;blob&lt;closeparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;output_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;self.pyoutput&lt;openparen&gt;feature&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;get_feature_attribute&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;comma&gt;&lt;space&gt;feature_name&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature.getAttribute&lt;openparen&gt;feature_name&lt;closeparen&gt;&lt;lf&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;serialize_feature&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;feature&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;feature.serialize&lt;openparen&gt;&lt;closeparen&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;def&lt;space&gt;globalize_transformer_parameter&lt;openparen&gt;self&lt;comma&gt;&lt;space&gt;local_parameter_name&lt;closeparen&gt;:&lt;lf&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;&lt;space&gt;return&lt;space&gt;FME_MacroValues&lt;openbracket&gt;self.parameter_prefix&lt;space&gt;+&lt;space&gt;local_parameter_name&lt;closebracket&gt;"/>
#!     <XFORM_PARM PARM_NAME="PYTHONSYMBOL" PARM_VALUE="FeatureProcessor"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="SQLiteSortPythonCaller"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="8"
#!   TYPE="Counter"
#!   VERSION="2"
#!   POSITION="150 0"
#!   BOUNDING_RECT="150 0 -1 -1"
#!   ORDER="500000000000001"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="&lt;REJECTED&gt;"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="fme_rejection_code" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="CNT_ATTR" PARM_VALUE="sqlite_sort_record_number"/>
#!     <XFORM_PARM PARM_NAME="DOMAIN" PARM_VALUE="sqlite_sort_counter"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="SCOPE" PARM_VALUE="Local"/>
#!     <XFORM_PARM PARM_NAME="START" PARM_VALUE="1"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Counter"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="11"
#!   TYPE="ParameterFetcher"
#!   VERSION="4"
#!   POSITION="1803.0000300002998 303.00303003030029"
#!   BOUNDING_RECT="1803.0000300002998 303.00303003030029 -1 -1"
#!   ORDER="500000000000002"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="OUTPUT"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_keys" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <XFORM_PARM PARM_NAME="ATTR_LIST" PARM_VALUE="sqlite_sort_keys $(Sort_Keys)"/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="ParameterFetcher"/>
#! </TRANSFORMER>
#! <TRANSFORMER
#!   IDENTIFIER="14"
#!   TYPE="Sampler"
#!   VERSION="4"
#!   POSITION="906.009060090601 -3.0000300002999438"
#!   BOUNDING_RECT="906.009060090601 -3.0000300002999438 -1 -1"
#!   ORDER="500000000000003"
#!   PARMS_EDITED="true"
#!   ENABLED="true"
#!   LAST_PARM_EDIT="18310"
#! >
#!     <OUTPUT_FEAT NAME="SAMPLED"/>
#!     <FEAT_COLLAPSED COLLAPSED="0"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="0" />
#!     <OUTPUT_FEAT NAME="NOT_SAMPLED"/>
#!     <FEAT_COLLAPSED COLLAPSED="1"/>
#!     <XFORM_ATTR ATTR_NAME="sqlite_sort_record_number" IS_USER_CREATED="false" FEAT_INDEX="1" />
#!     <XFORM_PARM PARM_NAME="GROUP_BY" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="PARAMETERS_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="RATE" PARM_VALUE="1"/>
#!     <XFORM_PARM PARM_NAME="SAMPLE_MODE" PARM_VALUE="No"/>
#!     <XFORM_PARM PARM_NAME="SAMPLE_TYPE_LONG" PARM_VALUE="First N Features"/>
#!     <XFORM_PARM PARM_NAME="TRANSFORMER_GROUP" PARM_VALUE=""/>
#!     <XFORM_PARM PARM_NAME="XFORMER_NAME" PARM_VALUE="Sampler"/>
#! </TRANSFORMER>
#! </TRANSFORMERS>
#! <SUBDOCUMENT_IOS>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="2"
#!   NAME="Input"
#!   POSITION="-600 0"
#!   BOUNDING_RECT="-600 0 -1 -1"
#!   COLLAPSED="true"
#!   PUBLISHED="true"
#!   IS_SOURCE="true"
#!   ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! <SUBDOCUMENT_IO
#!   IDENTIFIER="3"
#!   NAME="Sorted"
#!   POSITION="3302.9985299853006 3.0000300003000007"
#!   BOUNDING_RECT="3302.9985299853006 3.0000300003000007 -1 -1"
#!   COLLAPSED="true"
#!   IS_SOURCE="false"
#!   ATTR_MODE="0"
#! >
#! </SUBDOCUMENT_IO>
#! </SUBDOCUMENT_IOS>
#! <FEAT_LINKS>
#! <FEAT_LINK
#!   IDENTIFIER="21"
#!   SOURCE_NODE="2"
#!   TARGET_NODE="8"
#!   SOURCE_PORT_DESC="0"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="6"
#!   SOURCE_NODE="4"
#!   TARGET_NODE="3"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="0"
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="15"
#!   SOURCE_NODE="8"
#!   TARGET_NODE="14"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="13"
#!   SOURCE_NODE="11"
#!   TARGET_NODE="4"
#!   SOURCE_PORT_DESC="fo 0 OUTPUT"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="16"
#!   SOURCE_NODE="14"
#!   TARGET_NODE="11"
#!   SOURCE_PORT_DESC="fo 0 SAMPLED"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! <FEAT_LINK
#!   IDENTIFIER="17"
#!   SOURCE_NODE="14"
#!   TARGET_NODE="4"
#!   SOURCE_PORT_DESC="fo 1 NOT_SAMPLED"
#!   TARGET_PORT_DESC="fi 0 "
#!   ENABLED="true"
#!   EXECUTION_IDX="0"
#!   HIDDEN="false"
#!   EXTRA_POINTS=""
#! />
#! </FEAT_LINKS>
#! <BREAKPOINTS>
#! </BREAKPOINTS>
#! <ATTR_LINKS>
#! </ATTR_LINKS>
#! <SUBDOCUMENTS>
#! </SUBDOCUMENTS>
#! <LOOKUP_TABLES>
#! </LOOKUP_TABLES>
#! </TRANSFORMER>
FME_PYTHON_VERSION 2or3
DEFAULT_MACRO $(SQLiteSorter_WORKSPACE_NAME)_Sort_Keys 
#! START_HEADER
#! END_HEADER

LOG_TIMINGS YES
LOG_FILTER_MASK -1
DEFAULT_MACRO WB_CURRENT_CONTEXT
DEFAULT_MACRO SQLiteSorter_WORKSPACE_NAME ""
INCLUDE [puts {MACRO WB_OLD_CONTEXT_$(SQLiteSorter_WORKSPACE_NAME) $(WB_CURRENT_CONTEXT)};          puts {MACRO WB_CURRENT_CONTEXT $(SQLiteSorter_WORKSPACE_NAME)}]
FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Input1530575355 Input Splitter"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"   OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"
# -------------------------------------------------------------------------

# Create the DomainName that this transformer will use.
# Because @Count itself will evalute the expression to calculate the
# domain, we don't need to do anything in Tcl per feature going by

INCLUDE [    set domainPrefix {};    if { {Local} == {Local} }    {       set domainPrefix [FME_EncodeText {$(SQLiteSorter_WORKSPACE_NAME)_Counter_}];    };    puts "MACRO $(SQLiteSorter_WORKSPACE_NAME)_Counter_FULL_DOMAIN ${domainPrefix}sqlite_sort_counter"; ]
FACTORY_DEF * ExecuteFunctionFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Counter_Rejector    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Input"    FUNCTION_DEFINITION @Count(REJECTABLE_WITH_FLAG,fme_encoded,$($(SQLiteSorter_WORKSPACE_NAME)_Counter_FULL_DOMAIN),"1")    RESULT_ATTRIBUTE "sqlite_sort_record_number"    OUTPUT COMPLETE FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_OUTPUT"    OUTPUT REJECTED FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_<REJECTED>"

FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Counter <REJECTED> Transformer Output Nuker"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_<REJECTED>"
# -------------------------------------------------------------------------

# If we're doing LAST N features, then the multiplier comes in as 0.
# If we're doing First N, multiplier is -1.
# For RANDOM, we need to treat LAST N as if it was first N (i.e. have a -1)
# That is what the ? : does in the rate multiplier.

INCLUDE [ if { {-1} == {0} && {ORIGINAL} == {ORIGINAL} } {              puts "MACRO REAL_MODE LAST"; 	         puts "MACRO REAL_RATE 1"; 	      } else {              puts "MACRO REAL_MODE ORIGINAL";              puts "MACRO REAL_RATE [expr 1 * ( -1 ? -1 : -1 ) ]"; 	      } ]
FACTORY_DEF {*} SamplingFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Sampler    COMMAND_PARM_EVALUATION SINGLE_PASS    SAMPLE_RATE $(REAL_RATE)    SAMPLE_ORDER $(REAL_MODE)    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Counter_OUTPUT"    OUTPUT SAMPLED FEATURE_TYPE ___SAMPLED___    OUTPUT NOT_SAMPLED FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_NOT_SAMPLED"
# This TeeFactory is needed because Sampler will still output features if it has no OUTPUT clauses specified.
# This way we behave nicely even if there are no output connections on the transformer. See PR#28886.

FACTORY_DEF * TeeFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_Sampler_Sampled    INPUT FEATURE_TYPE ___SAMPLED___    OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_SAMPLED"


# -------------------------------------------------------------------------

Tcl2 proc $(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_doFetch {} {    foreach {name val} {"sqlite_sort_keys {$($(SQLiteSorter_WORKSPACE_NAME)_Sort_Keys)}"} {         if { [string match {*<at>*} $val] == 1 } {             set val [FME_Execute EvaluateExpression {STRING} $val {$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher}];         } elseif {[string match {*FME_CONDITIONAL*} $val] == 1} {             set val [FME_Execute EvaluateExpression {STRING} $val {$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher}];         } else {             set val [FME_DecodeTextOrAttr $val];         };       FME_SetAttribute [FME_DecodeText $name] $val    } }
FACTORY_DEF * TeeFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_SAMPLED"    OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_OUTPUT"         @Tcl2($(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_doFetch)

# -------------------------------------------------------------------------


FME_PYTHON_PATH "$(FME_MF_DIR)"

FACTORY_DEF * PythonFactory    FACTORY_NAME $(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_ParameterFetcher_OUTPUT"    INPUT  FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sampler_NOT_SAMPLED"    SYMBOL_NAME FeatureProcessor    PYTHON_NAMESPACE FMEOBJECTS    SOURCE_CODE import<space>fmeobjects<lf><lf>import<space>os<lf>import<space>os.path<lf>import<space>re<lf>import<space>csv<lf>import<space>sys<lf>if<space>sys.version_info<space><gt><space><openparen>3<comma><closeparen>:<lf><space><space><space><space>buffer<space>=<space>memoryview<lf>import<space>random<lf>import<space>string<lf>import<space>traceback<lf>import<space>inspect<lf><lf>import<space>sqlite3<lf>import<space>logging<lf><lf><lf><lf>#<space>Random<space>String<space>Generators<lf><lf>def<space>random_string<openparen>size=24<comma><space>characters=string.ascii_lowercase<space>+<space>string.digits<closeparen>:<lf><space><space><space><space>return<space><apos><apos>.join<openparen>random.choice<openparen>characters<closeparen><space>for<space>x<space>in<space>range<openparen>size<closeparen><closeparen><lf><lf><lf>def<space>random_path<openparen>directory<comma><space>prefix=<quote><quote><comma><space>size=24<comma><space>characters=string.ascii_lowercase<space>+<space>string.digits<comma><space>suffix=<quote><quote><closeparen>:<lf><space><space><space><space>while<space>True:<lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>path<space>=<space>os.path.join<openparen>directory<comma><space>prefix<space>+<space>random_string<openparen>size<comma><space>characters<closeparen><space>+<space>suffix<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>fd<space>=<space>os.open<openparen>path<comma><space>os.O_RDONLY<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>os.close<openparen>fd<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>continue<lf><space><space><space><space><space><space><space><space>except<space>OSError:<lf><space><space><space><space><space><space><space><space><space><space><space><space>break<lf><space><space><space><space>return<space>path<lf><lf><lf><lf>#<space>Text<space>Interpretation<lf><lf>FME_TAG_CODE_TRANSLATIONS<space>=<space><opencurly><apos>lf<apos>:<space><space><space><space><space><space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>div.*?<apos>:<space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>br.*?<apos>:<space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>r<apos>p.*?<apos>:<space><space><space><space><space><space><apos><backslash>n<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>cr<apos>:<space><space><space><space><space><space><space><space><space><space><space><apos><backslash>r<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>space<apos>:<space><space><space><space><space><space><space><space><apos><space><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>tab<apos>:<space><space><space><space><space><space><space><space><space><space><apos><backslash>t<apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>comma<apos>:<space><space><space><space><space><space><space><space><apos><comma><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>solidus<apos>:<space><space><space><space><space><space><apos><solidus><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>apos<apos>:<space><space><space><space><space><space><space><space><space><apos><comma><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>openparen<apos>:<space><space><space><space><apos><openparen><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closeparen<apos>:<space><space><space><apos><closeparen><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>openbracket<apos>:<space><space><apos><openbracket><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closebracket<apos>:<space><apos><closebracket><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>opencurly<apos>:<space><space><space><space><apos><opencurly><apos><comma><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><apos>closecurly<apos>:<space><space><space><apos><closecurly><apos><closecurly><lf><lf>def<space>interpret_fme_character_tags<openparen>raw_text<closeparen>:<lf><space><space><space><space>result<space>=<space>raw_text<lf><space><space><space><space>for<space>fme_tag_code<space>in<space>FME_TAG_CODE_TRANSLATIONS.keys<openparen><closeparen>:<lf><space><space><space><space><space><space><space><space>result<space>=<space>re.sub<openparen><apos><lt><apos><space>+<space>fme_tag_code<space>+<space><apos><gt><apos><comma><space>FME_TAG_CODE_TRANSLATIONS<openbracket>fme_tag_code<closebracket><comma><space>result<closeparen><lf><space><space><space><space>return<space>result<lf><lf>def<space>sanitize_text<openparen>raw_text<closeparen>:<lf><space><space><space><space><quote><quote><quote>Replace<space>FME<space>tags<comma><space>HTML<space>tags<space>or<space>SQL<space>meta-characters<space>with<space>clean<space>and<space>safe<space>equivalents.<quote><quote><quote><lf><space><space><space><space>result<space>=<space>interpret_fme_character_tags<openparen>raw_text<closeparen><lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<quote><apos><openbracket><closeparen><backslash><quote><semicolon>!=<closebracket><quote><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space>#<space>Sanitize<space>SQL<space>metacharacters.<lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<apos><lt>.+?<gt><apos><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space><space><space><space><space>#<space>Sanitize<space>all<space>HTML<space>tags.<lf><space><space><space><space>result<space>=<space>re.sub<openparen>r<apos>^<gt><openbracket><backslash>t<space><closebracket>*<apos><comma><space><apos><apos><comma><space>result<comma><space>flags=re.MULTILINE<closeparen><space><space>#<space>Sanitize<space>email<space>quoting<space>prefixes.<lf><space><space><space><space>return<space>result<lf><lf>def<space>extract_dict_from_tab_delimited_data<openparen>text<closeparen>:<lf><space><space><space><space>rows<space>=<space>re.sub<openparen>r<apos><openbracket><space><backslash>t<closebracket>+<apos><comma><space><quote><backslash>t<quote><comma><space>text<closeparen>.splitlines<openparen><closeparen><space><space>#<space>Replace<space>repeated<space>delimiter<space>characters<space>by<space>a<space>single<space>tab<space>to<space>simplify<space>extraction.<lf><space><space><space><space>return<space><openbracket>row<space>for<space>row<space>in<space>csv.DictReader<openparen>rows<comma><space><openbracket><apos>name<apos><comma><space><apos>type<apos><comma><space><apos>ordinality<apos><closebracket><comma><space>None<comma><space>None<comma><space><apos>excel-tab<apos><closeparen><closebracket><lf><lf><lf><lf>#<space>Logging<space>Support<lf><lf>class<space>FMELogFormatter<openparen>logging.Formatter<closeparen>:<lf><space><space><space><space>def<space>__init__<openparen>self<comma><space>arg<closeparen>:<lf><space><space><space><space><space><space><space><space>super<openparen>FMELogFormatter<comma><space>self<closeparen>.__init__<openparen><closeparen><lf><space><space><space><space><space><space><space><space>self.arg<space>=<space>arg<lf><lf><lf>class<space>FMELogHandler<openparen>logging.Handler<closeparen>:<lf><space><space><space><space>def<space>emit<openparen>self<comma><space>record<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Emit<space>a<space>log<space>record.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>logger<space>=<space>fmeobjects.FMELogFile<openparen><closeparen><lf><space><space><space><space><space><space><space><space>logger.logMessageString<openparen>record.getMessage<openparen><closeparen><closeparen><lf><lf>def<space>getFMELogger<openparen>name<closeparen>:<lf><space><space><space><space><quote><quote><quote>Get<space>an<space>FME<space>logger.<quote><quote><quote><lf><space><space><space><space>logger<space>=<space>logging.getLogger<openparen>name<closeparen><lf><space><space><space><space>formatter<space>=<space>logging.Formatter<openparen><quote>%<openparen>asctime<closeparen>s<space>%<openparen>levelname<closeparen>s:<space>%<openparen>message<closeparen>s<quote><closeparen><lf><space><space><space><space>handler<space>=<space>FMELogHandler<openparen>level=<quote>INFO<quote><closeparen><lf><space><space><space><space>handler.setFormatter<openparen>formatter<closeparen><lf><space><space><space><space>logger.addHandler<openparen>handler<closeparen><lf><space><space><space><space>return<space>logger<lf><lf><lf><lf>#<space>Exception<solidus>Error<space>Classes<lf><lf>class<space>MGSError<openparen>Exception<closeparen>:<lf><tab><quote><quote><quote>Base<space>class<space>for<space>exceptions.<quote><quote><quote><lf><tab><lf><tab>def<space>__init__<openparen>self<comma><space>message<closeparen>:<lf><tab><tab>super<openparen>MGSError<comma><space>self<closeparen>.__init__<openparen>message<closeparen><lf><tab><lf><tab>def<space>type<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Error<space>type<space>string.<quote><quote><quote><lf><tab><tab>return<space><quote>Error<quote><lf><tab><lf><tab>def<space>instructions<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Post-message<space>instructions.<quote><quote><quote><lf><tab><tab>return<space><quote><quote><quote>Please<space>try<space>again.<quote><quote><quote><lf><lf>class<space>MGSSystemError<openparen>MGSError<closeparen>:<lf><tab><lf><tab>def<space>__init__<openparen>self<comma><space>message<closeparen>:<lf><tab><tab>super<openparen>MGSSystemError<comma><space>self<closeparen>.__init__<openparen>message<closeparen><lf><tab><lf><tab>def<space>type<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Error<space>type<space>string.<quote><quote><quote><lf><tab><tab>return<space><quote>Unexpected<space>System<space>Error<quote><lf><tab><lf><tab>def<space>instructions<openparen>self<closeparen>:<lf><tab><tab><quote><quote><quote>Post-message<space>instructions.<quote><quote><quote><lf><tab><tab>return<space><quote><quote><quote>Please<space>try<space>again.<quote><quote><quote><lf><lf><lf><lf>#<space>FME<space>Template<space>Class<space>Interface<lf><lf>TEMP<space>=<space><apos>FME_SHAREDRESOURCE_TEMP<apos><lf>#SORT_KEYS<space>=<space><apos>Sort_Keys<apos><lf><lf>class<space>FeatureProcessor:<lf><space><space><space><space>def<space>__init__<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space>pass<lf><lf><space><space><space><space>def<space>input<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Load<space>a<space>feature<space>into<space>the<space>sort<space>table.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>feature.getAttribute<openparen><apos>sqlite_sort_record_number<apos><closeparen><space>==<space>1:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>temporary<space>SQLite<space>database<space>and<space>feature<space>table.<quote><quote><quote><lf><space><space><space><space><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db<space>=<space>None<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Retrieve<space>Sort_Keys<space>parameter<space>no<space>matter<space>how<space>deep<space>in<space>the<space>workspace<space>call<space>stack<space><openparen>FME<space>prefixes<space>its<space>local<space>parameter<space>names<space>inside<space>a<space>PythonCaller<closeparen>.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#self.parameter_prefix<space>=<space>next<openparen><openparen>parameter<space>for<space>parameter<space>in<space>FME_MacroValues.keys<openparen><closeparen><space>if<space>SORT_KEYS<space>in<space>parameter<closeparen><comma><space>None<closeparen>.replace<openparen>SORT_KEYS<comma><space><apos><apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#keys<space>=<space>self.globalize_transformer_parameter<openparen>SORT_KEYS<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>keys<space>=<space>feature.getAttribute<openparen><apos>sqlite_sort_keys<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Configure<space>database<space>file<space>path<space>and<space>sort<space>table<space>name.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db_path<space>=<space>random_path<openparen>directory=FME_MacroValues<openbracket>TEMP<closebracket><comma><space>prefix=<apos>SQLiteSorter_<apos><comma><space>suffix=<apos>.sqlite<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.table_name<space>=<space><apos>features<apos><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>SQL<space>DDF<space>key<space>column<space>definitions<space>from<space>the<space>Sort_Keys<space>parameter.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.keys<space>=<space>extract_dict_from_tab_delimited_data<openparen>sanitize_text<openparen>re.sub<openparen>r<apos><lt>apos<gt><apos><comma><space><quote><apos><quote><comma><space>keys<closeparen><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>column_defs<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><openparen>key<openbracket><apos>name<apos><closebracket><space>+<space><apos><space><apos><space>+<space>key<openbracket><apos>type<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Create<space>temporary<space>database<space>and<space>sort<space>table<space>with<space>a<space>BLOB<space>to<space>contain<space>the<space>serialized<space>feature.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db<space>=<space>sqlite3.connect<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.text_factory<space>=<space>str<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor<space>=<space>self.db.execute<openparen><quote>create<space>table<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>column_defs<space>+<space><quote><comma><space>feature<space>BLOB<closeparen><semicolon><quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>for<space>key<space>in<space>self.keys:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.execute<openparen><quote>create<space>index<space><quote><space>+<space>key<openbracket><apos>name<apos><closebracket><space>+<space><quote>_index<space>on<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>key<openbracket><apos>name<apos><closebracket><space>+<space><quote><space>asc<closeparen><semicolon><quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>except<space>Exception<space>as<space>e:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>raise<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>open<space>SQLite<space>database<space><quote>%s<quote><space>to<space>sort<space>records:<space>%s<backslash>n%s<apos><comma><space>self.db_path<comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#if<space>hasattr<openparen>self<comma><space><apos>db<apos><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Construct<space>insertion<space>statement<space>elements.<lf><space><space><space><space><space><space><space><space><space><space><space><space>key_names<space>=<space><apos><comma><space><apos>.join<openparen><openbracket>key<openbracket><apos>name<apos><closebracket><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>key_placeholders<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><apos>?<apos><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>all_values<space>=<space><openbracket>self.get_feature_attribute<openparen>feature<comma><space>key<openbracket><apos>name<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><space>+<space><openbracket>buffer<openparen>self.serialize_feature<openparen>feature<closeparen><closeparen><closebracket><lf><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Insert<space>the<space>feature<space>record<space>into<space>the<space>sort<space>table.<lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.execute<openparen><quote>insert<space>into<space><quote><space>+<space>self.table_name<space>+<space><quote><space><openparen><quote><space>+<space>key_names<space>+<space><quote><comma><space>feature<closeparen><space>values<space><openparen><quote><space>+<space>key_placeholders<space>+<space><quote><comma><space>?<closeparen><semicolon><quote><comma><space>all_values<closeparen><lf><space><space><space><space><space><space><space><space>except:<lf><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>store<space>records<space>in<space>SQLite<space>for<space>sorting:<space>%s<backslash>n%s<apos><comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><lf><space><space><space><space>def<space>close<openparen>self<closeparen>:<lf><space><space><space><space><space><space><space><space><quote><quote><quote>Read<space>all<space>stored<space>features<space>from<space>the<space>sort<space>table<space>in<space>the<space>requested<space>order.<quote><quote><quote><lf><space><space><space><space><space><space><space><space>if<space>hasattr<openparen>self<comma><space><apos>db<apos><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space>try:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.commit<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Construct<space>the<space>ORDER<space>BY<space>clause.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>sort_defs<space>=<space><apos><comma><space><apos>.join<openparen><openbracket><openparen>key<openbracket><apos>name<apos><closebracket><space>+<space><apos><space><apos><space>+<space>key<openbracket><apos>ordinality<apos><closebracket><closeparen><space>for<space>key<space>in<space>self.keys<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>logger<space>=<space>fmeobjects.FMELogFile<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>logger.logMessageString<openparen><apos>sort_defs:<space><apos><space>+<space>repr<openparen>sort_defs<closeparen><space>+<space><quote><backslash>n<quote><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Execute<space>the<space>query<space>and<space>output<space>the<space>features<space>in<space>sorted<space>order<comma><space>reconstructing<space>them<space>from<space>the<space>serialized<space>copy<space>in<space>the<space>temporary<space>table.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>for<space>feature_record<space>in<space>self.cursor.execute<openparen><quote>select<space>feature<space>from<space><quote><space>+<space>self.table_name<space>+<space><quote><space>order<space>by<space><quote><space>+<space>sort_defs<space>+<space><quote><semicolon><quote><closeparen>:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.output_feature_from_blob<openparen>feature_record<openbracket>0<closebracket><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>except:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>getFMELogger<openparen>__name__<closeparen>.exception<openparen><apos>Exception:<space>unable<space>to<space>sort<space>records<space>via<space>SQLite:<space>%s<backslash>n%s<apos><comma><space>repr<openparen>sys.exc_info<openparen><closeparen><openbracket>0:2<closebracket><closeparen><comma><space><apos><apos>.join<openparen><openbracket>elt<space>for<space>elt<space>in<space>traceback.format_list<openparen>traceback.extract_tb<openparen>sys.exc_info<openparen><closeparen><openbracket>2<closebracket><closeparen><closeparen><closebracket><closeparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>raise<space>MGSSystemError<openparen><apos>Unexpected<space>System<space>Error:<space>Please<space>try<space>again.<apos><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space>finally:<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>#<space>Don<apos>t<space>leave<space>temporary<space>resource<space>files<space>behind.<lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.cursor.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>self.db.close<openparen><closeparen><lf><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space><space>os.unlink<openparen>self.db_path<closeparen><lf><lf><space><space><space><space>def<space>output_feature_from_blob<openparen>self<comma><space>blob<closeparen>:<lf><space><space><space><space><space><space><space><space>feature<space>=<space>self.deserialize_feature<openparen>blob<closeparen><lf><space><space><space><space><space><space><space><space>self.output_feature<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>deserialize_feature<openparen>self<comma><space>blob<closeparen>:<lf><space><space><space><space><space><space><space><space>feature<space>=<space>fmeobjects.FMEFeature<openparen><closeparen><lf><space><space><space><space><space><space><space><space>feature.deserialize<openparen>bytearray<openparen>blob<closeparen><closeparen><lf><space><space><space><space><space><space><space><space>return<space>feature<lf><lf><space><space><space><space>def<space>output_feature<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>self.pyoutput<openparen>feature<closeparen><lf><lf><space><space><space><space>def<space>get_feature_attribute<openparen>self<comma><space>feature<comma><space>feature_name<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space>feature.getAttribute<openparen>feature_name<closeparen><lf><lf><space><space><space><space>def<space>serialize_feature<openparen>self<comma><space>feature<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space>feature.serialize<openparen><closeparen><lf><space><space><space><space><lf><space><space><space><space>def<space>globalize_transformer_parameter<openparen>self<comma><space>local_parameter_name<closeparen>:<lf><space><space><space><space><space><space><space><space>return<space>FME_MacroValues<openbracket>self.parameter_prefix<space>+<space>local_parameter_name<closebracket>    OUTPUT PYOUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller_OUTPUT"

FACTORY_DEF * TeeFactory   FACTORY_NAME "$(SQLiteSorter_WORKSPACE_NAME)_Sorted1530575355 Output Collector"   INPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_SQLiteSortPythonCaller_OUTPUT"   OUTPUT FEATURE_TYPE "$(SQLiteSorter_WORKSPACE_NAME)_Sorted"
INCLUDE [puts {MACRO WB_CURRENT_CONTEXT $(WB_OLD_CONTEXT_$(SQLiteSorter_WORKSPACE_NAME))}]




























